<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penny's Multiplication Island</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(180deg,
                #ff7e5f 0%,
                #ff9966 15%,
                #ffb347 30%,
                #ffd1a3 50%,
                #ffe5c4 65%,
                #e8f5e2 85%,
                #c8e6c0 100%);
            background-attachment: fixed;
            min-height: 100vh;
            color: #5c4a32;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 1rem;
        }

        .header {
            text-align: center;
            padding: 1.5rem 0 1rem;
        }

        .header h1 {
            font-size: 1.6rem;
            font-weight: 800;
            color: #3d7c47;
            text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
            line-height: 1.2;
        }

        .header .leaf {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.3rem;
        }

        .header .subtitle {
            font-size: 0.9rem;
            color: #7a9a5a;
            margin-top: 0.3rem;
        }

        .user-status {
            font-size: 0.75rem;
            color: #7a9a5a;
            margin-top: 0.3rem;
            cursor: pointer;
        }

        .user-status:hover {
            text-decoration: underline;
        }

        .score-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.7);
            border-radius: 20px;
            padding: 0.6rem 1rem;
            margin-bottom: 1rem;
            font-weight: 700;
            font-size: 0.9rem;
            border: 2px solid rgba(61,124,71,0.15);
        }

        .score-bar span {
            color: #3d7c47;
        }

        .mode-select {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .mode-btn {
            background: rgba(255,255,255,0.8);
            border: 2px solid rgba(61,124,71,0.2);
            border-radius: 12px;
            padding: 0.7rem 0.5rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.8rem;
            color: #5c4a32;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .mode-btn:hover {
            background: rgba(255,255,255,1);
            border-color: #3d7c47;
            transform: translateY(-1px);
        }

        .mode-btn.active {
            background: #3d7c47;
            color: white;
            border-color: #3d7c47;
        }

        .mode-btn .mode-icon {
            display: block;
            font-size: 1.3rem;
            margin-bottom: 0.2rem;
        }

        .question-card {
            background: rgba(255,255,255,0.85);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 2px solid rgba(61,124,71,0.12);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .question-label {
            font-size: 0.75rem;
            font-weight: 700;
            color: #7a9a5a;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-size: 1.8rem;
            font-weight: 800;
            color: #3d5a28;
            line-height: 1.4;
            margin-bottom: 1.2rem;
            text-align: center;
        }

        .question-text .highlight {
            color: #c0732a;
        }

        .answer-area {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            justify-content: center;
        }

        .answer-input {
            width: 120px;
            padding: 0.8rem 1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 1.4rem;
            text-align: center;
            border: 3px solid rgba(61,124,71,0.3);
            border-radius: 12px;
            background: #f0f7ec;
            color: #3d5a28;
            outline: none;
            transition: border-color 0.2s;
        }

        .answer-input:focus {
            border-color: #3d7c47;
        }

        .answer-input.correct {
            border-color: #3d7c47;
            background: #c8e6c0;
        }

        .answer-input.wrong {
            border-color: #c0732a;
            background: #f5d0c0;
        }

        .submit-btn {
            background: #3d7c47;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.8rem 1.5rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .submit-btn:hover {
            background: #2d5a33;
        }

        .feedback {
            text-align: center;
            padding: 1rem;
            font-weight: 700;
            font-size: 1.1rem;
            border-radius: 12px;
            margin-top: 1rem;
            display: none;
        }

        .feedback.correct {
            display: block;
            background: #d4edda;
            color: #2d5a1e;
            font-family: 'Brush Script MT', 'Segoe Script', cursive;
            font-size: 1.3rem;
        }

        .feedback.wrong {
            display: block;
            background: #fde8e0;
            color: #8b4513;
        }

        .next-btn {
            display: none;
            width: 100%;
            background: #3d7c47;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.9rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            margin-top: 0.8rem;
            transition: background 0.2s;
        }

        .next-btn:hover {
            background: #2d5a33;
        }

        .streak-display {
            text-align: center;
            font-size: 0.85rem;
            color: #7a9a5a;
            font-weight: 600;
            margin-top: 0.3rem;
        }

        .round-end {
            text-align: center;
            padding: 1.5rem;
        }

        .round-end h2 {
            color: #3d7c47;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .round-end .final-score {
            font-size: 2.5rem;
            font-weight: 800;
            color: #c0732a;
            margin: 0.5rem 0;
        }

        .round-end .final-msg {
            font-size: 1rem;
            color: #5c4a32;
            margin-bottom: 1rem;
        }

        .round-end .final-details {
            font-size: 0.9rem;
            color: #7a9a5a;
            margin-bottom: 1.2rem;
        }

        .play-again-btn {
            background: #3d7c47;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.9rem 2rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .play-again-btn:hover {
            background: #2d5a33;
        }

        .step-tracker {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(61,124,71,0.2);
            transition: background 0.3s;
        }

        .step-dot.done {
            background: #3d7c47;
        }

        .step-dot.active {
            background: #c0732a;
            box-shadow: 0 0 6px rgba(192,115,42,0.4);
        }

        .breakdown-hint {
            text-align: center;
            font-size: 0.85rem;
            color: #7a9a5a;
            font-weight: 600;
            margin-bottom: 0.8rem;
        }

        .fun-fact {
            font-size: 0.85rem;
            color: #7a9a5a;
            font-style: italic;
            margin-top: 0.5rem;
            text-align: center;
        }

        /* Login screen */
        .login-screen {
            text-align: center;
            padding: 2rem 1rem;
        }

        .login-screen h2 {
            color: #3d7c47;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .login-screen p {
            color: #7a9a5a;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }

        .login-screen input {
            display: block;
            width: 100%;
            max-width: 280px;
            margin: 0 auto 0.8rem;
            padding: 0.7rem 1rem;
            font-family: 'Nunito', sans-serif;
            font-size: 0.95rem;
            border: 2px solid rgba(61,124,71,0.3);
            border-radius: 10px;
            background: #f0f7ec;
            color: #3d5a28;
            outline: none;
        }

        .login-screen input:focus {
            border-color: #3d7c47;
        }

        .login-btn {
            background: #3d7c47;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 0.7rem 2rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .login-btn:hover {
            background: #2d5a33;
        }

        .login-error {
            color: #c0732a;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 0.8rem;
            display: none;
        }

        /* Keep Practicing view */
        .practice-view h3 {
            color: #3d7c47;
            font-size: 1.2rem;
            margin-bottom: 0.3rem;
            text-align: center;
        }

        .practice-view .practice-subtitle {
            color: #7a9a5a;
            font-size: 0.9rem;
            text-align: center;
            margin-bottom: 1.2rem;
        }

        .practice-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.6rem 0;
            border-bottom: 1px solid rgba(61,124,71,0.1);
        }

        .practice-item:last-child {
            border-bottom: none;
        }

        .practice-problem {
            font-weight: 800;
            font-size: 1.1rem;
            color: #3d5a28;
            min-width: 55px;
        }

        .practice-bar-wrap {
            flex: 1;
            background: rgba(61,124,71,0.1);
            border-radius: 8px;
            height: 14px;
            overflow: hidden;
        }

        .practice-bar-fill {
            height: 100%;
            border-radius: 8px;
            background: linear-gradient(90deg, #c0732a, #3d7c47);
            transition: width 0.5s;
        }

        .practice-pct {
            font-weight: 700;
            font-size: 0.85rem;
            color: #7a9a5a;
            min-width: 40px;
            text-align: right;
        }

        .practice-empty {
            text-align: center;
            padding: 2rem 1rem;
            color: #7a9a5a;
            font-size: 1rem;
        }

        .practice-empty .practice-empty-icon {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .back-btn {
            display: block;
            width: 100%;
            background: rgba(61,124,71,0.1);
            color: #3d7c47;
            border: 2px solid rgba(61,124,71,0.2);
            border-radius: 12px;
            padding: 0.7rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: rgba(61,124,71,0.2);
        }

        /* Round end enhancements */
        .round-missed {
            text-align: left;
            margin: 1rem 0;
            padding: 0.8rem;
            background: rgba(192,115,42,0.08);
            border-radius: 10px;
        }

        .round-missed h4 {
            color: #c0732a;
            font-size: 0.85rem;
            margin-bottom: 0.4rem;
        }

        .round-missed-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .round-missed-tag {
            background: rgba(192,115,42,0.15);
            color: #8b4513;
            padding: 0.2rem 0.6rem;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .alltime-stats {
            font-size: 0.85rem;
            color: #7a9a5a;
            margin-top: 0.5rem;
        }

        /* Level selector */
        .level-select {
            display: flex;
            gap: 0.4rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .level-btn {
            background: rgba(255,255,255,0.8);
            border: 2px solid rgba(61,124,71,0.2);
            border-radius: 10px;
            padding: 0.45rem 0.7rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.75rem;
            color: #5c4a32;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            white-space: nowrap;
        }

        .level-btn:hover:not(.locked) {
            background: rgba(255,255,255,1);
            border-color: #3d7c47;
            transform: translateY(-1px);
        }

        .level-btn.active {
            background: #3d7c47;
            color: white;
            border-color: #3d7c47;
        }

        .level-btn.locked {
            opacity: 0.45;
            cursor: not-allowed;
            filter: grayscale(0.5);
        }

        .level-btn .level-icon {
            margin-right: 0.2rem;
        }

        /* Level unlock celebration */
        .unlock-msg {
            text-align: center;
            background: linear-gradient(135deg, #d4edda 0%, #fff8e1 100%);
            border: 2px solid #3d7c47;
            border-radius: 14px;
            padding: 1rem 1.2rem;
            margin: 1rem 0;
            animation: unlockPop 0.5s ease-out;
        }

        .unlock-msg .unlock-icon {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.3rem;
        }

        .unlock-msg .unlock-title {
            font-weight: 800;
            font-size: 1.1rem;
            color: #3d7c47;
        }

        .unlock-msg .unlock-detail {
            font-size: 0.9rem;
            color: #5c4a32;
            margin-top: 0.2rem;
        }

        @keyframes unlockPop {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Prize Tracker */
        .prize-tracker-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
            background: rgba(255,255,255,0.7);
            border: 2px solid rgba(192,115,42,0.2);
            border-radius: 12px;
            padding: 0.45rem 1rem;
            margin-bottom: 1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.85rem;
            color: #c0732a;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .prize-tracker-btn:hover {
            background: rgba(255,255,255,1);
            border-color: #c0732a;
            transform: translateY(-1px);
        }

        .prize-tracker-btn .prize-mini-bar {
            width: 60px;
            height: 8px;
            background: rgba(192,115,42,0.15);
            border-radius: 4px;
            overflow: hidden;
        }

        .prize-tracker-btn .prize-mini-fill {
            height: 100%;
            background: linear-gradient(90deg, #c0732a, #3d7c47);
            border-radius: 4px;
            transition: width 0.5s;
        }

        .prize-view h3 {
            color: #3d7c47;
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
            text-align: center;
        }

        .prize-view .prize-subtitle {
            color: #7a9a5a;
            font-size: 0.9rem;
            text-align: center;
            margin-bottom: 0.8rem;
        }

        .prize-progress-bar {
            background: rgba(61,124,71,0.1);
            border-radius: 10px;
            height: 18px;
            overflow: hidden;
            margin-bottom: 1.2rem;
            position: relative;
        }

        .prize-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #c0732a, #3d7c47);
            border-radius: 10px;
            transition: width 0.5s;
        }

        .prize-progress-label {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 800;
            color: #3d5a28;
        }

        .prize-item {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            padding: 0.6rem 0.5rem;
            border-radius: 10px;
            margin-bottom: 0.3rem;
            transition: background 0.2s;
        }

        .prize-item.earned {
            background: rgba(61,124,71,0.08);
        }

        .prize-item.next-up {
            background: rgba(192,115,42,0.1);
            border: 2px solid rgba(192,115,42,0.25);
        }

        .prize-item.future {
            opacity: 0.5;
        }

        .prize-item-icon {
            font-size: 1.2rem;
            min-width: 28px;
            text-align: center;
        }

        .prize-item-info {
            flex: 1;
        }

        .prize-item-milestone {
            font-weight: 800;
            font-size: 0.85rem;
            color: #3d5a28;
        }

        .prize-item-name {
            font-size: 0.8rem;
            color: #7a9a5a;
            font-weight: 600;
        }

        .prize-item.earned .prize-item-name {
            color: #3d7c47;
        }

        .prize-item.next-up .prize-item-name {
            color: #c0732a;
        }

        .prize-edit-link {
            display: block;
            text-align: center;
            margin-top: 0.8rem;
            margin-bottom: 0.5rem;
            font-size: 0.8rem;
            font-weight: 700;
            color: #7a9a5a;
            cursor: pointer;
            text-decoration: underline;
        }

        .prize-edit-link:hover {
            color: #3d7c47;
        }

        .prize-edit-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.4rem;
        }

        .prize-edit-label {
            font-weight: 800;
            font-size: 0.8rem;
            color: #3d5a28;
            min-width: 50px;
        }

        .prize-edit-input {
            flex: 1;
            padding: 0.4rem 0.6rem;
            font-family: 'Nunito', sans-serif;
            font-size: 0.85rem;
            border: 2px solid rgba(61,124,71,0.3);
            border-radius: 8px;
            background: #f0f7ec;
            color: #3d5a28;
            outline: none;
        }

        .prize-edit-input:focus {
            border-color: #3d7c47;
        }

        .prize-save-btn {
            display: block;
            width: 100%;
            background: #3d7c47;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 0.6rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 0.6rem;
            transition: background 0.2s;
        }

        .prize-save-btn:hover {
            background: #2d5a33;
        }

        .prize-earned-msg {
            text-align: center;
            background: linear-gradient(135deg, #fff8e1 0%, #d4edda 100%);
            border: 2px solid #c0732a;
            border-radius: 14px;
            padding: 1rem 1.2rem;
            margin: 1rem 0;
            animation: unlockPop 0.5s ease-out;
        }

        .prize-earned-msg .prize-earned-icon {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.3rem;
        }

        .prize-earned-msg .prize-earned-title {
            font-weight: 800;
            font-size: 1.1rem;
            color: #c0732a;
        }

        .prize-earned-msg .prize-earned-detail {
            font-size: 0.9rem;
            color: #5c4a32;
            margin-top: 0.2rem;
        }

        /* Island Place Unlock */
        .place-unlock-msg {
            text-align: center;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 25%, #a1c4fd 50%, #c2e9fb 75%, #d4fc79 100%);
            background-size: 300% 300%;
            animation: placeUnlock 0.8s ease-out, gradientShift 3s ease infinite;
            border: 4px solid #3d7c47;
            border-radius: 20px;
            padding: 1.5rem 1.2rem;
            margin: 1rem 0;
            box-shadow: 0 0 20px rgba(61,124,71,0.3), 0 0 40px rgba(252,182,159,0.2);
            position: relative;
            overflow: hidden;
        }

        .place-unlock-msg::before {
            content: '✨';
            position: absolute;
            font-size: 1.5rem;
            top: 10px;
            left: 15px;
            animation: sparkle 1s ease-in-out infinite;
        }

        .place-unlock-msg::after {
            content: '✨';
            position: absolute;
            font-size: 1.5rem;
            top: 10px;
            right: 15px;
            animation: sparkle 1s ease-in-out infinite 0.5s;
        }

        .place-unlock-msg .place-icon {
            font-size: 5rem;
            display: block;
            margin-bottom: 0.5rem;
            animation: iconReveal 1s ease-out;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .place-unlock-msg .place-title {
            font-weight: 800;
            font-size: 0.9rem;
            color: #3d7c47;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.3rem;
            animation: fadeSlideUp 0.6s ease-out 0.3s both;
        }

        .place-unlock-msg .place-name {
            font-weight: 800;
            font-size: 1.6rem;
            color: #5c4a32;
            margin: 0.4rem 0;
            text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
            animation: fadeSlideUp 0.6s ease-out 0.5s both;
        }

        .place-unlock-msg .place-desc {
            font-size: 1rem;
            color: #6b5a42;
            font-style: italic;
            animation: fadeSlideUp 0.6s ease-out 0.7s both;
        }

        .place-unlock-msg .place-stars {
            margin-top: 0.8rem;
            font-size: 1.5rem;
            animation: fadeSlideUp 0.6s ease-out 0.9s both;
        }

        @keyframes placeUnlock {
            0% { transform: scale(0.3) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.1) rotate(3deg); }
            70% { transform: scale(0.95) rotate(-1deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes iconReveal {
            0% { transform: scale(0) rotate(-180deg); opacity: 0; }
            50% { transform: scale(1.3) rotate(10deg); }
            75% { transform: scale(0.9) rotate(-5deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        @keyframes fadeSlideUp {
            0% { transform: translateY(20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.3); }
        }

        /* Confetti */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            top: -10px;
            animation: confettiFall 3s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        /* Mascot */
        .mascot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-size: 3rem;
            transition: transform 0.3s;
            z-index: 100;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        .mascot.happy {
            animation: mascotHappy 0.5s ease-out;
        }

        .mascot.sad {
            animation: mascotSad 0.5s ease-out;
        }

        @keyframes mascotHappy {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(-10deg); }
            50% { transform: translateY(-5px) rotate(10deg); }
            75% { transform: translateY(-10px) rotate(-5deg); }
        }

        @keyframes mascotSad {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(5px); }
        }

        /* Double Points Round */
        .double-points-active .question-card {
            background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
            border: 3px solid #ffc107;
            box-shadow: 0 0 20px rgba(255,193,7,0.3);
        }

        .double-points-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: white;
            font-weight: 800;
            font-size: 0.75rem;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            margin-bottom: 0.8rem;
            animation: pulseBadge 1s ease-in-out infinite;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @keyframes pulseBadge {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Running Character */
        .runner {
            position: fixed;
            bottom: 80px;
            left: -60px;
            width: 40px;
            height: 60px;
            z-index: 50;
            pointer-events: none;
        }

        .runner svg {
            width: 100%;
            height: 100%;
        }

        .runner.running {
            animation: runAcross 2s ease-in-out forwards;
        }

        @keyframes runAcross {
            0% { left: -60px; }
            100% { left: calc(100% + 60px); }
        }

        .runner .body {
            fill: #ffb74d;
        }
        .runner .head {
            fill: #ffcc80;
        }
        .runner .eyes {
            fill: #5d4037;
        }
        .runner .mouth {
            fill: #e65100;
        }
        .runner .hair {
            fill: #8d6e63;
        }
        .runner .shirt {
            fill: #4fc3f7;
        }
        .runner .pants {
            fill: #7986cb;
        }
        .runner .shoes {
            fill: #f44336;
        }

        .runner.running .legs {
            animation: legMove 0.2s ease-in-out infinite alternate;
        }

        .runner.running .arms {
            animation: armMove 0.2s ease-in-out infinite alternate-reverse;
        }

        @keyframes legMove {
            0% { transform: rotate(-20deg); }
            100% { transform: rotate(20deg); }
        }

        @keyframes armMove {
            0% { transform: rotate(20deg); }
            100% { transform: rotate(-20deg); }
        }

        /* Daily Streak */
        .daily-streak-display {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            background: rgba(255,152,0,0.15);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            color: #e65100;
            margin-left: 0.5rem;
        }

        .streak-flame {
            animation: flicker 0.5s ease-in-out infinite alternate;
        }

        @keyframes flicker {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }

        /* Island Name */
        .island-name-input {
            display: block;
            width: 100%;
            max-width: 200px;
            margin: 0.5rem auto;
            padding: 0.4rem 0.8rem;
            font-family: 'Nunito', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            border: 2px solid rgba(61,124,71,0.3);
            border-radius: 8px;
            background: #f0f7ec;
            color: #3d5a28;
            text-align: center;
            outline: none;
        }

        .island-name-input:focus {
            border-color: #3d7c47;
        }

        /* Emoji Applause Crowd */
        .applause-crowd {
            display: flex;
            justify-content: center;
            gap: 0.3rem;
            font-size: 2rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .applause-crowd span {
            animation: crowdBounce 0.5s ease-in-out infinite;
        }

        .applause-crowd span:nth-child(1) { animation-delay: 0s; }
        .applause-crowd span:nth-child(2) { animation-delay: 0.1s; }
        .applause-crowd span:nth-child(3) { animation-delay: 0.2s; }
        .applause-crowd span:nth-child(4) { animation-delay: 0.3s; }
        .applause-crowd span:nth-child(5) { animation-delay: 0.4s; }
        .applause-crowd span:nth-child(6) { animation-delay: 0.5s; }
        .applause-crowd span:nth-child(7) { animation-delay: 0.6s; }
        .applause-crowd span:nth-child(8) { animation-delay: 0.7s; }
        .applause-crowd span:nth-child(9) { animation-delay: 0.8s; }

        @keyframes crowdBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        /* Floating Stars/Sparkles Background */
        .sparkle {
            position: fixed;
            pointer-events: none;
            z-index: -1;
            animation: twinkle 2s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Level Up Animation */
        .level-up-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease-out;
        }

        .level-up-content {
            text-align: center;
            animation: levelUpPop 0.6s ease-out;
        }

        .level-up-content .level-icon {
            font-size: 5rem;
            display: block;
            margin-bottom: 1rem;
            animation: levelIconSpin 1s ease-out;
        }

        .level-up-content .level-text {
            font-size: 2rem;
            font-weight: 800;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255,215,0,0.8);
        }

        .level-up-content .level-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-top: 0.5rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes levelUpPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes levelIconSpin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        /* Combo Multiplier */
        .combo-display {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
            font-weight: 800;
            font-size: 1.2rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            z-index: 100;
            animation: comboPulse 0.5s ease-in-out infinite;
            box-shadow: 0 4px 15px rgba(255,107,107,0.4);
            display: none;
        }

        .combo-display.active {
            display: block;
        }

        @keyframes comboPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Achievements/Badges */
        .badge-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 2rem;
            border-radius: 20px;
            z-index: 2000;
            text-align: center;
            animation: badgePop 0.5s ease-out;
            box-shadow: 0 10px 40px rgba(102,126,234,0.5);
        }

        .badge-popup .badge-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .badge-popup .badge-title {
            font-size: 1.3rem;
            font-weight: 800;
        }

        .badge-popup .badge-desc {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.3rem;
        }

        @keyframes badgePop {
            0% { transform: translate(-50%, -50%) scale(0) rotate(-10deg); }
            50% { transform: translate(-50%, -50%) scale(1.1) rotate(5deg); }
            100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        }

        /* Weather Effects */
        .weather-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .raindrop {
            position: absolute;
            width: 2px;
            height: 15px;
            background: linear-gradient(transparent, rgba(174,194,224,0.6));
            animation: rain 0.8s linear infinite;
        }

        @keyframes rain {
            0% { transform: translateY(-20px); }
            100% { transform: translateY(100vh); }
        }

        .snowflake {
            position: absolute;
            color: white;
            font-size: 1rem;
            animation: snow 4s linear infinite;
            text-shadow: 0 0 5px rgba(255,255,255,0.8);
        }

        @keyframes snow {
            0% { transform: translateY(-20px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        .sunray {
            position: absolute;
            top: -50px;
            width: 4px;
            height: 150px;
            background: linear-gradient(rgba(255,255,200,0.6), transparent);
            animation: sunray 3s ease-in-out infinite;
        }

        @keyframes sunray {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }

        .rainbow-stripe {
            position: absolute;
            height: 100%;
            opacity: 0.35;
            animation: rainbowShimmer 3s ease-in-out infinite;
        }

        @keyframes rainbowShimmer {
            0%, 100% { opacity: 0.25; }
            50% { opacity: 0.45; }
        }

        .cloud {
            position: absolute;
            font-size: 3rem;
            opacity: 0.4;
            animation: cloudDrift 20s linear infinite;
        }

        @keyframes cloudDrift {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }

        .sunset-glow {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40%;
            background: linear-gradient(transparent, rgba(255,100,50,0.15), rgba(255,50,50,0.1));
            animation: sunsetPulse 4s ease-in-out infinite;
        }

        @keyframes sunsetPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        .weather-picker-btn {
            position: fixed;
            bottom: 12px;
            left: 12px;
            background: rgba(255,255,255,0.85);
            border: 2px solid rgba(61,124,71,0.3);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            font-size: 1.4rem;
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .weather-picker-btn:hover {
            transform: scale(1.1);
        }

        .weather-picker-popup {
            position: fixed;
            bottom: 65px;
            left: 12px;
            background: rgba(255,255,255,0.95);
            border: 2px solid rgba(61,124,71,0.2);
            border-radius: 16px;
            padding: 0.8rem;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: none;
        }
        .weather-picker-popup.open {
            display: block;
        }
        .weather-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.8rem;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.85rem;
            color: #3d7c47;
            border: none;
            background: none;
            width: 100%;
            transition: background 0.2s;
        }
        .weather-option:hover {
            background: rgba(61,124,71,0.1);
        }
        .weather-option.active {
            background: rgba(61,124,71,0.15);
        }

        /* Leaderboard */
        .leaderboard-view h3 {
            color: #3d7c47;
            text-align: center;
            margin-bottom: 1rem;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.6rem;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            margin-bottom: 0.5rem;
        }

        .leaderboard-item.mine {
            background: rgba(61,124,71,0.15);
            border: 2px solid #3d7c47;
        }

        .leaderboard-rank {
            font-size: 1.2rem;
            font-weight: 800;
            min-width: 30px;
        }

        .leaderboard-name {
            flex: 1;
            font-weight: 600;
        }

        .leaderboard-score {
            font-weight: 800;
            color: #c0732a;
        }

        /* Avatar Creator */
        .avatar-creator {
            text-align: center;
            padding: 1rem;
        }

        .avatar-preview {
            width: 80px;
            height: 120px;
            margin: 0 auto 1rem;
        }

        .avatar-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 0.5rem;
        }

        .avatar-option {
            width: 36px;
            height: 36px;
            border: 2px solid #e5e7eb;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }

        .avatar-option:hover, .avatar-option.selected {
            border-color: #3d7c47;
            transform: scale(1.1);
        }

        .avatar-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: #7a9a5a;
            margin: 0.8rem 0 0.3rem;
        }
        .hairstyle-option {
            width: auto;
            height: auto;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            padding: 0.4rem 0.6rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            background: #f9f9f9;
        }
        .hairstyle-option:hover, .hairstyle-option.selected {
            border-color: #3d7c47;
            transform: scale(1.1);
            background: #e8f5e2;
        }
        .hairstyle-option .hs-icon {
            font-size: 1.3rem;
        }
        .hairstyle-option .hs-name {
            font-size: 0.6rem;
            font-weight: 700;
            color: #5c4a32;
        }
        .hairstyle-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.4rem;
            margin-bottom: 0.3rem;
        }

        /* Bonus Question */
        .bonus-question .question-card {
            background: linear-gradient(135deg, #ffd700 0%, #ffec8b 50%, #ffd700 100%);
            border: 3px solid #daa520;
            animation: bonusGlow 1s ease-in-out infinite alternate;
        }

        @keyframes bonusGlow {
            from { box-shadow: 0 0 10px rgba(255,215,0,0.5); }
            to { box-shadow: 0 0 25px rgba(255,215,0,0.8); }
        }

        .bonus-badge {
            background: linear-gradient(135deg, #daa520, #ffd700);
            color: #5c4a32;
            font-weight: 800;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 0.8rem;
            animation: pulseBadge 0.5s ease-in-out infinite;
        }

        /* Difficulty Selector */
        .difficulty-select {
            display: flex;
            gap: 0.3rem;
            justify-content: center;
            margin-bottom: 0.8rem;
        }

        .difficulty-btn {
            padding: 0.3rem 0.8rem;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            background: white;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .difficulty-btn:hover {
            border-color: #3d7c47;
        }

        .difficulty-btn.active {
            background: #3d7c47;
            color: white;
            border-color: #3d7c47;
        }

        .difficulty-btn.easy { color: #22c55e; }
        .difficulty-btn.easy.active { background: #22c55e; color: white; border-color: #22c55e; }
        .difficulty-btn.hard { color: #ef4444; }
        .difficulty-btn.hard.active { background: #ef4444; color: white; border-color: #ef4444; }

        /* Power-ups */
        .powerups-bar {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 0.8rem;
        }

        .powerup-btn {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.3rem 0.6rem;
            border: 2px solid #e5e7eb;
            border-radius: 20px;
            background: white;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .powerup-btn:hover:not(:disabled) {
            border-color: #3d7c47;
            transform: scale(1.05);
        }

        .powerup-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .powerup-count {
            background: #3d7c47;
            color: white;
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            font-size: 0.7rem;
        }

        /* Seasonal Themes */
        body.theme-halloween {
            background: linear-gradient(180deg, #1a0a2e 0%, #2d1b4e 30%, #4a2c6a 60%, #ff6b35 100%);
        }

        body.theme-christmas {
            background: linear-gradient(180deg, #1e3a5f 0%, #2e5a7e 30%, #c41e3a 60%, #228b22 100%);
        }

        body.theme-summer {
            background: linear-gradient(180deg, #87ceeb 0%, #98d8c8 30%, #f7dc6f 60%, #f39c12 100%);
        }

        body.theme-pink {
            background: linear-gradient(180deg, #ffb6c1 0%, #ff69b4 30%, #ff1493 60%, #ffb6c1 100%);
        }

        body.theme-multiplayer {
            background: linear-gradient(180deg, #ff9ff3 0%, #f368e0 30%, #ff6b6b 60%, #feca57 100%);
        }

        /* Multiplayer */
        .multiplayer-scoreboard {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 3px solid #ff69b4;
        }

        .player-score {
            text-align: center;
            padding: 0.5rem 1.5rem;
            border-radius: 10px;
        }

        .player-score.active {
            background: linear-gradient(135deg, #ff9ff3, #f368e0);
            transform: scale(1.05);
        }

        .player-score .player-name {
            font-weight: 800;
            font-size: 1rem;
            color: #5c4a32;
        }

        .player-score .player-points {
            font-size: 1.8rem;
            font-weight: 800;
            color: #ff1493;
        }

        .player-turn-indicator {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 700;
            color: #ff1493;
            margin-bottom: 0.5rem;
            animation: pulseBadge 1s ease-in-out infinite;
        }

        /* Collectibles */
        .collectibles-bar {
            display: flex;
            gap: 0.8rem;
            justify-content: center;
            padding: 0.5rem;
            background: rgba(255,255,255,0.7);
            border-radius: 20px;
            margin-bottom: 0.8rem;
            font-size: 0.85rem;
        }

        .collectible-item {
            display: flex;
            align-items: center;
            gap: 0.2rem;
        }

        .collectible-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            animation: collectiblePop 1s ease-out forwards;
            z-index: 1000;
            pointer-events: none;
        }

        @keyframes collectiblePop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
            100% { transform: translate(-50%, -100%) scale(1); opacity: 0; }
        }

        /* Mini-games */
        .minigame-unlock {
            text-align: center;
            padding: 1rem;
            background: linear-gradient(135deg, #a8e6cf 0%, #dcedc1 100%);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .minigame-btn {
            background: #3d7c47;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 0.6rem 1.2rem;
            font-family: inherit;
            font-weight: 700;
            cursor: pointer;
            margin-top: 0.5rem;
        }

        .bug-game {
            position: relative;
            height: 200px;
            background: linear-gradient(180deg, #87ceeb 0%, #90ee90 100%);
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .bug {
            position: absolute;
            font-size: 2rem;
            cursor: pointer;
            transition: transform 0.1s;
            user-select: none;
        }

        .bug:hover {
            transform: scale(1.2);
        }

        /* Progress Map */
        .progress-map {
            position: relative;
            width: 100%;
            height: 300px;
            background: linear-gradient(180deg, #87ceeb 0%, #90ee90 50%, #f4a460 100%);
            border-radius: 16px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .map-place {
            position: absolute;
            text-align: center;
            transition: all 0.3s;
        }

        .map-place.locked {
            filter: grayscale(1);
            opacity: 0.4;
        }

        .map-place .place-icon {
            font-size: 2rem;
            display: block;
        }

        .map-place .place-label {
            font-size: 0.6rem;
            font-weight: 700;
            color: #5c4a32;
            background: rgba(255,255,255,0.8);
            padding: 0.1rem 0.3rem;
            border-radius: 4px;
        }

        /* Theme selector */
        .theme-select {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin: 0.5rem 0;
        }

        .theme-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-btn:hover, .theme-btn.active {
            border-color: #3d7c47;
            transform: scale(1.1);
        }

        /* Music toggle */
        .music-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: 2px solid #3d7c47;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-toggle.muted {
            opacity: 0.5;
        }

        @media (max-width: 400px) {
            .header h1 { font-size: 1.3rem; }
            .question-text { font-size: 1.4rem; }
            .answer-input { font-size: 1.2rem; width: 100px; }
            .mode-select { grid-template-columns: 1fr 1fr; }
            .mode-select .mode-btn:nth-child(3) { grid-column: 1 / -1; }
            .level-btn { font-size: 0.7rem; padding: 0.35rem 0.55rem; }
        }

        /* ── World Quiz Geography Game ── */
        .geo-map-container {
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            background: #e8f4fd;
            border: 2px solid rgba(61,124,71,0.2);
            position: relative;
            touch-action: manipulation;
        }
        .container.geo-active {
            max-width: 95vw;
        }
        .container.geo-active .header {
            display: none !important;
        }
        .container.geo-active #game-area > *:not(#card) {
            display: none !important;
        }
        .geo-map-container svg {
            width: 100%;
            height: auto;
            min-height: 60vh;
            display: block;
        }
        .geo-country {
            fill: #7bc67e;
            stroke: #4a8a4e;
            stroke-width: 0.3;
            cursor: pointer;
            transition: fill 0.2s;
        }
        .geo-country:hover {
            fill: #ffd700;
            stroke: #b8860b;
            stroke-width: 0.5;
        }
        .geo-country.geo-correct {
            fill: #2ecc71;
            stroke: #27ae60;
            stroke-width: 0.8;
            animation: geoPulse 0.5s ease-out;
        }
        .geo-country.geo-wrong {
            fill: #e74c3c;
            stroke: #c0392b;
            stroke-width: 0.8;
        }
        .geo-country.geo-highlight {
            fill: #ff8c00;
            stroke: #e67300;
            stroke-width: 0.8;
            animation: geoHighlightPulse 1s ease-in-out infinite;
        }
        .geo-country.geo-dimmed {
            fill: #c8dcc8;
            stroke: #a0b8a0;
            cursor: default;
        }
        @keyframes geoPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        @keyframes geoHighlightPulse {
            0%, 100% { fill: #ff8c00; }
            50% { fill: #ffb347; }
        }
        .geo-prompt {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 700;
            color: #3d7c47;
            margin: 0.5rem 0;
            min-height: 2em;
        }
        .geo-choices {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .geo-choice-btn {
            background: linear-gradient(135deg, #e8f5e2, #c8e6c0);
            border: 2px solid rgba(61,124,71,0.3);
            border-radius: 10px;
            padding: 0.7rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.9rem;
            color: #3d7c47;
            cursor: pointer;
            transition: all 0.2s;
        }
        .geo-choice-btn:hover {
            background: linear-gradient(135deg, #c8e6c0, #a8d6a0);
            transform: scale(1.03);
        }
        .geo-choice-btn.geo-btn-correct {
            background: linear-gradient(135deg, #2ecc71, #27ae60) !important;
            color: white !important;
            border-color: #27ae60 !important;
        }
        .geo-choice-btn.geo-btn-wrong {
            background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
            color: white !important;
            border-color: #c0392b !important;
        }
        .geo-fun-fact {
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
            padding: 0.6rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: #5c4a32;
            text-align: center;
        }
        .geo-region-btn {
            background: rgba(255,255,255,0.8);
            border: 2px solid rgba(61,124,71,0.2);
            border-radius: 10px;
            padding: 0.6rem 0.8rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 0.85rem;
            color: #5c4a32;
            cursor: pointer;
            transition: all 0.2s;
        }
        .geo-region-btn:hover {
            background: rgba(61,124,71,0.15);
        }
        .geo-region-btn.active {
            background: #3d7c47;
            color: white;
            border-color: #3d7c47;
        }
        .geo-score-display {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.7);
            border-radius: 10px;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            font-size: 0.85rem;
            color: #3d7c47;
        }
    </style>
</head>
<body>
    <div id="confetti-container" class="confetti-container"></div>
    <div id="weather-container" class="weather-container"></div>
    <button id="weather-picker-btn" class="weather-picker-btn" onclick="document.getElementById('weather-popup').classList.toggle('open')">🔄</button>
    <div id="weather-popup" class="weather-picker-popup"></div>
    <div class="mascot" id="mascot">🦝</div>
    <div class="combo-display" id="combo-display">🔥 x3 Combo!</div>

    <!-- Running character -->
    <div class="runner" id="runner">
        <svg viewBox="0 0 40 60" xmlns="http://www.w3.org/2000/svg">
            <!-- Hair -->
            <ellipse class="hair" cx="20" cy="8" rx="10" ry="8"/>
            <!-- Head -->
            <circle class="head" cx="20" cy="12" r="9"/>
            <!-- Eyes -->
            <circle class="eyes" cx="16" cy="11" r="2"/>
            <circle class="eyes" cx="24" cy="11" r="2"/>
            <!-- Happy mouth -->
            <path class="mouth" d="M 16 16 Q 20 20 24 16" fill="none" stroke="#e65100" stroke-width="1.5" stroke-linecap="round"/>
            <!-- Body/Shirt -->
            <rect class="shirt" x="12" y="21" width="16" height="14" rx="3"/>
            <!-- Arms -->
            <g class="arms" style="transform-origin: 12px 24px;">
                <rect class="shirt" x="4" y="22" width="8" height="4" rx="2"/>
            </g>
            <g class="arms" style="transform-origin: 28px 24px;">
                <rect class="shirt" x="28" y="22" width="8" height="4" rx="2"/>
            </g>
            <!-- Pants -->
            <rect class="pants" x="12" y="35" width="7" height="12" rx="2"/>
            <rect class="pants" x="21" y="35" width="7" height="12" rx="2"/>
            <!-- Shoes -->
            <ellipse class="shoes" cx="15" cy="50" rx="5" ry="3"/>
            <ellipse class="shoes" cx="25" cy="50" rx="5" ry="3"/>
        </svg>
    </div>

    <div class="container">
        <div class="header">
            <span class="leaf">🍃</span>
            <h1 id="island-title">Penny's Multiplication<br>Island</h1>
            <div class="subtitle">Practice your times tables, island-style!</div>
            <button onclick="showIslandNamePrompt()" style="background:none; border:1px solid #7a9a5a; border-radius:8px; padding:0.2rem 0.6rem; font-size:0.7rem; color:#7a9a5a; cursor:pointer; margin-top:0.3rem; font-family:inherit;">✏️ Rename Island</button>
            <div class="user-status" id="user-status" onclick="handleUserStatusClick()"></div>
        </div>

        <div id="login-screen" class="question-card" style="display:none;">
            <div class="login-screen">
                <h2>Welcome to the Island!</h2>
                <p>A parent can log in to save your progress.</p>
                <input type="email" id="login-email" placeholder="Email" autocomplete="email">
                <input type="password" id="login-password" placeholder="Password" autocomplete="current-password">
                <button class="login-btn" onclick="doLogin()">Log In</button>
                <div class="login-error" id="login-error"></div>
            </div>
        </div>

        <div id="game-area">
            <div class="score-bar">
                <div>Q: <span id="qnum">1</span>/<span id="qtotal">20</span></div>
                <div>Score: <span id="score">0</span></div>
                <div>Streak: <span id="streak">0</span></div>
            </div>

            <div class="mode-select">
                <button class="mode-btn active" id="btn-times" onclick="setMode('times', this)">
                    <span class="mode-icon">🌟</span>Times Tables
                </button>
                <button class="mode-btn" id="btn-breakdown" onclick="setMode('breakdown', this)">
                    <span class="mode-icon">🧩</span>Break It Down
                </button>
                <button class="mode-btn" id="btn-practice" onclick="showPracticeView()">
                    <span class="mode-icon">🎯</span>Keep Practicing
                </button>
                <button class="mode-btn" id="btn-worldquiz" onclick="showGeoMenu()">
                    <span class="mode-icon">🌍</span>World Quiz
                </button>
            </div>

            <div class="level-select" id="level-select"></div>

            <div class="prize-tracker-btn" id="prize-tracker-btn" onclick="showPrizeView()" style="display:none;">
                <span>🏆 <span id="prize-progress-text">0/50</span></span>
                <div class="prize-mini-bar"><div class="prize-mini-fill" id="prize-mini-fill" style="width:0%"></div></div>
            </div>

            <div class="question-card" id="card">
                <div class="question-label" id="q-label">Times Tables</div>
                <div class="question-text" id="q-text">Press a mode to start!</div>
                <div id="extra"></div>
                <div class="answer-area" id="answer-area">
                    <input type="number" class="answer-input" id="answer-input" autocomplete="off">
                    <button class="submit-btn" id="submit-btn" onclick="submitAnswer()">Go!</button>
                </div>
                <div class="feedback" id="feedback"></div>
                <button class="next-btn" id="next-btn" onclick="nextQuestion()">Next Question</button>
            </div>
            <div class="streak-display" id="streak-msg"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
// ── Firebase Setup ──
const firebaseConfig = {
    apiKey: "AIzaSyBdluf4mJiRQjwRfdFSjlMsRvG5hZ2LZS0",
    authDomain: "jtrivia-416ca.firebaseapp.com",
    projectId: "jtrivia-416ca",
    storageBucket: "jtrivia-416ca.firebasestorage.app",
    messagingSenderId: "284944131484",
    appId: "1:284944131484:web:7c549e0036aaf65550d459"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

let currentUser = null;

// Firestore data (loaded on login)
let multData = {
    stats: { totalAnswered: 0, totalCorrect: 0, bestStreak: 0, roundsPlayed: 0, unlockedLevel: 1, dailyStreak: 0, lastPlayDate: null },
    problems: {},
    prizes: {},
    islandName: ''
};

// ── Fun Features ──

// Confetti explosion
function launchConfetti() {
    const container = document.getElementById('confetti-container');
    const colors = ['#ff6b6b', '#feca57', '#48dbfb', '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#1dd1a1'];

    for (let i = 0; i < 50; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
            confetti.style.width = (Math.random() * 10 + 5) + 'px';
            confetti.style.height = confetti.style.width;
            confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
            container.appendChild(confetti);

            setTimeout(() => confetti.remove(), 4000);
        }, i * 30);
    }
}

// Mascot reactions
function mascotReact(isCorrect) {
    const mascot = document.getElementById('mascot');
    mascot.className = 'mascot';

    if (isCorrect) {
        mascot.textContent = '🥳';
        mascot.classList.add('happy');
    } else {
        mascot.textContent = '🤗';
        mascot.classList.add('sad');
    }

    setTimeout(() => {
        mascot.className = 'mascot';
        mascot.textContent = '🦝';
    }, 1500);
}

// Running character
function runCharacter() {
    const runner = document.getElementById('runner');
    runner.classList.remove('running');
    // Force reflow to restart animation
    void runner.offsetWidth;
    runner.classList.add('running');

    setTimeout(() => {
        runner.classList.remove('running');
    }, 2000);
}

// Floating sparkles background
function createSparkles() {
    const sparkleChars = ['✨', '⭐', '🌟', '💫'];
    for (let i = 0; i < 15; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.textContent = sparkleChars[Math.floor(Math.random() * sparkleChars.length)];
        sparkle.style.left = Math.random() * 100 + '%';
        sparkle.style.top = Math.random() * 100 + '%';
        sparkle.style.fontSize = (Math.random() * 1 + 0.5) + 'rem';
        sparkle.style.animationDelay = Math.random() * 2 + 's';
        document.body.appendChild(sparkle);
    }
}
createSparkles();

// Level up animation
function showLevelUpAnimation(level) {
    const overlay = document.createElement('div');
    overlay.className = 'level-up-overlay';
    overlay.innerHTML = `
        <div class="level-up-content">
            <span class="level-icon">${level.icon}</span>
            <div class="level-text">LEVEL UP!</div>
            <div class="level-name">${level.name} Unlocked!</div>
        </div>
    `;
    document.body.appendChild(overlay);
    playSound('fanfare');
    launchConfetti();

    setTimeout(() => {
        overlay.style.animation = 'fadeIn 0.3s ease-out reverse';
        setTimeout(() => overlay.remove(), 300);
    }, 2500);
}

// Combo multiplier
let comboCount = 0;

function updateCombo(isCorrect) {
    const comboDisplay = document.getElementById('combo-display');

    if (isCorrect) {
        comboCount++;
        if (comboCount >= 3) {
            comboDisplay.textContent = `🔥 x${comboCount} Combo!`;
            comboDisplay.classList.add('active');
        }
    } else {
        comboCount = 0;
        comboDisplay.classList.remove('active');
    }
}

function getComboBonus() {
    if (comboCount >= 5) return 2;
    if (comboCount >= 3) return 1;
    return 0;
}

// Achievements/Badges
const ACHIEVEMENTS = [
    { id: 'first_perfect', name: 'Perfect Start', desc: 'Get 100% on a round', icon: '🎯', check: () => false },
    { id: 'streak_10', name: 'On Fire!', desc: 'Get 10 in a row', icon: '🔥', check: () => false },
    { id: 'speed_demon', name: 'Speed Demon', desc: 'Answer 5 questions in under 10 seconds each', icon: '⚡', check: () => false },
    { id: 'week_warrior', name: 'Week Warrior', desc: 'Play 7 days in a row', icon: '📅', check: () => multData.stats.dailyStreak >= 7 },
    { id: 'century', name: 'Century Club', desc: 'Answer 100 questions', icon: '💯', check: () => multData.stats.totalAnswered >= 100 },
    { id: 'master', name: 'Math Master', desc: 'Answer 500 questions', icon: '🧙', check: () => multData.stats.totalAnswered >= 500 },
    { id: 'perfectionist', name: 'Perfectionist', desc: 'Get 5 perfect rounds', icon: '👑', check: () => false },
    { id: 'explorer', name: 'Island Explorer', desc: 'Unlock all levels', icon: '🗺️', check: () => unlockedLevel >= LEVELS.length },
    { id: 'geo_first', name: 'World Traveler', desc: 'Complete your first geography round', icon: '🌍', check: () => (multData.geoStats?.roundsPlayed || 0) >= 1 },
    { id: 'geo_perfect', name: 'Perfect Map', desc: 'Get 10/10 in a geography round', icon: '🗺️', check: () => (multData.geoStats?.perfectRounds || 0) >= 1 },
    { id: 'geo_50', name: 'Globe Trotter', desc: 'Answer 50 geography questions', icon: '✈️', check: () => (multData.geoStats?.totalAnswered || 0) >= 50 }
];

function checkAchievements() {
    if (!multData.achievements) multData.achievements = {};

    for (const ach of ACHIEVEMENTS) {
        if (!multData.achievements[ach.id] && ach.check()) {
            multData.achievements[ach.id] = true;
            showBadge(ach);
            return; // One at a time
        }
    }
}

function showBadge(achievement) {
    const popup = document.createElement('div');
    popup.className = 'badge-popup';
    popup.innerHTML = `
        <span class="badge-icon">${achievement.icon}</span>
        <div class="badge-title">${achievement.name}</div>
        <div class="badge-desc">${achievement.desc}</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');

    setTimeout(() => {
        popup.style.animation = 'badgePop 0.3s ease-out reverse';
        setTimeout(() => popup.remove(), 300);
    }, 3000);
}

// Weather effects
let currentWeather = 'auto';
const WEATHER_TYPES = {
    auto:    { name: 'Auto',    icon: '🔄' },
    sunny:   { name: 'Sunny',   icon: '☀️' },
    rain:    { name: 'Rainy',   icon: '🌧️' },
    cloudy:  { name: 'Cloudy',  icon: '☁️' },
    rainbow: { name: 'Rainbow', icon: '🌈' },
    sunset:  { name: 'Sunset',  icon: '🌅' },
    snow:    { name: 'Snow',    icon: '❄️' },
    all:     { name: 'All!',    icon: '🌪️' }
};

function getAutoWeather() {
    const hour = new Date().getHours();
    if (hour >= 6 && hour < 12) return 'sunny';
    if (hour >= 12 && hour < 17) return 'sunny';
    if (hour >= 17 && hour < 20) return 'sunset';
    return 'snow';
}

function renderWeatherEffect(type) {
    const container = document.getElementById('weather-container');
    // Don't clear — allows layering for 'all' mode

    if (type === 'sunny') {
        for (let i = 0; i < 8; i++) {
            const ray = document.createElement('div');
            ray.className = 'sunray';
            ray.style.left = (i * 12 + Math.random() * 10) + '%';
            ray.style.animationDelay = Math.random() * 2 + 's';
            container.appendChild(ray);
        }
    }

    if (type === 'rain') {
        for (let i = 0; i < 40; i++) {
            const drop = document.createElement('div');
            drop.className = 'raindrop';
            drop.style.left = Math.random() * 100 + '%';
            drop.style.animationDelay = Math.random() * 1 + 's';
            drop.style.animationDuration = (Math.random() * 0.3 + 0.6) + 's';
            container.appendChild(drop);
        }
    }

    if (type === 'cloudy') {
        const clouds = ['☁️', '🌥️', '⛅'];
        for (let i = 0; i < 6; i++) {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            cloud.textContent = clouds[Math.floor(Math.random() * clouds.length)];
            cloud.style.top = (Math.random() * 40) + '%';
            cloud.style.animationDelay = (Math.random() * 15) + 's';
            cloud.style.animationDuration = (15 + Math.random() * 15) + 's';
            cloud.style.fontSize = (2 + Math.random() * 2) + 'rem';
            container.appendChild(cloud);
        }
    }

    if (type === 'rainbow') {
        const colors = ['#ff0000', '#ff7700', '#ffff00', '#00cc00', '#0000ff', '#8b00ff'];
        colors.forEach((color, i) => {
            const stripe = document.createElement('div');
            stripe.className = 'rainbow-stripe';
            stripe.style.left = (i * 16) + '%';
            stripe.style.width = '20%';
            stripe.style.background = color;
            stripe.style.animationDelay = (i * 0.3) + 's';
            container.appendChild(stripe);
        });
    }

    if (type === 'sunset') {
        const glow = document.createElement('div');
        glow.className = 'sunset-glow';
        container.appendChild(glow);
        // Add a few sun rays too
        for (let i = 0; i < 5; i++) {
            const ray = document.createElement('div');
            ray.className = 'sunray';
            ray.style.left = (i * 20 + Math.random() * 10) + '%';
            ray.style.animationDelay = Math.random() * 2 + 's';
            ray.style.background = 'linear-gradient(rgba(255,150,50,0.5), transparent)';
            container.appendChild(ray);
        }
    }

    if (type === 'snow') {
        const snowflakes = ['❄', '❅', '❆', '✧'];
        for (let i = 0; i < 25; i++) {
            const flake = document.createElement('div');
            flake.className = 'snowflake';
            flake.textContent = snowflakes[Math.floor(Math.random() * snowflakes.length)];
            flake.style.left = Math.random() * 100 + '%';
            flake.style.animationDelay = Math.random() * 4 + 's';
            flake.style.animationDuration = (Math.random() * 2 + 3) + 's';
            container.appendChild(flake);
        }
    }
}

function setWeather(type) {
    if (type !== undefined) currentWeather = type;
    const container = document.getElementById('weather-container');
    container.innerHTML = '';

    if (currentWeather === 'all') {
        ['sunny', 'rain', 'cloudy', 'rainbow', 'sunset', 'snow'].forEach(t => renderWeatherEffect(t));
    } else if (currentWeather === 'auto') {
        renderWeatherEffect(getAutoWeather());
    } else {
        renderWeatherEffect(currentWeather);
    }

    // Update picker button icon
    const btn = document.getElementById('weather-picker-btn');
    if (btn) btn.textContent = WEATHER_TYPES[currentWeather].icon;

    // Update active state in popup
    document.querySelectorAll('.weather-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.weather === currentWeather);
    });

    // Save preference
    if (multData.preferences) {
        multData.preferences.weather = currentWeather;
        saveMultiplicationData();
    }
}

function createWeatherPicker() {
    const btn = document.getElementById('weather-picker-btn');
    btn.textContent = WEATHER_TYPES[currentWeather].icon;

    const popup = document.getElementById('weather-popup');
    popup.innerHTML = `
        <div style="font-weight: 800; color: #3d7c47; margin-bottom: 0.3rem; font-size: 0.8rem;">Pick Weather:</div>
        ${Object.entries(WEATHER_TYPES).map(([key, w]) => `
            <button class="weather-option ${key === currentWeather ? 'active' : ''}" data-weather="${key}" onclick="setWeather('${key}'); document.getElementById('weather-popup').classList.remove('open');">
                ${w.icon} ${w.name}
            </button>
        `).join('')}
    `;

    // Close popup when clicking elsewhere
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.weather-picker-btn') && !e.target.closest('.weather-picker-popup')) {
            popup.classList.remove('open');
        }
    });
}

// Load saved weather preference
function loadWeatherPreference() {
    if (multData.preferences?.weather) {
        currentWeather = multData.preferences.weather;
    }
}

setWeather();
createWeatherPicker();

// Double points round
let isDoublePoints = false;
const DOUBLE_POINTS_CHANCE = 0.15; // 15% chance

function checkDoublePointsRound() {
    isDoublePoints = Math.random() < DOUBLE_POINTS_CHANCE;
    if (isDoublePoints) {
        document.body.classList.add('double-points-active');
    } else {
        document.body.classList.remove('double-points-active');
    }
    return isDoublePoints;
}

// Daily streak
function updateDailyStreak() {
    const today = new Date().toISOString().split('T')[0];
    const lastPlay = multData.stats.lastPlayDate;

    if (!lastPlay) {
        multData.stats.dailyStreak = 1;
    } else if (lastPlay === today) {
        // Already played today, keep streak
    } else {
        const lastDate = new Date(lastPlay);
        const todayDate = new Date(today);
        const diffDays = Math.floor((todayDate - lastDate) / (1000 * 60 * 60 * 24));

        if (diffDays === 1) {
            multData.stats.dailyStreak++;
        } else if (diffDays > 1) {
            multData.stats.dailyStreak = 1;
        }
    }
    multData.stats.lastPlayDate = today;
    updateDailyStreakDisplay();
}

function updateDailyStreakDisplay() {
    const streak = multData.stats.dailyStreak || 0;
    let streakEl = document.getElementById('daily-streak');

    if (streak > 1) {
        if (!streakEl) {
            streakEl = document.createElement('span');
            streakEl.id = 'daily-streak';
            streakEl.className = 'daily-streak-display';
            document.querySelector('.score-bar').appendChild(streakEl);
        }
        streakEl.innerHTML = `<span class="streak-flame">🔥</span>${streak} days`;
    } else if (streakEl) {
        streakEl.remove();
    }
}

// Island name
function updateIslandName() {
    const title = document.getElementById('island-title');
    if (multData.islandName) {
        title.innerHTML = `${multData.islandName}<br>Island`;
    } else {
        title.innerHTML = `Penny's Multiplication<br>Island`;
    }
}

function showIslandNamePrompt() {
    const name = prompt("What would you like to name your island?", multData.islandName || "Penny's Multiplication");
    if (name !== null && name.trim()) {
        multData.islandName = name.trim();
        updateIslandName();
        saveMultiplicationData();
    }
}

// Sound effects (using Web Audio API for simple tones)
const audioContext = new (window.AudioContext || window.webkitAudioContext)();

function playSound(type) {
    try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        if (type === 'correct') {
            oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
            oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
            oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.4);
        } else if (type === 'wrong') {
            oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        } else if (type === 'fanfare') {
            const notes = [523.25, 659.25, 783.99, 1046.50];
            notes.forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);
                osc.frequency.setValueAtTime(freq, audioContext.currentTime + i * 0.15);
                gain.gain.setValueAtTime(0.3, audioContext.currentTime + i * 0.15);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i * 0.15 + 0.3);
                osc.start(audioContext.currentTime + i * 0.15);
                osc.stop(audioContext.currentTime + i * 0.15 + 0.3);
            });
        }
    } catch(e) {
        // Audio not supported, silently fail
    }
}

// ── Auth ──
auth.onAuthStateChanged(async (user) => {
    currentUser = user;
    updateAuthUI();
    if (user) {
        await loadMultiplicationData();
    }
});

function updateAuthUI() {
    const statusEl = document.getElementById('user-status');
    const loginScreen = document.getElementById('login-screen');
    const gameArea = document.getElementById('game-area');

    if (currentUser) {
        statusEl.textContent = currentUser.email + ' (log out)';
        loginScreen.style.display = 'none';
        gameArea.style.display = 'block';
    } else {
        statusEl.textContent = 'Log in to save progress';
        loginScreen.style.display = 'block';
        gameArea.style.display = 'block';
    }
}

function handleUserStatusClick() {
    if (currentUser) {
        auth.signOut();
        multData = {
            stats: { totalAnswered: 0, totalCorrect: 0, bestStreak: 0, roundsPlayed: 0, unlockedLevel: 1, dailyStreak: 0, lastPlayDate: null },
            problems: {},
            prizes: {},
            islandName: ''
        };
        initDefaultPrizes();
        currentLevel = 1;
        unlockedLevel = 1;
        renderLevelSelect();
        renderPrizeButton();
        updateIslandName();
        updateDailyStreakDisplay();
    } else {
        document.getElementById('login-screen').style.display = 'block';
        document.getElementById('login-email').focus();
    }
}

async function doLogin() {
    const email = document.getElementById('login-email').value.trim();
    const password = document.getElementById('login-password').value;
    const errorEl = document.getElementById('login-error');
    errorEl.style.display = 'none';

    if (!email || !password) {
        errorEl.textContent = 'Please enter email and password.';
        errorEl.style.display = 'block';
        return;
    }

    try {
        await auth.signInWithEmailAndPassword(email, password);
    } catch (error) {
        errorEl.textContent = error.message;
        errorEl.style.display = 'block';
    }
}

// Enter key on login fields
document.getElementById('login-password').addEventListener('keydown', function(e) {
    if (e.key === 'Enter') doLogin();
});

// ── Firestore Data ──
async function loadMultiplicationData() {
    if (!currentUser) return;
    try {
        const doc = await db.collection('users').doc(currentUser.uid).get();
        if (doc.exists && doc.data().multiplication) {
            const m = doc.data().multiplication;
            multData.stats = m.stats || multData.stats;
            multData.problems = m.problems || {};
            // Merge saved prizes with defaults (preserves new milestones)
            if (m.prizes) {
                for (const key of Object.keys(m.prizes)) {
                    multData.prizes[key] = m.prizes[key];
                }
            }
            initDefaultPrizes();
            if (m.islandName) {
                multData.islandName = m.islandName;
                updateIslandName();
            }
            if (m.geoStats) {
                multData.geoStats = m.geoStats;
            }
            if (m.collectedSongs) {
                multData.collectedSongs = m.collectedSongs;
            }
            if (m.passport) {
                multData.passport = m.passport;
            }
            if (multData.stats.unlockedLevel) {
                unlockedLevel = multData.stats.unlockedLevel;
                if (currentLevel > unlockedLevel) currentLevel = unlockedLevel;
                renderLevelSelect();
            }
            renderPrizeButton();
            updateDailyStreakDisplay();
        }
    } catch (e) {
        console.log('Could not load multiplication data:', e);
    }
}

async function saveMultiplicationData() {
    if (!currentUser) return;
    // Sync runtime state into multData before saving
    multData.collectedSongs = collectedSongs;
    try {
        await db.collection('users').doc(currentUser.uid).set({
            multiplication: multData
        }, { merge: true });
    } catch (e) {
        console.log('Could not save multiplication data:', e);
    }
}

// ── Island Places (unlock every 20 correct) ──
const ISLAND_PLACES = [
    { name: "Nook's Cranny", icon: "🏪", desc: "Tom Nook's shop is open for business!", character: "🦝", charName: "Tom Nook", quote: "Yes, yes! Welcome to my shop!", gift: "bells" },
    { name: "The Museum", icon: "🏛️", desc: "Blathers can't wait to see your collection!", character: "🦉", charName: "Blathers", quote: "Hoo! What a magnificent specimen!", gift: "fossil" },
    { name: "Able Sisters", icon: "🧵", desc: "Mabel and Sable have clothes for you!", character: "🦔", charName: "Mabel", quote: "Looking for something cute to wear?", gift: "clothes" },
    { name: "Resident Services", icon: "🏢", desc: "Isabelle is ready to help!", character: "🐕", charName: "Isabelle", quote: "Good morning! Let's make today great!", gift: "star" },
    { name: "The Campsite", icon: "⛺", desc: "Visitors are coming to your island!", character: "🐱", charName: "Visitor", quote: "This island is amazing!", gift: "snack" },
    { name: "Starfall Cliff", icon: "🌠", desc: "A magical place where stars fall!", character: "🦊", charName: "Celeste", quote: "Make a wish on the falling stars!", gift: "star" },
    { name: "Rainbow Falls", icon: "🌈", desc: "The most colorful waterfall on the island!", character: "🦆", charName: "Molly", quote: "The rainbow is so beautiful, quack!", gift: "shell" },
    { name: "Mushroom Grove", icon: "🍄", desc: "Giant mushrooms grow here year-round!", character: "🐿️", charName: "Marshal", quote: "These mushrooms are so aesthetic, sulky!", gift: "mushroom" },
    { name: "Fossil Canyon", icon: "🦴", desc: "Ancient treasures hide in these rocks!", character: "🦉", charName: "Blathers", quote: "HOO! More fossils to examine!", gift: "fossil" },
    { name: "Butterfly Garden", icon: "🦋", desc: "Flick's favorite place to visit!", character: "🦎", charName: "Flick", quote: "BUGS! I love bugs so much!", gift: "bug" },
    { name: "Crystal Cave", icon: "💎", desc: "Glittering gems light up the darkness!", character: "🦨", charName: "Kicks", quote: "Shiny! Like my freshest kicks!", gift: "gem" },
    { name: "Cloud Overlook", icon: "☁️", desc: "Touch the clouds from up here!", character: "🐦", charName: "Gulliver", quote: "I can see my ship from here... maybe!", gift: "treasure" },
    { name: "Honeybee Meadow", icon: "🐝", desc: "Sweet honey flows from golden hives!", character: "🐻", charName: "Stitches", quote: "Honey is my favorite, stuffin'!", gift: "honey" },
    { name: "Firefly Lake", icon: "✨", desc: "Glowing fireflies dance at night!", character: "🐸", charName: "Lily", quote: "The fireflies are magical, toady!", gift: "bug" },
    { name: "K.K. Concert Hall", icon: "🎸", desc: "K.K. Slider plays here every night!", character: "🐕", charName: "K.K. Slider", quote: "This next song goes out to you...", gift: "music" },
    { name: "Treasure Cove", icon: "🏴‍☠️", desc: "Gulliver found pirate gold here!", character: "🐦", charName: "Gullivarrr", quote: "Ahoy! There be treasure here, matey!", gift: "treasure" },
    { name: "Northern Lights Peak", icon: "🌌", desc: "The aurora shines above the mountain!", character: "🐧", charName: "Aurora", quote: "The lights dance just for us, b-b-baby!", gift: "star" },
    { name: "Sakura Springs", icon: "🌸", desc: "Cherry blossoms bloom forever here!", character: "🐰", charName: "Chrissy", quote: "So pretty and pink, sparkles!", gift: "flower" },
    { name: "Mermaid Lagoon", icon: "🧜‍♀️", desc: "Pascal shares secrets in these waters!", character: "🦦", charName: "Pascal", quote: "Life is like the ocean, maaan...", gift: "pearl" },
    { name: "Golden Palace", icon: "👑", desc: "The ultimate island achievement!", character: "🦁", charName: "King", quote: "You've truly mastered the island!", gift: "crown" }
];

function getUnlockedPlaces() {
    const totalCorrect = multData.stats.totalCorrect || 0;
    return Math.min(Math.floor(totalCorrect / 20), ISLAND_PLACES.length);
}

function checkNewPlaceUnlocked(prevCorrect, newCorrect) {
    const prevPlaces = Math.floor(prevCorrect / 20);
    const newPlaces = Math.floor(newCorrect / 20);
    if (newPlaces > prevPlaces && newPlaces <= ISLAND_PLACES.length) {
        return ISLAND_PLACES[newPlaces - 1];
    }
    return null;
}

// ── Prize Milestones ──
const PRIZE_MILESTONES = [50, 100, 200, 350, 500, 750, 1000];

function initDefaultPrizes() {
    if (!multData.prizes) multData.prizes = {};
    for (const m of PRIZE_MILESTONES) {
        if (!multData.prizes[m]) {
            multData.prizes[m] = { name: "", earned: false };
        }
    }
}
initDefaultPrizes();

// ── Levels ──
const LEVELS = [
    { num: 1, name: "Beach", icon: "🏖️", factors: [5, 10] },
    { num: 2, name: "Meadow", icon: "🌻", factors: [2, 4, 11] },
    { num: 3, name: "Forest", icon: "🌲", factors: [3, 6, 9] },
    { num: 4, name: "Volcano", icon: "🌋", factors: [7, 8, 12] },
    { num: 5, name: "Orchard", icon: "🍎", factors: [2, 3, 4, 5] },
    { num: 6, name: "Campsite", icon: "🏕️", factors: [6, 7, 8] },
    { num: 7, name: "Snowfield", icon: "❄️", factors: [9, 11, 12] },
    { num: 8, name: "Champion Island", icon: "🏆", factors: [2,3,4,5,6,7,8,9,10,11,12] },
];
const UNLOCK_THRESHOLD = 0.8; // 80% to unlock next level

let currentLevel = 1;
let unlockedLevel = 1;

// ── Quiz State ──
const TIMES_ROUND = 20;
const BREAKDOWN_ROUND = 10;

function renderLevelSelect() {
    const container = document.getElementById('level-select');
    // Only show for times tables mode
    if (currentMode !== 'times' || practiceViewActive) {
        container.style.display = 'none';
        return;
    }
    container.style.display = 'flex';
    container.innerHTML = LEVELS.map(lv => {
        const isLocked = lv.num > unlockedLevel;
        const isActive = lv.num === currentLevel;
        let cls = 'level-btn';
        if (isActive) cls += ' active';
        if (isLocked) cls += ' locked';
        const lockIcon = isLocked ? '🔒 ' : '';
        return `<button class="${cls}" onclick="selectLevel(${lv.num})" ${isLocked ? 'disabled' : ''}>
            <span class="level-icon">${lv.icon}</span>${lockIcon}${lv.name}
        </button>`;
    }).join('');
}

function selectLevel(num) {
    if (num > unlockedLevel) return;
    currentLevel = num;
    renderLevelSelect();
    startRound();
}

const correctMessages = [
    "Tom Nook is impressed!",
    "You earned some Nook Miles!",
    "Isabelle is cheering for you!",
    "Your island rating just went up!",
    "K.K. Slider wrote a song about that answer!",
    "Blathers would be proud!",
    "That's worth a golden shovel!",
    "You found a rare fossil... of knowledge!",
    "Celeste saw that in the stars!",
    "Perfect, like a blue rose!",
    "Daisy Mae is doing a happy dance!",
    "You just caught a rare bug... a Math Moth!",
    "Nook's Cranny wants to hire you!",
    "Your villagers are throwing a party!",
    "That answer belongs in the museum!",
    "Flick would pay double for that answer!",
    "You're a five-star islander!",
    "Pascal would share his scallop with you!",
    "Leif is planting flowers in your honor!",
    "CJ wants to make a model of that answer!",
    "Brewster made you a special coffee!",
    "Kicks is giving you a standing ovation!",
    "Saharah rolled out the red carpet!",
    "Timmy and Tommy are applauding!",
    "Redd says that's a genuine masterpiece!",
    "Kapp'n is singing a song about you!",
    "You found a golden nugget of wisdom!",
    "Label wants to design an outfit for you!",
    "Gracie would give that an A+!",
    "You're getting a letter from Mom!",
    "Zipper is hopping with joy!",
    "Orville is announcing your greatness!",
    "That's worth a million bells!",
    "Harriet is styling your victory hair!",
    "Digby is taking notes on your skills!",
    "Luna is saving that answer in a dream!",
    "Lottie is decorating in your honor!",
    "Wardell nods in silent approval!",
    "Tortimer would be proud!",
    "You just unlocked island paradise!"
];

const wrongMessages = [
    "Even Gulliver gets lost sometimes!",
    "Wisp dropped a spirit piece...",
    "Oops! Try again next time!",
    "That bell bag was just slightly off!",
    "Almost had it, villager!",
    "Keep digging, you'll find the fossil!"
];

const streakMessages = [
    "You're on a Nook Miles+ streak!",
    "Unstoppable island explorer!",
    "The villagers are amazed!",
    "Tom Nook wants to give you a raise!",
    "Legendary islander status!"
];

let currentMode = 'times';
let score = 0;
let total = 0;
let streak = 0;
let bestStreak = 0;
let answered = false;
let roundLength = TIMES_ROUND;
let practiceViewActive = false;

// Break It Down state
let bdA = 0;
let bdB = 0;
let bdTens = 0;
let bdOnes = 0;
let bdStep = 0;

// Current problem tracking for the round
let currentProblemA = 0;
let currentProblemB = 0;
let roundProblems = []; // { key, correct } for each answered problem in this round

function pickRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function problemKey(a, b) {
    // Normalize so 3x7 and 7x3 are same key (smaller first)
    const lo = Math.min(a, b);
    const hi = Math.max(a, b);
    return lo + 'x' + hi;
}

function setMode(mode, btn) {
    practiceViewActive = false;
    currentMode = mode;
    document.querySelector('.container').classList.remove('geo-active');
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    roundLength = mode === 'times' ? TIMES_ROUND : BREAKDOWN_ROUND;
    document.getElementById('qtotal').textContent = roundLength;
    document.querySelector('.score-bar').style.display = '';
    renderLevelSelect();
    startRound();
}

function startRound() {
    practiceViewActive = false;
    score = 0;
    total = 0;
    streak = 0;
    bestStreak = 0;
    roundProblems = [];
    document.querySelector('.score-bar').style.display = '';

    // Check for mystery double points round
    checkDoublePointsRound();

    updateScoreboard();
    renderPrizeButton();
    updateDailyStreakDisplay();
    nextQuestion();
}

function updateScoreboard() {
    document.getElementById('score').textContent = score;
    document.getElementById('streak').textContent = streak;
    document.getElementById('qnum').textContent = Math.min(total + 1, roundLength);
}

function rebuildCard() {
    const card = document.getElementById('card');
    const doublePointsBadge = isDoublePoints ? '<div class="double-points-badge">⭐ Double Points Round! ⭐</div>' : '';
    card.innerHTML = `
        ${doublePointsBadge}
        <div class="question-label" id="q-label"></div>
        <div class="question-text" id="q-text"></div>
        <div id="extra"></div>
        <div class="answer-area" id="answer-area">
            <input type="number" class="answer-input" id="answer-input" autocomplete="off">
            <button class="submit-btn" id="submit-btn" onclick="submitAnswer()">Go!</button>
        </div>
        <div class="feedback" id="feedback"></div>
        <button class="next-btn" id="next-btn" onclick="nextQuestion()">Next Question</button>
    `;
}

function focusInput() {
    const inp = document.getElementById('answer-input');
    if (inp) {
        inp.value = '';
        inp.className = 'answer-input';
        inp.disabled = false;
        inp.focus();
    }
}

function showRoundEnd() {
    const pct = Math.round((score / roundLength) * 100);
    let msg, emoji;
    if (pct === 100) { msg = "Perfect score! You're the island champion!"; emoji = "🏆"; }
    else if (pct >= 90) { msg = "Tom Nook is giving you a bonus!"; emoji = "🌟"; }
    else if (pct >= 70) { msg = "Your island rating just hit 5 stars!"; emoji = "🍃"; }
    else if (pct >= 50) { msg = "Great work, keep exploring!"; emoji = "🌱"; }
    else { msg = "Every islander starts somewhere! Try again!"; emoji = "💪"; }

    // Confetti for great scores!
    if (pct >= 90) {
        launchConfetti();
        playSound('fanfare');
    }

    // Update daily streak
    updateDailyStreak();

    // Clear double points mode
    document.body.classList.remove('double-points-active');
    isDoublePoints = false;

    // Track round stats
    if (bestStreak > multData.stats.bestStreak) {
        multData.stats.bestStreak = bestStreak;
    }
    multData.stats.roundsPlayed++;

    // Remember previous correct count for place unlock check
    const prevCorrect = multData.stats.totalCorrect || 0;

    // Update problem-level data
    const today = new Date().toISOString().split('T')[0];
    for (const rp of roundProblems) {
        if (!multData.problems[rp.key]) {
            multData.problems[rp.key] = { attempts: 0, correct: 0, lastSeen: today };
        }
        multData.problems[rp.key].attempts++;
        if (rp.correct) multData.problems[rp.key].correct++;
        multData.problems[rp.key].lastSeen = today;

        multData.stats.totalAnswered++;
        if (rp.correct) multData.stats.totalCorrect++;
    }

    // Reset combo
    comboCount = 0;
    document.getElementById('combo-display').classList.remove('active');

    // Check for level unlock
    let unlockHTML = '';
    let levelUpLevel = null;
    if (currentMode === 'times'
        && score / roundLength >= UNLOCK_THRESHOLD
        && currentLevel === unlockedLevel
        && unlockedLevel < LEVELS.length) {
        unlockedLevel++;
        multData.stats.unlockedLevel = unlockedLevel;
        levelUpLevel = LEVELS[unlockedLevel - 1];
        unlockHTML = `
            <div class="unlock-msg">
                <span class="unlock-icon">${levelUpLevel.icon}</span>
                <div class="unlock-title">Level Unlocked!</div>
                <div class="unlock-detail">${levelUpLevel.name} is now open!</div>
            </div>
        `;
    }

    // Check for prize milestones
    const newlyEarnedPrizes = checkPrizeEarned();

    // Check for new island place unlock
    const newPlace = checkNewPlaceUnlocked(prevCorrect, multData.stats.totalCorrect);

    // Save to Firestore (batch at end of round)
    saveMultiplicationData();

    // Show level up animation if unlocked
    if (levelUpLevel) {
        setTimeout(() => showLevelUpAnimation(levelUpLevel), 500);
    }

    // Check for achievements
    setTimeout(() => checkAchievements(), levelUpLevel ? 3500 : 1000);

    // Build place unlock celebration HTML
    let placeHTML = '';
    if (newPlace) {
        launchConfetti();
        playSound('fanfare');
        placeHTML = `
            <div class="place-unlock-msg">
                <span class="place-icon">${newPlace.icon}</span>
                <div class="place-title">New Place Discovered!</div>
                <div class="place-name">${newPlace.name}</div>
                <div class="place-desc">${newPlace.desc}</div>
                <div class="place-stars">🌟 🌟 🌟</div>
            </div>
        `;
    }

    // Build prize earned celebration HTML
    let prizeHTML = '';
    for (const m of newlyEarnedPrizes) {
        const prizeName = multData.prizes[m].name || 'a mystery prize';
        prizeHTML += `
            <div class="prize-earned-msg">
                <span class="prize-earned-icon">🏆</span>
                <div class="prize-earned-title">Prize Earned!</div>
                <div class="prize-earned-detail">${prizeName} — Ask your parent!</div>
            </div>
        `;
    }

    // Build missed problems list from this round
    const missed = roundProblems.filter(rp => !rp.correct);
    let missedHTML = '';
    if (missed.length > 0) {
        const tags = missed.map(rp => `<span class="round-missed-tag">${rp.key.replace('x', ' × ')}</span>`).join('');
        missedHTML = `
            <div class="round-missed">
                <h4>Practice these next time:</h4>
                <div class="round-missed-list">${tags}</div>
            </div>
        `;
    }

    // All-time stats line
    let alltimeHTML = '';
    if (currentUser && multData.stats.totalAnswered > 0) {
        alltimeHTML = `<div class="alltime-stats">
            You've answered ${multData.stats.totalAnswered} questions on the island!
            (${multData.stats.totalCorrect} correct, best streak: ${multData.stats.bestStreak})
        </div>`;
    }

    // Emoji applause crowd
    const applauseEmojis = ['👏', '🎉', '😄', '🥳', '👏', '🌟', '😊', '🎊', '👏'];
    const applauseHTML = `
        <div class="applause-crowd">
            ${applauseEmojis.map(e => `<span>${e}</span>`).join('')}
        </div>
    `;

    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="round-end">
            <h2>${emoji} Round Complete!</h2>
            ${applauseHTML}
            <div class="final-score">${score}/${roundLength}</div>
            <div class="final-msg">${msg}</div>
            <div class="final-details">Best streak this round: ${bestStreak}</div>
            ${unlockHTML}
            ${placeHTML}
            ${prizeHTML}
            ${missedHTML}
            ${alltimeHTML}
            <button class="play-again-btn" onclick="startRound()">Play Again</button>
        </div>
    `;
    document.getElementById('streak-msg').textContent = '';
    renderLevelSelect();
    renderPrizeButton();
}

// ── Times Tables Mode ──

function nextTimesQuestion() {
    rebuildCard();
    answered = false;
    const level = LEVELS[currentLevel - 1];
    const focusFactor = pickRandom(level.factors);
    const otherFactor = randInt(2, 12);
    // Randomly swap so the focus factor isn't always on the left
    const a = Math.random() < 0.5 ? focusFactor : otherFactor;
    const b = a === focusFactor ? otherFactor : focusFactor;
    currentProblemA = a;
    currentProblemB = b;
    const answer = a * b;

    document.getElementById('q-label').textContent = `Level ${level.num} — ${level.name} ${level.icon}`;
    document.getElementById('q-text').innerHTML = `<span class="highlight">${a}</span> &times; <span class="highlight">${b}</span> = ?`;
    document.getElementById('answer-input').dataset.answer = answer;

    updateScoreboard();
    focusInput();
}

// ── Break It Down Mode ──

function nextBreakdownQuestion() {
    rebuildCard();
    answered = false;

    bdA = randInt(13, 19);
    bdB = randInt(2, 12);
    bdTens = 10;
    bdOnes = bdA - 10;
    bdStep = 0;
    currentProblemA = bdA;
    currentProblemB = bdB;

    document.getElementById('q-label').textContent = 'Break It Down';

    showBreakdownStep();
    updateScoreboard();
    focusInput();
}

function showBreakdownStep() {
    const extra = document.getElementById('extra');
    const qText = document.getElementById('q-text');
    const inp = document.getElementById('answer-input');

    extra.innerHTML = `
        <div class="step-tracker">
            <div class="step-dot ${bdStep === 0 ? 'active' : (bdStep > 0 ? 'done' : '')}"></div>
            <div class="step-dot ${bdStep === 1 ? 'active' : (bdStep > 1 ? 'done' : '')}"></div>
            <div class="step-dot ${bdStep === 2 ? 'active' : ''}"></div>
        </div>
        <div class="breakdown-hint">Breaking down ${bdA} &times; ${bdB} into (${bdTens} + ${bdOnes}) &times; ${bdB}</div>
    `;

    if (bdStep === 0) {
        qText.innerHTML = `Step 1: <span class="highlight">${bdTens}</span> &times; <span class="highlight">${bdB}</span> = ?`;
        inp.dataset.answer = bdTens * bdB;
    } else if (bdStep === 1) {
        qText.innerHTML = `Step 2: <span class="highlight">${bdOnes}</span> &times; <span class="highlight">${bdB}</span> = ?`;
        inp.dataset.answer = bdOnes * bdB;
    } else {
        qText.innerHTML = `Final: <span class="highlight">${bdA}</span> &times; <span class="highlight">${bdB}</span> = ?`;
        inp.dataset.answer = bdA * bdB;

        extra.innerHTML = `
            <div class="step-tracker">
                <div class="step-dot done"></div>
                <div class="step-dot done"></div>
                <div class="step-dot active"></div>
            </div>
            <div class="breakdown-hint">${bdTens * bdB} + ${bdOnes * bdB} = ?</div>
        `;
    }
}

// ── Keep Practicing View ──

function showPracticeView() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('btn-practice').classList.add('active');
    document.querySelector('.score-bar').style.display = 'none';
    document.getElementById('streak-msg').textContent = '';
    renderLevelSelect();

    const card = document.getElementById('card');

    // Get problems sorted by lowest accuracy
    const entries = Object.entries(multData.problems);

    if (!currentUser) {
        card.innerHTML = `
            <div class="practice-view">
                <div class="practice-empty">
                    <span class="practice-empty-icon">🏝️</span>
                    Log in to track your progress!
                </div>
                <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
            </div>
        `;
        return;
    }

    if (entries.length === 0) {
        card.innerHTML = `
            <div class="practice-view">
                <div class="practice-empty">
                    <span class="practice-empty-icon">🌴</span>
                    Play some rounds first!<br>
                    Your practice data will show up here.
                </div>
                <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
            </div>
        `;
        return;
    }

    // Sort by accuracy ascending (worst first), only include problems with at least 1 wrong
    const needsPractice = entries
        .map(([key, data]) => ({
            key,
            attempts: data.attempts,
            correct: data.correct,
            accuracy: data.attempts > 0 ? data.correct / data.attempts : 0
        }))
        .filter(p => p.accuracy < 1)
        .sort((a, b) => a.accuracy - b.accuracy)
        .slice(0, 10);

    if (needsPractice.length === 0) {
        card.innerHTML = `
            <div class="practice-view">
                <div class="practice-empty">
                    <span class="practice-empty-icon">🌟</span>
                    Amazing! You've got them all right!<br>
                    Keep playing to stay sharp!
                </div>
                <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
            </div>
        `;
        return;
    }

    let itemsHTML = '';
    for (const p of needsPractice) {
        const pctNum = Math.round(p.accuracy * 100);
        itemsHTML += `
            <div class="practice-item">
                <div class="practice-problem">${p.key.replace('x', ' × ')}</div>
                <div class="practice-bar-wrap">
                    <div class="practice-bar-fill" style="width: ${pctNum}%"></div>
                </div>
                <div class="practice-pct">${pctNum}%</div>
            </div>
        `;
    }

    // Store problems for practice mode
    window.practiceProblems = needsPractice.map(p => p.key);

    card.innerHTML = `
        <div class="practice-view">
            <h3>These ones are almost there!</h3>
            <div class="practice-subtitle">Keep going — you're getting closer!</div>
            ${itemsHTML}
            <button class="play-again-btn" onclick="startPracticeRound()" style="margin-top: 1rem;">Practice These Now</button>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

// Practice mode - drill specific problems
let isPracticeMode = false;
let practiceQueue = [];

function startPracticeRound() {
    isPracticeMode = true;
    practiceViewActive = false;
    practiceQueue = [...window.practiceProblems];

    // Shuffle the practice queue
    for (let i = practiceQueue.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [practiceQueue[i], practiceQueue[j]] = [practiceQueue[j], practiceQueue[i]];
    }

    score = 0;
    total = 0;
    streak = 0;
    bestStreak = 0;
    roundProblems = [];
    roundLength = Math.min(practiceQueue.length, 10);

    document.getElementById('qtotal').textContent = roundLength;
    document.querySelector('.score-bar').style.display = '';
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('btn-practice').classList.add('active');

    updateScoreboard();
    nextPracticeQuestion();
}

function nextPracticeQuestion() {
    if (total >= roundLength) {
        isPracticeMode = false;
        showRoundEnd();
        return;
    }

    rebuildCard();
    answered = false;

    const problemKey = practiceQueue[total];
    const [a, b] = problemKey.split('x').map(Number);
    currentProblemA = a;
    currentProblemB = b;
    const answer = a * b;

    document.getElementById('q-label').textContent = 'Practice Mode 🎯';
    document.getElementById('q-text').innerHTML = `<span class="highlight">${a}</span> &times; <span class="highlight">${b}</span> = ?`;
    document.getElementById('answer-input').dataset.answer = answer;

    updateScoreboard();
    focusInput();
}

// ── Shared Logic ──

function nextQuestion() {
    if (total >= roundLength) {
        isPracticeMode = false;
        showRoundEnd();
        return;
    }
    if (isPracticeMode) {
        nextPracticeQuestion();
    } else if (currentMode === 'times') {
        nextTimesQuestion();
    } else {
        nextBreakdownQuestion();
    }
}

function submitAnswer() {
    if (answered) return;
    const inp = document.getElementById('answer-input');
    const userAnswer = inp.value.trim();
    if (userAnswer === '') return;

    const correct = parseInt(inp.dataset.answer);
    const isCorrect = parseInt(userAnswer) === correct;

    // In breakdown mode, handle steps
    if (currentMode === 'breakdown' && bdStep < 2) {
        if (isCorrect) {
            inp.classList.add('correct');
            bdStep++;
            setTimeout(() => {
                inp.value = '';
                inp.className = 'answer-input';
                showBreakdownStep();
                inp.focus();
            }, 600);
        } else {
            inp.classList.add('wrong');
            const feedback = document.getElementById('feedback');
            feedback.className = 'feedback wrong';
            feedback.textContent = `The answer is ${correct}. Let's keep going!`;
            bdStep++;
            setTimeout(() => {
                feedback.className = 'feedback';
                feedback.style.display = 'none';
                inp.value = '';
                inp.className = 'answer-input';
                showBreakdownStep();
                inp.focus();
            }, 1500);
        }
        return;
    }

    // Final answer (times tables or breakdown final step)
    answered = true;
    total++;
    inp.disabled = true;

    const feedback = document.getElementById('feedback');

    if (isCorrect) {
        const comboBonus = getComboBonus();
        score += (isDoublePoints ? 2 : 1) + comboBonus;
        streak++;
        if (streak > bestStreak) bestStreak = streak;
        inp.classList.add('correct');
        feedback.className = 'feedback correct';
        playSound('correct');
        mascotReact(true);
        runCharacter();
        updateCombo(true);
        feedback.innerHTML = pickRandom(correctMessages);

        // Trigger new features on correct answers
        if (typeof maybeShowVillagerVisitor === 'function') maybeShowVillagerVisitor();
        if (typeof checkStickers === 'function') checkStickers();
        if (typeof maybeGetLuckyItem === 'function') maybeGetLuckyItem();
        if (typeof maybeGetPuzzlePiece === 'function') maybeGetPuzzlePiece();
        if (typeof maybeShowBottleMessage === 'function') maybeShowBottleMessage();
    } else {
        streak = 0;
        inp.classList.add('wrong');
        feedback.className = 'feedback wrong';
        feedback.innerHTML = `${pickRandom(wrongMessages)} The answer was <strong>${correct}</strong>.`;
        playSound('wrong');
        mascotReact(false);
        updateCombo(false);
    }

    // Record problem for this round
    const key = problemKey(currentProblemA, currentProblemB);
    roundProblems.push({ key, correct: isCorrect });

    updateScoreboard();

    const nextBtn = document.getElementById('next-btn');
    nextBtn.style.display = 'block';
    nextBtn.textContent = total >= roundLength ? 'See Results 🎉' : 'Next Question';

    if (streak >= 5) {
        document.getElementById('streak-msg').textContent = `🔥 ${streak} in a row! ${pickRandom(streakMessages)}`;
    } else if (streak >= 3) {
        document.getElementById('streak-msg').textContent = `✨ ${streak} in a row! Nice!`;
    } else {
        document.getElementById('streak-msg').textContent = '';
    }
}

// Enter key submits
document.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
        // Don't intercept Enter on login fields
        if (document.activeElement && document.activeElement.id === 'login-email') {
            document.getElementById('login-password').focus();
            return;
        }
        if (document.activeElement && document.activeElement.id === 'login-password') {
            doLogin();
            return;
        }
        if (practiceViewActive) return;

        const nextBtn = document.getElementById('next-btn');
        if (nextBtn && nextBtn.style.display === 'block') {
            nextQuestion();
        } else {
            submitAnswer();
        }
    }
});

// ── Prize Tracker ──

function getNextMilestone() {
    const total = multData.stats.totalAnswered;
    for (const m of PRIZE_MILESTONES) {
        if (total < m) return m;
    }
    return null; // all milestones earned
}

function renderPrizeButton() {
    const btn = document.getElementById('prize-tracker-btn');
    const total = multData.stats.totalAnswered;
    const next = getNextMilestone();

    if (next === null) {
        // All milestones earned
        btn.style.display = 'flex';
        document.getElementById('prize-progress-text').textContent = 'All prizes earned!';
        document.getElementById('prize-mini-fill').style.width = '100%';
    } else {
        btn.style.display = 'flex';
        document.getElementById('prize-progress-text').textContent = `${total}/${next}`;
        // Find the previous milestone to calculate segment progress
        const idx = PRIZE_MILESTONES.indexOf(next);
        const prevMilestone = idx > 0 ? PRIZE_MILESTONES[idx - 1] : 0;
        const segmentProgress = ((total - prevMilestone) / (next - prevMilestone)) * 100;
        document.getElementById('prize-mini-fill').style.width = Math.min(segmentProgress, 100) + '%';
    }
}

function showPrizeView() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';
    document.getElementById('streak-msg').textContent = '';
    renderLevelSelect();

    const card = document.getElementById('card');
    const total = multData.stats.totalAnswered;
    const next = getNextMilestone();

    // Build progress bar for next milestone
    let progressHTML = '';
    if (next !== null) {
        const idx = PRIZE_MILESTONES.indexOf(next);
        const prevMilestone = idx > 0 ? PRIZE_MILESTONES[idx - 1] : 0;
        const segmentProgress = ((total - prevMilestone) / (next - prevMilestone)) * 100;
        progressHTML = `
            <div class="prize-progress-bar">
                <div class="prize-progress-fill" style="width:${Math.min(segmentProgress, 100)}%"></div>
                <div class="prize-progress-label">${total} / ${next} questions</div>
            </div>
        `;
    } else {
        progressHTML = `
            <div class="prize-progress-bar">
                <div class="prize-progress-fill" style="width:100%"></div>
                <div class="prize-progress-label">All milestones complete!</div>
            </div>
        `;
    }

    // Build milestone list
    let milestonesHTML = '';
    for (const m of PRIZE_MILESTONES) {
        const prize = multData.prizes[m];
        const isEarned = prize.earned || total >= m;
        const isNext = m === next;
        const prizeName = prize.name || '???';

        let cls = 'prize-item';
        let icon = '';

        if (isEarned) {
            cls += ' earned';
            icon = '✅';
        } else if (isNext) {
            cls += ' next-up';
            icon = '🎯';
        } else {
            cls += ' future';
            icon = '🔒';
        }

        milestonesHTML += `
            <div class="${cls}">
                <div class="prize-item-icon">${icon}</div>
                <div class="prize-item-info">
                    <div class="prize-item-milestone">${m} questions</div>
                    <div class="prize-item-name">${prizeName}</div>
                </div>
            </div>
        `;
    }

    // Edit link (only when logged in)
    let editHTML = '';
    if (currentUser) {
        editHTML = `<div class="prize-edit-link" onclick="showPrizeEdit()">Edit Prizes</div>`;
    }

    card.innerHTML = `
        <div class="prize-view">
            <h3>🏆 Prize Progress</h3>
            <div class="prize-subtitle">${total} total questions answered</div>
            ${progressHTML}
            ${milestonesHTML}
            ${editHTML}
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

function showPrizeEdit() {
    const card = document.getElementById('card');
    let editRowsHTML = '';
    for (const m of PRIZE_MILESTONES) {
        const prize = multData.prizes[m];
        editRowsHTML += `
            <div class="prize-edit-row">
                <div class="prize-edit-label">${m}</div>
                <input type="text" class="prize-edit-input" id="prize-input-${m}" value="${prize.name}" placeholder="Enter prize name..." maxlength="80">
            </div>
        `;
    }

    card.innerHTML = `
        <div class="prize-view">
            <h3>🏆 Edit Prizes</h3>
            <div class="prize-subtitle">Set a prize for each milestone</div>
            ${editRowsHTML}
            <button class="prize-save-btn" onclick="savePrizeNames()">Save Prizes</button>
            <button class="back-btn" onclick="showPrizeView()">Cancel</button>
        </div>
    `;

    // Focus first input
    const firstInput = document.getElementById('prize-input-' + PRIZE_MILESTONES[0]);
    if (firstInput) firstInput.focus();
}

function savePrizeNames() {
    for (const m of PRIZE_MILESTONES) {
        const input = document.getElementById('prize-input-' + m);
        if (input) {
            multData.prizes[m].name = input.value.trim();
        }
    }
    saveMultiplicationData();
    showPrizeView();
}

function checkPrizeEarned() {
    const total = multData.stats.totalAnswered;
    const newlyEarned = [];
    for (const m of PRIZE_MILESTONES) {
        if (total >= m && !multData.prizes[m].earned) {
            multData.prizes[m].earned = true;
            newlyEarned.push(m);
        }
    }
    return newlyEarned;
}

// ══════════════════════════════════════════════════════════════════════════
// NEW FEATURES
// ══════════════════════════════════════════════════════════════════════════

// ── Difficulty Modes ──
let currentDifficulty = 'normal'; // easy, normal, hard

function setDifficulty(mode) {
    currentDifficulty = mode;
    document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
    document.querySelector(`.difficulty-btn.${mode}`)?.classList.add('active');

    // Adjust round length based on difficulty
    if (mode === 'easy') {
        roundLength = 10;
    } else if (mode === 'hard') {
        roundLength = 30;
    } else {
        roundLength = currentMode === 'times' ? TIMES_ROUND : BREAKDOWN_ROUND;
    }
    document.getElementById('qtotal').textContent = roundLength;
}

function renderDifficultySelect() {
    let container = document.getElementById('difficulty-select');
    if (!container) {
        container = document.createElement('div');
        container.id = 'difficulty-select';
        container.className = 'difficulty-select';
        const scoreBar = document.querySelector('.score-bar');
        scoreBar.parentNode.insertBefore(container, scoreBar.nextSibling);
    }
    container.innerHTML = `
        <button class="difficulty-btn easy ${currentDifficulty === 'easy' ? 'active' : ''}" onclick="setDifficulty('easy')">🌱 Easy</button>
        <button class="difficulty-btn ${currentDifficulty === 'normal' ? 'active' : ''}" onclick="setDifficulty('normal')">🌿 Normal</button>
        <button class="difficulty-btn hard ${currentDifficulty === 'hard' ? 'active' : ''}" onclick="setDifficulty('hard')">🌋 Hard</button>
    `;
}

// ── Power-ups ──
let powerups = { skip: 3, hint: 3 };

function usePowerup(type) {
    if (powerups[type] <= 0 || answered) return;

    powerups[type]--;
    renderPowerupsBar();

    if (type === 'skip') {
        // Skip this question (no penalty)
        total++;
        if (total >= roundLength) {
            showRoundEnd();
        } else {
            nextQuestion();
        }
    } else if (type === 'hint') {
        // Show a hint
        const inp = document.getElementById('answer-input');
        const answer = parseInt(inp.dataset.answer);
        const hint = Math.floor(answer / 10) * 10;
        const feedback = document.getElementById('feedback');
        feedback.className = 'feedback correct';
        feedback.style.display = 'block';
        feedback.textContent = `Hint: The answer is between ${hint} and ${hint + 10}!`;
    }
}

function renderPowerupsBar() {
    let container = document.getElementById('powerups-bar');
    if (!container) {
        container = document.createElement('div');
        container.id = 'powerups-bar';
        container.className = 'powerups-bar';
        const card = document.getElementById('card');
        card.parentNode.insertBefore(container, card);
    }
    container.innerHTML = `
        <button class="powerup-btn" onclick="usePowerup('skip')" ${powerups.skip <= 0 ? 'disabled' : ''}>
            ⏭️ Skip <span class="powerup-count">${powerups.skip}</span>
        </button>
        <button class="powerup-btn" onclick="usePowerup('hint')" ${powerups.hint <= 0 ? 'disabled' : ''}>
            💡 Hint <span class="powerup-count">${powerups.hint}</span>
        </button>
    `;
}

// ── Collectibles ──
let collectibles = { shells: 0, bugs: 0, fish: 0 };
const COLLECTIBLE_TYPES = [
    { type: 'shells', icon: '🐚', name: 'Shell' },
    { type: 'bugs', icon: '🦋', name: 'Bug' },
    { type: 'fish', icon: '🐟', name: 'Fish' }
];

function maybeCollectItem() {
    // 20% chance to find a collectible on correct answer
    if (Math.random() < 0.2) {
        const item = pickRandom(COLLECTIBLE_TYPES);
        collectibles[item.type]++;
        showCollectiblePopup(item);
        renderCollectiblesBar();
        saveCollectibles();
    }
}

function showCollectiblePopup(item) {
    const popup = document.createElement('div');
    popup.className = 'collectible-popup';
    popup.textContent = item.icon;
    document.body.appendChild(popup);

    setTimeout(() => popup.remove(), 1000);
}

function renderCollectiblesBar() {
    let container = document.getElementById('collectibles-bar');
    if (!container) {
        container = document.createElement('div');
        container.id = 'collectibles-bar';
        container.className = 'collectibles-bar';
        const header = document.querySelector('.header');
        header.parentNode.insertBefore(container, header.nextSibling);
    }
    container.innerHTML = `
        <div class="collectible-item">🐚 ${collectibles.shells}</div>
        <div class="collectible-item">🦋 ${collectibles.bugs}</div>
        <div class="collectible-item">🐟 ${collectibles.fish}</div>
    `;
}

function saveCollectibles() {
    if (!multData.collectibles) multData.collectibles = {};
    multData.collectibles = collectibles;
    saveMultiplicationData();
}

function loadCollectibles() {
    if (multData.collectibles) {
        collectibles = { ...collectibles, ...multData.collectibles };
    }
    renderCollectiblesBar();
}

// ── Seasonal Themes ──
let currentTheme = 'default';

function setTheme(theme) {
    document.body.classList.remove('theme-halloween', 'theme-christmas', 'theme-summer');
    if (theme !== 'default') {
        document.body.classList.add('theme-' + theme);
    }
    currentTheme = theme;
    renderThemeSelect();

    // Save preference
    if (multData.preferences) {
        multData.preferences.theme = theme;
    } else {
        multData.preferences = { theme };
    }
    saveMultiplicationData();
}

function renderThemeSelect() {
    let container = document.getElementById('theme-select');
    if (!container) {
        container = document.createElement('div');
        container.id = 'theme-select';
        container.className = 'theme-select';
        const header = document.querySelector('.header');
        header.appendChild(container);
    }
    container.innerHTML = `
        <button class="theme-btn ${currentTheme === 'default' ? 'active' : ''}" onclick="setTheme('default')" title="Default">🌅</button>
        <button class="theme-btn ${currentTheme === 'summer' ? 'active' : ''}" onclick="setTheme('summer')" title="Summer">☀️</button>
        <button class="theme-btn ${currentTheme === 'halloween' ? 'active' : ''}" onclick="setTheme('halloween')" title="Halloween">🎃</button>
        <button class="theme-btn ${currentTheme === 'christmas' ? 'active' : ''}" onclick="setTheme('christmas')" title="Christmas">🎄</button>
    `;
}

// ── Background Music ──
let musicPlaying = false;
let musicOscillator = null;
let musicGain = null;

function toggleMusic() {
    const btn = document.getElementById('music-toggle');

    if (musicPlaying) {
        musicPlaying = false;
        btn.classList.add('muted');
        btn.textContent = '🔇';
    } else {
        musicPlaying = true;
        btn.classList.remove('muted');
        btn.textContent = '🎵';
        playBackgroundMusic();
    }
}

function playBackgroundMusic() {
    if (!musicPlaying) return;

    try {
        // Create a calm, Animal Crossing-inspired melody
        const playNote = (freq, startTime, duration, type = 'sine') => {
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            osc.connect(gain);
            gain.connect(audioContext.destination);
            osc.frequency.setValueAtTime(freq, audioContext.currentTime + startTime);
            osc.type = type;
            // Soft attack, gentle decay - very peaceful
            gain.gain.setValueAtTime(0, audioContext.currentTime + startTime);
            gain.gain.linearRampToValueAtTime(0.08, audioContext.currentTime + startTime + 0.05);
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + startTime + duration);
            osc.start(audioContext.currentTime + startTime);
            osc.stop(audioContext.currentTime + startTime + duration);
        };

        // Calm island-style melody (like a music box)
        // Using pentatonic scale for that peaceful feel
        const melody = [
            { note: 523, time: 0, dur: 0.6 },      // C5
            { note: 587, time: 0.7, dur: 0.4 },    // D5
            { note: 659, time: 1.2, dur: 0.8 },    // E5
            { note: 784, time: 2.2, dur: 0.6 },    // G5
            { note: 659, time: 3.0, dur: 0.4 },    // E5
            { note: 523, time: 3.6, dur: 0.8 },    // C5
            { note: 587, time: 4.6, dur: 0.6 },    // D5
            { note: 784, time: 5.4, dur: 0.4 },    // G5
            { note: 880, time: 6.0, dur: 1.0 },    // A5
            { note: 784, time: 7.2, dur: 0.6 },    // G5
            { note: 659, time: 8.0, dur: 0.8 },    // E5
            { note: 523, time: 9.0, dur: 1.2 },    // C5
        ];

        // Play the melody
        melody.forEach(n => {
            playNote(n.note, n.time, n.dur, 'sine');
            // Add a soft harmony note (lower octave, quieter)
            playNote(n.note / 2, n.time, n.dur * 0.8, 'triangle');
        });

        // Loop after melody finishes
        const totalTime = 10.5;
        if (musicPlaying) {
            setTimeout(() => {
                if (musicPlaying) playBackgroundMusic();
            }, totalTime * 1000);
        }
    } catch(e) {
        // Audio not supported
    }
}

function stopMusic() {
    musicPlaying = false;
}

function createMusicToggle() {
    if (document.getElementById('music-toggle')) return;
    const btn = document.createElement('button');
    btn.id = 'music-toggle';
    btn.className = 'music-toggle muted';
    btn.textContent = '🔇';
    btn.onclick = toggleMusic;
    document.body.appendChild(btn);
}

// ── Bonus Questions ──
let isBonusQuestion = false;
const BONUS_CHANCE = 0.1; // 10% chance

function checkBonusQuestion() {
    isBonusQuestion = Math.random() < BONUS_CHANCE;
    return isBonusQuestion;
}

function getBonusMultiplier() {
    return isBonusQuestion ? 3 : 1;
}

// Update rebuildCard to show bonus badge
const originalRebuildCard = rebuildCard;
rebuildCard = function() {
    const card = document.getElementById('card');
    const doublePointsBadge = isDoublePoints ? '<div class="double-points-badge">⭐ Double Points Round! ⭐</div>' : '';
    const bonusBadge = isBonusQuestion ? '<div class="bonus-badge">🌟 BONUS QUESTION - 3x Points! 🌟</div>' : '';

    card.innerHTML = `
        ${doublePointsBadge}
        ${bonusBadge}
        <div class="question-label" id="q-label"></div>
        <div class="question-text" id="q-text"></div>
        <div id="extra"></div>
        <div class="answer-area" id="answer-area">
            <input type="number" class="answer-input" id="answer-input" autocomplete="off">
            <button class="submit-btn" id="submit-btn" onclick="submitAnswer()">Go!</button>
        </div>
        <div class="feedback" id="feedback"></div>
        <button class="next-btn" id="next-btn" onclick="nextQuestion()">Next Question</button>
    `;

    if (isBonusQuestion) {
        card.parentNode.classList.add('bonus-question');
    } else {
        card.parentNode.classList.remove('bonus-question');
    }
};

// ── Leaderboard ──
let leaderboard = [];

function updateLeaderboard(name, score) {
    leaderboard.push({ name, score, date: new Date().toISOString() });
    leaderboard.sort((a, b) => b.score - a.score);
    leaderboard = leaderboard.slice(0, 10); // Keep top 10

    // Save to Firebase
    if (currentUser) {
        multData.leaderboard = leaderboard;
        saveMultiplicationData();
    }
}

function showLeaderboard() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    let itemsHTML = '';
    if (leaderboard.length === 0) {
        itemsHTML = '<p style="text-align:center;color:#7a9a5a;">No scores yet! Play a round to get on the board!</p>';
    } else {
        leaderboard.forEach((entry, i) => {
            const rank = i === 0 ? '🥇' : i === 1 ? '🥈' : i === 2 ? '🥉' : (i + 1);
            itemsHTML += `
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">${rank}</div>
                    <div class="leaderboard-name">${entry.name || 'Islander'}</div>
                    <div class="leaderboard-score">${entry.score}</div>
                </div>
            `;
        });
    }

    card.innerHTML = `
        <div class="leaderboard-view">
            <h3>🏆 Leaderboard</h3>
            ${itemsHTML}
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

// Add leaderboard button to mode select
function addLeaderboardButton() {
    const modeSelect = document.querySelector('.mode-select');
    if (!modeSelect.querySelector('#btn-leaderboard')) {
        const btn = document.createElement('button');
        btn.id = 'btn-leaderboard';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🏆</span>Leaderboard';
        btn.onclick = showLeaderboard;
        modeSelect.appendChild(btn);
    }
}

// ── Avatar Creator ──
let avatar = {
    hairColor: '#8d6e63',
    shirtColor: '#4fc3f7',
    pantsColor: '#7986cb',
    hairstyle: 'short',
    eyes: 'normal',
    mouth: 'smile',
    skinColor: '#ffcc80',
    shirtStyle: 'tshirt',
    bottomStyle: 'pants'
};

const EYE_STYLES = {
    normal:   { name: 'Normal',    icon: '👀' },
    big:      { name: 'Big',       icon: '🥺' },
    sparkle:  { name: 'Sparkle',   icon: '✨' },
    sleepy:   { name: 'Sleepy',    icon: '😴' },
    wink:     { name: 'Wink',      icon: '😉' },
    cool:     { name: 'Cool',      icon: '😎' }
};

const MOUTH_STYLES = {
    smile:    { name: 'Smile',     icon: '😊' },
    grin:     { name: 'Grin',      icon: '😁' },
    cat:      { name: 'Cat',       icon: '😺' },
    tongue:   { name: 'Tongue',    icon: '😋' },
    open:     { name: 'Surprised', icon: '😮' },
    flat:     { name: 'Chill',     icon: '😐' }
};

const SKIN_COLORS = ['#ffcc80', '#ffe0bd', '#f5c4a1', '#dba270', '#c68642', '#8d5524'];

const SHIRT_STYLES = {
    tshirt:   { name: 'T-Shirt',   icon: '👕' },
    dress:    { name: 'Dress',     icon: '👗' },
    hoodie:   { name: 'Hoodie',    icon: '🧥' },
    tank:     { name: 'Tank Top',  icon: '🎽' },
    stripe:   { name: 'Striped',   icon: '📏' },
    heart:    { name: 'Heart Tee', icon: '❤️' }
};

const BOTTOM_STYLES = {
    pants:    { name: 'Pants',     icon: '👖' },
    skirt:    { name: 'Skirt',     icon: '💃' },
    shorts:   { name: 'Shorts',    icon: '🩳' }
};

function getBottomSVG(color, style) {
    switch(style) {
        case 'skirt':
            return `<path fill="${color}" d="M 12 35 L 8 47 L 32 47 L 28 35 Z" rx="2"/>`;
        case 'shorts':
            return `<rect fill="${color}" x="12" y="35" width="7" height="6" rx="2"/>
                    <rect fill="${color}" x="21" y="35" width="7" height="6" rx="2"/>`;
        case 'pants':
        default:
            return `<rect fill="${color}" x="12" y="35" width="7" height="12" rx="2"/>
                    <rect fill="${color}" x="21" y="35" width="7" height="12" rx="2"/>`;
    }
}

function getShirtSVG(color, style) {
    const c = color;
    switch(style) {
        case 'dress':
            return `<rect fill="${c}" x="12" y="21" width="16" height="20" rx="3"/>
                    <rect fill="${c}" x="4" y="22" width="8" height="4" rx="2"/>
                    <rect fill="${c}" x="28" y="22" width="8" height="4" rx="2"/>
                    <path fill="${c}" d="M 12 35 Q 10 41 8 41 L 32 41 Q 30 41 28 35 Z" opacity="0.7"/>`;
        case 'hoodie':
            return `<rect fill="${c}" x="12" y="21" width="16" height="14" rx="3"/>
                    <rect fill="${c}" x="4" y="22" width="8" height="10" rx="2"/>
                    <rect fill="${c}" x="28" y="22" width="8" height="10" rx="2"/>
                    <path fill="${c}" d="M 16 21 Q 20 24 24 21" opacity="0.6"/>
                    <rect fill="${c}" x="16" y="28" width="8" height="5" rx="2" opacity="0.7"/>`;
        case 'tank':
            return `<rect fill="${c}" x="14" y="21" width="12" height="14" rx="2"/>`;
        case 'stripe':
            return `<rect fill="${c}" x="12" y="21" width="16" height="14" rx="3"/>
                    <rect fill="${c}" x="4" y="22" width="8" height="4" rx="2"/>
                    <rect fill="${c}" x="28" y="22" width="8" height="4" rx="2"/>
                    <rect fill="rgba(255,255,255,0.4)" x="12" y="24" width="16" height="2"/>
                    <rect fill="rgba(255,255,255,0.4)" x="12" y="29" width="16" height="2"/>`;
        case 'heart':
            return `<rect fill="${c}" x="12" y="21" width="16" height="14" rx="3"/>
                    <rect fill="${c}" x="4" y="22" width="8" height="4" rx="2"/>
                    <rect fill="${c}" x="28" y="22" width="8" height="4" rx="2"/>
                    <text x="20" y="31" text-anchor="middle" font-size="6" fill="rgba(255,255,255,0.8)">♥</text>`;
        case 'tshirt':
        default:
            return `<rect fill="${c}" x="12" y="21" width="16" height="14" rx="3"/>
                    <rect fill="${c}" x="4" y="22" width="8" height="4" rx="2"/>
                    <rect fill="${c}" x="28" y="22" width="8" height="4" rx="2"/>`;
    }
}

function getEyesSVG(style) {
    switch(style) {
        case 'big':
            return `<circle fill="white" cx="15" cy="11" r="3"/>
                    <circle fill="#5d4037" cx="15.5" cy="11" r="2"/>
                    <circle fill="white" cx="25" cy="11" r="3"/>
                    <circle fill="#5d4037" cx="25.5" cy="11" r="2"/>`;
        case 'sparkle':
            return `<circle fill="#5d4037" cx="16" cy="11" r="2"/>
                    <circle fill="white" cx="17" cy="10" r="0.7"/>
                    <circle fill="#5d4037" cx="24" cy="11" r="2"/>
                    <circle fill="white" cx="25" cy="10" r="0.7"/>`;
        case 'sleepy':
            return `<path d="M 14 11 Q 16 12 18 11" fill="none" stroke="#5d4037" stroke-width="1.5" stroke-linecap="round"/>
                    <path d="M 22 11 Q 24 12 26 11" fill="none" stroke="#5d4037" stroke-width="1.5" stroke-linecap="round"/>`;
        case 'wink':
            return `<circle fill="#5d4037" cx="16" cy="11" r="2"/>
                    <path d="M 22 11 Q 24 12 26 11" fill="none" stroke="#5d4037" stroke-width="1.5" stroke-linecap="round"/>`;
        case 'cool':
            return `<rect fill="#333" x="12" y="9.5" width="8" height="3.5" rx="1.5"/>
                    <rect fill="#333" x="21" y="9.5" width="8" height="3.5" rx="1.5"/>
                    <rect fill="#333" x="19.5" y="10" width="2" height="2" rx="0.5"/>`;
        case 'normal':
        default:
            return `<circle fill="#5d4037" cx="16" cy="11" r="2"/>
                    <circle fill="#5d4037" cx="24" cy="11" r="2"/>`;
    }
}

function getMouthSVG(style) {
    switch(style) {
        case 'grin':
            return `<path d="M 14 15 Q 20 21 26 15" fill="none" stroke="#e65100" stroke-width="1.5" stroke-linecap="round"/>`;
        case 'cat':
            return `<path d="M 15 15 L 20 17 L 25 15" fill="none" stroke="#e65100" stroke-width="1.2" stroke-linecap="round"/>`;
        case 'tongue':
            return `<path d="M 16 16 Q 20 20 24 16" fill="none" stroke="#e65100" stroke-width="1.5" stroke-linecap="round"/>
                    <ellipse fill="#ff6b6b" cx="20" cy="18" rx="2" ry="1.5"/>`;
        case 'open':
            return `<ellipse fill="#e65100" cx="20" cy="16.5" rx="2.5" ry="2"/>`;
        case 'flat':
            return `<line x1="16" y1="16" x2="24" y2="16" stroke="#e65100" stroke-width="1.5" stroke-linecap="round"/>`;
        case 'smile':
        default:
            return `<path d="M 16 16 Q 20 20 24 16" fill="none" stroke="#e65100" stroke-width="1.5" stroke-linecap="round"/>`;
    }
}

const HAIRSTYLES = {
    short:    { name: 'Short',      icon: '✂️' },
    long:     { name: 'Long',       icon: '💇‍♀️' },
    pigtails: { name: 'Pigtails',   icon: '🎀' },
    ponytail: { name: 'Ponytail',   icon: '💁‍♀️' },
    curly:    { name: 'Curly',      icon: '🌀' },
    bun:     { name: 'Bun',        icon: '🍡' },
    bob:      { name: 'Bob',        icon: '💇' },
    spiky:    { name: 'Spiky',      icon: '⚡' }
};

function getHairSVG(color, style) {
    switch(style) {
        case 'long':
            return `<ellipse fill="${color}" cx="20" cy="8" rx="10" ry="8"/>
                    <rect fill="${color}" x="10" y="6" width="6" height="22" rx="3"/>
                    <rect fill="${color}" x="24" y="6" width="6" height="22" rx="3"/>`;
        case 'pigtails':
            return `<ellipse fill="${color}" cx="20" cy="8" rx="10" ry="8"/>
                    <circle fill="${color}" cx="6" cy="10" r="5"/>
                    <circle fill="${color}" cx="34" cy="10" r="5"/>
                    <circle fill="#ff4081" cx="9" cy="6" r="2"/>
                    <circle fill="#ff4081" cx="31" cy="6" r="2"/>`;
        case 'ponytail':
            return `<ellipse fill="${color}" cx="20" cy="8" rx="10" ry="8"/>
                    <rect fill="${color}" x="17" y="3" width="6" height="20" rx="3"/>
                    <circle fill="#ff4081" cx="20" cy="5" r="2"/>`;
        case 'curly':
            return `<circle fill="${color}" cx="12" cy="6" r="5"/>
                    <circle fill="${color}" cx="20" cy="4" r="5"/>
                    <circle fill="${color}" cx="28" cy="6" r="5"/>
                    <circle fill="${color}" cx="10" cy="11" r="4"/>
                    <circle fill="${color}" cx="30" cy="11" r="4"/>`;
        case 'bun':
            return `<ellipse fill="${color}" cx="20" cy="8" rx="10" ry="8"/>
                    <circle fill="${color}" cx="20" cy="-1" r="6"/>`;
        case 'bob':
            return `<ellipse fill="${color}" cx="20" cy="8" rx="11" ry="9"/>
                    <rect fill="${color}" x="9" y="6" width="5" height="12" rx="2.5"/>
                    <rect fill="${color}" x="26" y="6" width="5" height="12" rx="2.5"/>`;
        case 'spiky':
            return `<polygon fill="${color}" points="20,0 15,8 10,2 12,10 6,6 10,12 25,8"/>
                    <polygon fill="${color}" points="20,0 25,8 30,2 28,10 34,6 30,12 15,8"/>`;
        case 'short':
        default:
            return `<ellipse fill="${color}" cx="20" cy="8" rx="10" ry="8"/>`;
    }
}

const AVATAR_COLORS = {
    hair: ['#8d6e63', '#5d4037', '#ffeb3b', '#ff5722', '#212121', '#e91e63'],
    shirt: ['#4fc3f7', '#81c784', '#ff8a65', '#ba68c8', '#fff176', '#90a4ae'],
    pants: ['#7986cb', '#4db6ac', '#f06292', '#a1887f', '#64b5f6', '#aed581']
};

function showAvatarCreator() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    const colorOptions = (type) => AVATAR_COLORS[type].map(color =>
        `<div class="avatar-option ${avatar[type + 'Color'] === color ? 'selected' : ''}"
              style="background:${color}"
              onclick="setAvatarColor('${type}', '${color}')"></div>`
    ).join('');

    const hairstyleOptions = Object.entries(HAIRSTYLES).map(([key, h]) => `
        <div class="hairstyle-option ${avatar.hairstyle === key ? 'selected' : ''}"
              onclick="setHairstyle('${key}')">
            <span class="hs-icon">${h.icon}</span>
            <span class="hs-name">${h.name}</span>
        </div>
    `).join('');

    const eyeOptions = Object.entries(EYE_STYLES).map(([key, e]) => `
        <div class="hairstyle-option ${avatar.eyes === key ? 'selected' : ''}"
              onclick="setFaceOption('eyes', '${key}')">
            <span class="hs-icon">${e.icon}</span>
            <span class="hs-name">${e.name}</span>
        </div>
    `).join('');

    const mouthOptions = Object.entries(MOUTH_STYLES).map(([key, m]) => `
        <div class="hairstyle-option ${avatar.mouth === key ? 'selected' : ''}"
              onclick="setFaceOption('mouth', '${key}')">
            <span class="hs-icon">${m.icon}</span>
            <span class="hs-name">${m.name}</span>
        </div>
    `).join('');

    const skinOptions = SKIN_COLORS.map(color =>
        `<div class="avatar-option ${avatar.skinColor === color ? 'selected' : ''}"
              style="background:${color}"
              onclick="setFaceOption('skinColor', '${color}')"></div>`
    ).join('');

    const shirtStyleOptions = Object.entries(SHIRT_STYLES).map(([key, s]) => `
        <div class="hairstyle-option ${(avatar.shirtStyle || 'tshirt') === key ? 'selected' : ''}"
              onclick="setFaceOption('shirtStyle', '${key}')">
            <span class="hs-icon">${s.icon}</span>
            <span class="hs-name">${s.name}</span>
        </div>
    `).join('');

    const bottomStyleOptions = Object.entries(BOTTOM_STYLES).map(([key, b]) => `
        <div class="hairstyle-option ${(avatar.bottomStyle || 'pants') === key ? 'selected' : ''}"
              onclick="setFaceOption('bottomStyle', '${key}')">
            <span class="hs-icon">${b.icon}</span>
            <span class="hs-name">${b.name}</span>
        </div>
    `).join('');

    card.innerHTML = `
        <div class="avatar-creator">
            <h3>🎨 Create Your Character</h3>
            <div class="avatar-preview" id="avatar-preview"></div>

            <div class="avatar-label">Skin Color</div>
            <div class="avatar-options">${skinOptions}</div>

            <div class="avatar-label">Eyes</div>
            <div class="hairstyle-grid">${eyeOptions}</div>

            <div class="avatar-label">Mouth</div>
            <div class="hairstyle-grid">${mouthOptions}</div>

            <div class="avatar-label">Hairstyle</div>
            <div class="hairstyle-grid">${hairstyleOptions}</div>

            <div class="avatar-label">Hair Color</div>
            <div class="avatar-options">${colorOptions('hair')}</div>

            <div class="avatar-label">Top Style</div>
            <div class="hairstyle-grid">${shirtStyleOptions}</div>

            <div class="avatar-label">Top Color</div>
            <div class="avatar-options">${colorOptions('shirt')}</div>

            <div class="avatar-label">Bottom Style</div>
            <div class="hairstyle-grid">${bottomStyleOptions}</div>

            <div class="avatar-label">Bottom Color</div>
            <div class="avatar-options">${colorOptions('pants')}</div>

            <button class="play-again-btn" onclick="saveAvatar()" style="margin-top:1rem">Save Character</button>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Cancel</button>
        </div>
    `;

    updateAvatarPreview();
}

function setAvatarColor(type, color) {
    avatar[type + 'Color'] = color;
    showAvatarCreator(); // Refresh view
}

function setHairstyle(style) {
    avatar.hairstyle = style;
    showAvatarCreator();
}

function setFaceOption(option, value) {
    avatar[option] = value;
    showAvatarCreator();
}

function updateAvatarPreview() {
    const preview = document.getElementById('avatar-preview');
    if (!preview) return;

    preview.innerHTML = `
        <svg viewBox="0 0 40 60" xmlns="http://www.w3.org/2000/svg">
            ${getHairSVG(avatar.hairColor, avatar.hairstyle)}
            <circle fill="${avatar.skinColor || '#ffcc80'}" cx="20" cy="12" r="9"/>
            ${getEyesSVG(avatar.eyes || 'normal')}
            ${getMouthSVG(avatar.mouth || 'smile')}
            ${getShirtSVG(avatar.shirtColor, avatar.shirtStyle || 'tshirt')}
            ${getBottomSVG(avatar.pantsColor, avatar.bottomStyle || 'pants')}
            <ellipse fill="#f44336" cx="15" cy="50" rx="5" ry="3"/>
            <ellipse fill="#f44336" cx="25" cy="50" rx="5" ry="3"/>
        </svg>
    `;
}

function updateRunnerAppearance() {
    const runner = document.getElementById('runner');
    if (!runner) return;
    const svg = runner.querySelector('svg');

    // Update hair
    svg.querySelectorAll('.hair-group').forEach(el => el.remove());
    const oldHair = svg.querySelector('.hair');
    if (oldHair) oldHair.remove();
    const hairGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    hairGroup.classList.add('hair-group');
    hairGroup.innerHTML = getHairSVG(avatar.hairColor, avatar.hairstyle);
    const head = svg.querySelector('.head');
    svg.insertBefore(hairGroup, head);

    // Update skin
    if (head) head.style.fill = avatar.skinColor || '#ffcc80';

    // Update eyes
    svg.querySelectorAll('.eyes, .eyes-group').forEach(el => el.remove());
    const eyesGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    eyesGroup.classList.add('eyes-group');
    eyesGroup.innerHTML = getEyesSVG(avatar.eyes || 'normal');
    const mouth = svg.querySelector('.mouth');
    if (mouth) svg.insertBefore(eyesGroup, mouth);
    else svg.appendChild(eyesGroup);

    // Update mouth
    svg.querySelectorAll('.mouth, .mouth-group').forEach(el => el.remove());
    const mouthGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    mouthGroup.classList.add('mouth-group');
    mouthGroup.innerHTML = getMouthSVG(avatar.mouth || 'smile');
    const shirt = svg.querySelector('.shirt');
    if (shirt) svg.insertBefore(mouthGroup, shirt);
    else svg.appendChild(mouthGroup);

    // Update colors
    runner.querySelectorAll('.shirt').forEach(el => el.style.fill = avatar.shirtColor);
    runner.querySelectorAll('.pants').forEach(el => el.style.fill = avatar.pantsColor);
}

function saveAvatar() {
    updateRunnerAppearance();
    multData.avatar = { ...avatar };
    saveMultiplicationData();

    // Go back to game
    setMode('times', document.getElementById('btn-times'));
}

function loadAvatar() {
    if (multData.avatar) {
        avatar = { ...avatar, ...multData.avatar };
        updateRunnerAppearance();
    }
}

// Add avatar button
function addAvatarButton() {
    const modeSelect = document.querySelector('.mode-select');
    if (!modeSelect.querySelector('#btn-avatar')) {
        const btn = document.createElement('button');
        btn.id = 'btn-avatar';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🎨</span>Character';
        btn.onclick = showAvatarCreator;
        modeSelect.appendChild(btn);
    }
}

// ── Progress Map ──
function showProgressMap() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    const unlockedCount = getUnlockedPlaces();

    // Create a visual grid of places
    let placesHTML = '';
    const positions = [
        { left: '10%', top: '10%' }, { left: '50%', top: '5%' }, { left: '85%', top: '15%' },
        { left: '20%', top: '25%' }, { left: '70%', top: '30%' },
        { left: '5%', top: '45%' }, { left: '40%', top: '40%' }, { left: '80%', top: '50%' },
        { left: '25%', top: '55%' }, { left: '60%', top: '60%' },
        { left: '10%', top: '70%' }, { left: '45%', top: '75%' }, { left: '75%', top: '70%' },
        { left: '30%', top: '85%' }, { left: '55%', top: '90%' }, { left: '85%', top: '85%' },
        { left: '15%', top: '95%' }, { left: '40%', top: '98%' }, { left: '65%', top: '95%' }, { left: '90%', top: '98%' }
    ];

    ISLAND_PLACES.forEach((place, i) => {
        const isLocked = i >= unlockedCount;
        const pos = positions[i] || { left: '50%', top: '50%' };
        placesHTML += `
            <div class="map-place ${isLocked ? 'locked' : ''}" style="left:${pos.left}; top:${pos.top}"
                 onclick="${isLocked ? '' : `visitPlace(${i})`}" ${!isLocked ? 'style="cursor:pointer"' : ''}>
                <span class="place-icon">${isLocked ? '🔒' : place.icon}</span>
                <span class="place-label">${isLocked ? '???' : place.name}</span>
            </div>
        `;
    });

    card.innerHTML = `
        <div style="text-align:center">
            <h3>🗺️ Island Map</h3>
            <p style="color:#7a9a5a;font-size:0.9rem;margin-bottom:0.5rem">
                ${unlockedCount}/${ISLAND_PLACES.length} places discovered! Tap a place to visit!
            </p>
        </div>
        <div class="progress-map" id="island-map">
            ${placesHTML}
        </div>
        <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
    `;
}

// Visit a place on the map
function visitPlace(placeIndex) {
    const place = ISLAND_PLACES[placeIndex];
    playSound('correct');

    // Create popup overlay
    const popup = document.createElement('div');
    popup.className = 'place-visit-popup';
    popup.innerHTML = `
        <div class="place-visit-content">
            <div class="place-visit-icon">${place.icon}</div>
            <h3 class="place-visit-name">${place.name}</h3>
            <p class="place-visit-desc">${place.desc}</p>

            <div class="place-visit-character">
                <span class="character-icon">${place.character}</span>
                <div class="character-info">
                    <div class="character-name">${place.charName}</div>
                    <div class="character-quote">"${place.quote}"</div>
                </div>
            </div>

            <div class="place-visit-gift" id="place-gift">
                <button class="minigame-btn" onclick="claimPlaceGift(${placeIndex})">
                    🎁 Claim Gift!
                </button>
            </div>

            <button class="back-btn" onclick="closePlacePopup()">Back to Map</button>
        </div>
    `;

    // Add styles for the popup
    popup.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        animation: fadeIn 0.3s ease-out;
    `;

    document.body.appendChild(popup);

    // Style the content
    const content = popup.querySelector('.place-visit-content');
    content.style.cssText = `
        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 50%, #c8e6c0 100%);
        border-radius: 20px;
        padding: 1.5rem;
        max-width: 320px;
        text-align: center;
        animation: levelUpPop 0.5s ease-out;
        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    `;

    popup.querySelector('.place-visit-icon').style.cssText = 'font-size: 4rem; margin-bottom: 0.5rem;';
    popup.querySelector('.place-visit-name').style.cssText = 'color: #3d7c47; font-size: 1.3rem; margin-bottom: 0.3rem;';
    popup.querySelector('.place-visit-desc').style.cssText = 'color: #5c4a32; font-size: 0.9rem; margin-bottom: 1rem;';

    const charDiv = popup.querySelector('.place-visit-character');
    charDiv.style.cssText = `
        display: flex;
        align-items: center;
        gap: 0.8rem;
        background: rgba(255,255,255,0.7);
        border-radius: 12px;
        padding: 0.8rem;
        margin-bottom: 1rem;
    `;

    popup.querySelector('.character-icon').style.cssText = 'font-size: 2.5rem;';
    popup.querySelector('.character-name').style.cssText = 'font-weight: 800; color: #3d7c47; font-size: 0.95rem;';
    popup.querySelector('.character-quote').style.cssText = 'font-style: italic; color: #5c4a32; font-size: 0.85rem;';
}

function claimPlaceGift(placeIndex) {
    const place = ISLAND_PLACES[placeIndex];
    const giftDiv = document.getElementById('place-gift');

    // Give reward based on gift type
    const giftIcons = {
        bells: '💰', fossil: '🦴', clothes: '👕', star: '⭐', snack: '🍪',
        shell: '🐚', mushroom: '🍄', bug: '🦋', gem: '💎', treasure: '📦',
        honey: '🍯', music: '🎵', flower: '🌸', pearl: '🦪', crown: '👑'
    };

    const icon = giftIcons[place.gift] || '🎁';

    // Add to collectibles based on type
    if (place.gift === 'shell' || place.gift === 'pearl') {
        collectibles.shells++;
    } else if (place.gift === 'bug') {
        collectibles.bugs++;
    } else if (place.gift === 'fossil') {
        // Add to a special collection or just show it
    }

    renderCollectiblesBar();
    saveCollectibles();

    // Show the gift with animation
    giftDiv.innerHTML = `
        <div style="font-size: 3rem; animation: levelUpPop 0.5s ease-out;">${icon}</div>
        <div style="color: #3d7c47; font-weight: 700; margin-top: 0.5rem;">
            You got: ${place.gift.charAt(0).toUpperCase() + place.gift.slice(1)}!
        </div>
    `;

    playSound('fanfare');
    launchConfetti();
}

function closePlacePopup() {
    const popup = document.querySelector('.place-visit-popup');
    if (popup) {
        popup.style.animation = 'fadeIn 0.2s ease-out reverse';
        setTimeout(() => popup.remove(), 200);
    }
}

// Add map button
function addMapButton() {
    const modeSelect = document.querySelector('.mode-select');
    if (!modeSelect.querySelector('#btn-map')) {
        const btn = document.createElement('button');
        btn.id = 'btn-map';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🗺️</span>Map';
        btn.onclick = showProgressMap;
        modeSelect.appendChild(btn);
    }
}

// ══════════════════════════════════════════════════════════════════════════
// MINI-GAMES
// ══════════════════════════════════════════════════════════════════════════

let gameScore = 0;

// Games Menu
// ══════════════════════════════════════════════════════════════════════════
// ACNH TRIVIA & PERSONALITY QUIZ
// ══════════════════════════════════════════════════════════════════════════

const ACNH_PERSONALITIES = {
    normal: { name: "Normal", icon: "🌸", emoji: "😊", desc: "You're sweet, kind, and caring! You love helping others and always see the best in everyone.", villagers: "Fauna, Molly, Merengue, Marina, Lolly" },
    peppy: { name: "Peppy", icon: "🎀", emoji: "🤩", desc: "You're super energetic and cheerful! You love making friends and spreading happiness!", villagers: "Rosie, Chrissy, Audie, Tangy, Cookie" },
    lazy: { name: "Lazy", icon: "😴", emoji: "😌", desc: "You're laid-back and easygoing! You love food, naps, and bugs.", villagers: "Stitches, Zucker, Sherb, Beau, Lucky" },
    jock: { name: "Jock", icon: "💪", emoji: "🏃", desc: "You're athletic and full of energy! You love sports and staying active!", villagers: "Roald, Dom, Bam, Poncho, Buck" },
    cranky: { name: "Cranky", icon: "😤", emoji: "😠", desc: "You might seem grumpy, but you're actually really caring deep down!", villagers: "Kabuki, Apollo, Fang, Dobie, Octavian" },
    snooty: { name: "Snooty", icon: "💅", emoji: "💁", desc: "You're elegant and sophisticated! You love fashion and the finer things!", villagers: "Judy, Diana, Ankha, Whitney, Francine" },
    sisterly: { name: "Sisterly", icon: "💜", emoji: "😎", desc: "You're tough but caring, like a protective big sister!", villagers: "Cherry, Reneigh, Muffy, Agnes, Fuchsia" },
    smug: { name: "Smug", icon: "😏", emoji: "✨", desc: "You're confident and charming! You know you're great!", villagers: "Marshal, Raymond, Julian, Shep, Kyle" }
};

const PERSONALITY_QUESTIONS = [
    { q: "It's a beautiful morning! What do you do first?", answers: [
        { text: "Water my flowers 🌸", scores: { normal: 2, peppy: 1 } },
        { text: "Go for a jog! 💪", scores: { jock: 2, peppy: 1 } },
        { text: "Sleep more... 😴", scores: { lazy: 2, cranky: 1 } },
        { text: "Check my outfit! 💅", scores: { snooty: 2, smug: 1 } }
    ]},
    { q: "A new villager moved in! How do you greet them?", answers: [
        { text: "Bring a welcome gift 🎁", scores: { normal: 2, sisterly: 1 } },
        { text: "OMG NEW FRIEND!!! 🤩", scores: { peppy: 2, jock: 1 } },
        { text: "Tell them where the snacks are", scores: { lazy: 2, sisterly: 1 } },
        { text: "Introduce myself with style 😏", scores: { smug: 2, snooty: 1 } }
    ]},
    { q: "What's your favorite island activity?", answers: [
        { text: "Catching bugs and fish! 🦋", scores: { lazy: 2, normal: 1 } },
        { text: "Working out! 💪", scores: { jock: 2, peppy: 1 } },
        { text: "Shopping for outfits! 👗", scores: { snooty: 2, peppy: 1 } },
        { text: "Helping friends 💕", scores: { sisterly: 2, normal: 1 } }
    ]},
    { q: "Someone stepped on your flowers! 😱", answers: [
        { text: "It's okay! Accidents happen 😊", scores: { normal: 2, lazy: 1 } },
        { text: "HEY! Watch it! 😤", scores: { cranky: 2, sisterly: 1 } },
        { text: "Let me teach you about flowers 💅", scores: { snooty: 2, smug: 1 } },
        { text: "Race me as punishment! 🏃", scores: { jock: 2, peppy: 1 } }
    ]},
    { q: "Pick a catchphrase!", answers: [
        { text: "~sweetie~", scores: { normal: 2, peppy: 1 } },
        { text: "YEAH BUDDY!", scores: { jock: 2, peppy: 1 } },
        { text: "darling~", scores: { snooty: 2, smug: 1 } },
        { text: "...whatever", scores: { cranky: 2, lazy: 1 } }
    ]}
];

const ACNH_TRIVIA = [
    { q: "What animal is Tom Nook?", a: "Raccoon", wrong: ["Fox", "Bear", "Cat"] },
    { q: "What does Blathers hate?", a: "Bugs", wrong: ["Fish", "Fossils", "Art"] },
    { q: "Who runs the museum?", a: "Blathers", wrong: ["Tom Nook", "Isabelle", "Celeste"] },
    { q: "What instrument does K.K. Slider play?", a: "Guitar", wrong: ["Piano", "Drums", "Violin"] },
    { q: "What animal is Raymond?", a: "Cat", wrong: ["Dog", "Squirrel", "Wolf"] },
    { q: "What is the rarest fish?", a: "Coelacanth", wrong: ["Sea Bass", "Goldfish", "Carp"] },
    { q: "How many fossils can you dig per day?", a: "4", wrong: ["2", "6", "10"] },
    { q: "Who gives you star fragments?", a: "Celeste", wrong: ["Blathers", "Tom Nook", "Isabelle"] },
    { q: "What does Pascal collect?", a: "Scallops", wrong: ["Shells", "Fish", "Bugs"] },
    { q: "Who is Isabelle?", a: "Island Secretary", wrong: ["Shop Owner", "Museum Curator", "Musician"] }
];

let personalityScores = {};
let personalityQuestion = 0;
let triviaScore = 0;
let triviaQuestion = 0;
let shuffledTrivia = [];

function showACNHMenu() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #ff69b4;">🏝️ Animal Crossing Corner!</h3>
            <p style="color: #5c4a32; margin-bottom: 1rem;">Find out which villager personality you are!</p>
            <button class="minigame-btn" onclick="startPersonalityQuiz()" style="padding: 1.5rem 2rem; background: linear-gradient(135deg, #ff69b4, #ff1493); color: white; font-size: 1.1rem;">
                <div style="font-size: 3rem; margin-bottom: 0.5rem;">🎭</div>
                <div>Which Villager Are You?</div>
            </button>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))" style="margin-top: 1rem;">Back to Math</button>
        </div>
    `;
}

function startPersonalityQuiz() {
    personalityScores = { normal: 0, peppy: 0, lazy: 0, jock: 0, cranky: 0, snooty: 0, sisterly: 0, smug: 0 };
    personalityQuestion = 0;
    showPersonalityQ();
}

function showPersonalityQ() {
    if (personalityQuestion >= PERSONALITY_QUESTIONS.length) {
        showPersonalityResult();
        return;
    }

    const q = PERSONALITY_QUESTIONS[personalityQuestion];
    const card = document.getElementById('card');

    card.innerHTML = `
        <div style="text-align: center;">
            <div style="color: #ff69b4; font-weight: 700; margin-bottom: 0.5rem;">Question ${personalityQuestion + 1}/${PERSONALITY_QUESTIONS.length}</div>
            <h3 style="color: #d63384; margin-bottom: 1rem;">${q.q}</h3>
            <div style="display: grid; gap: 0.5rem;">
                ${q.answers.map((a, i) => `
                    <button onclick="answerPersonality(${i})" style="background: linear-gradient(135deg, #fff0f5, #ffe4ec); border: 2px solid #ffb6c1; border-radius: 10px; padding: 0.8rem; font-family: inherit; font-weight: 600; cursor: pointer; text-align: left;">
                        ${a.text}
                    </button>
                `).join('')}
            </div>
        </div>
    `;
}

function answerPersonality(index) {
    const q = PERSONALITY_QUESTIONS[personalityQuestion];
    for (const [type, pts] of Object.entries(q.answers[index].scores)) {
        personalityScores[type] += pts;
    }
    personalityQuestion++;
    showPersonalityQ();
}

function showPersonalityResult() {
    let maxType = 'normal', maxScore = 0;
    for (const [type, score] of Object.entries(personalityScores)) {
        if (score > maxScore) { maxScore = score; maxType = type; }
    }

    const p = ACNH_PERSONALITIES[maxType];
    launchConfetti();
    playSound('fanfare');

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <div style="font-size: 4rem;">${p.emoji}</div>
            <div style="color: #ff69b4; font-size: 0.9rem;">You are a...</div>
            <h2 style="color: #d63384;">${p.icon} ${p.name} ${p.icon}</h2>
            <p style="color: #5c4a32; margin: 1rem 0;">${p.desc}</p>
            <div style="background: #fff0f5; border-radius: 10px; padding: 1rem; margin: 1rem 0;">
                <div style="color: #ff69b4; font-weight: 700;">Villagers like you:</div>
                <div style="color: #5c4a32;">${p.villagers}</div>
            </div>
            <button class="play-again-btn" onclick="showACNHMenu()">Play Again!</button>
        </div>
    `;
}

function startACNHTrivia() {
    triviaScore = 0;
    triviaQuestion = 0;
    shuffledTrivia = [...ACNH_TRIVIA].sort(() => Math.random() - 0.5);
    showTriviaQ();
}

function showTriviaQ() {
    if (triviaQuestion >= shuffledTrivia.length) {
        showTriviaResult();
        return;
    }

    const q = shuffledTrivia[triviaQuestion];
    const answers = [q.a, ...q.wrong].sort(() => Math.random() - 0.5);
    const card = document.getElementById('card');

    card.innerHTML = `
        <div style="text-align: center;">
            <div style="color: #ff69b4; font-weight: 700;">Question ${triviaQuestion + 1}/${shuffledTrivia.length} | Score: ${triviaScore}</div>
            <h3 style="color: #d63384; margin: 1rem 0;">${q.q}</h3>
            <div style="display: grid; gap: 0.5rem;" id="trivia-btns">
                ${answers.map(a => `
                    <button onclick="answerTrivia('${a.replace(/'/g, "\\'")}', this)" style="background: linear-gradient(135deg, #fff0f5, #ffe4ec); border: 2px solid #ffb6c1; border-radius: 10px; padding: 0.8rem; font-family: inherit; font-weight: 600; cursor: pointer;">
                        ${a}
                    </button>
                `).join('')}
            </div>
            <div id="trivia-feedback" style="margin-top: 1rem;"></div>
        </div>
    `;
}

function answerTrivia(answer, btn) {
    const q = shuffledTrivia[triviaQuestion];
    const correct = answer === q.a;

    document.querySelectorAll('#trivia-btns button').forEach(b => {
        b.disabled = true;
        if (b.textContent.trim() === q.a) b.style.background = 'linear-gradient(135deg, #90ee90, #32cd32)';
    });

    if (correct) {
        triviaScore++;
        btn.style.background = 'linear-gradient(135deg, #90ee90, #32cd32)';
        document.getElementById('trivia-feedback').innerHTML = '<div style="color: green; font-weight: 700;">✅ Correct!</div>';
        playSound('correct');
    } else {
        btn.style.background = 'linear-gradient(135deg, #ff6b6b, #ff4444)';
        document.getElementById('trivia-feedback').innerHTML = `<div style="color: red; font-weight: 700;">❌ The answer was: ${q.a}</div>`;
        playSound('wrong');
    }

    setTimeout(() => { triviaQuestion++; showTriviaQ(); }, 1500);
}

function showTriviaResult() {
    const pct = Math.round((triviaScore / shuffledTrivia.length) * 100);
    if (pct >= 80) launchConfetti();

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <div style="font-size: 4rem;">${pct >= 80 ? '🏆' : pct >= 50 ? '⭐' : '🏝️'}</div>
            <h2 style="color: #d63384;">Quiz Complete!</h2>
            <div style="font-size: 2.5rem; font-weight: 800; color: #ff69b4;">${triviaScore}/${shuffledTrivia.length}</div>
            <div style="color: #5c4a32;">${pct}% correct!</div>
            <button class="play-again-btn" onclick="showACNHMenu()" style="margin-top: 1rem;">Play Again!</button>
        </div>
    `;
}

function showGamesMenu() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('btn-minigame')?.classList.add('active');
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align:center">
            <h3 style="color:#3d7c47;margin-bottom:1rem">🎮 Mini-Games</h3>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;max-width:300px;margin:0 auto;">
                <button class="minigame-btn" onclick="showBugGame()" style="padding:1rem">
                    <div style="font-size:2rem">🦋</div>
                    <div>Bug Catching</div>
                </button>
                <button class="minigame-btn" onclick="showFishingGame()" style="padding:1rem">
                    <div style="font-size:2rem">🎣</div>
                    <div>Fishing</div>
                </button>
                <button class="minigame-btn" onclick="showBalloonGame()" style="padding:1rem">
                    <div style="font-size:2rem">🎈</div>
                    <div>Balloon Pop</div>
                </button>
                <button class="minigame-btn" onclick="showShellGame()" style="padding:1rem">
                    <div style="font-size:2rem">🐚</div>
                    <div>Shell Collecting</div>
                </button>
                <button class="minigame-btn" onclick="showFossilGame()" style="padding:1rem">
                    <div style="font-size:2rem">🦴</div>
                    <div>Fossil Dig</div>
                </button>
                <button class="minigame-btn" onclick="showStarGame()" style="padding:1rem">
                    <div style="font-size:2rem">🌟</div>
                    <div>Star Catching</div>
                </button>
                <button class="minigame-btn" onclick="showMemoryGame()" style="padding:1rem">
                    <div style="font-size:2rem">🃏</div>
                    <div>Memory Match</div>
                </button>
                <button class="minigame-btn" onclick="showTargetGame()" style="padding:1rem">
                    <div style="font-size:2rem">🎯</div>
                    <div>Target Practice</div>
                </button>
                <button class="minigame-btn" onclick="visitMysteryIsland()" style="padding:1rem">
                    <div style="font-size:2rem">🏝️</div>
                    <div>Mystery Island</div>
                </button>
            </div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

// ── Bug Catching Game ──
function showBugGame() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="minigame-unlock">
            <h3>🦋 Bug Catching!</h3>
            <p style="color:#5c4a32">Catch as many bugs as you can in 15 seconds!</p>
            <button class="minigame-btn" onclick="startBugGame()">Start Game!</button>
        </div>
        <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
    `;
}

function startBugGame() {
    const card = document.getElementById('card');
    gameScore = 0;
    window.tappedBadItem = false;

    card.innerHTML = `
        <div style="text-align:center;margin-bottom:0.5rem">
            <span id="game-timer" style="font-weight:800;font-size:1.2rem;color:#3d7c47">15</span>s
            <span style="margin-left:1rem">Score: <span id="game-score" style="font-weight:800;color:#c0732a">0</span></span>
        </div>
        <p style="text-align:center;font-size:0.8rem;color:#c0392b;margin-bottom:0.5rem">⚠️ Don't tap the wasps! 🐝</p>
        <div class="bug-game" id="game-area"></div>
    `;

    const gameArea = document.getElementById('game-area');
    const goodBugs = ['🦋', '🐛', '🐞', '🦗', '🪲'];
    const badBug = '🐝';

    const spawnItem = () => {
        const item = document.createElement('div');
        item.className = 'bug';
        const isBad = Math.random() < 0.2; // 20% chance of wasp
        item.textContent = isBad ? badBug : pickRandom(goodBugs);
        item.style.left = Math.random() * 80 + 10 + '%';
        item.style.top = Math.random() * 80 + 10 + '%';
        item.onclick = () => {
            if (isBad) {
                window.tappedBadItem = true;
                item.textContent = '💥';
                item.style.background = '#ff6b6b';
                playSound('wrong');
                setTimeout(() => item.remove(), 300);
            } else {
                gameScore++;
                document.getElementById('game-score').textContent = gameScore;
                item.style.transform = 'scale(0)';
                setTimeout(() => item.remove(), 100);
                playSound('correct');
            }
        };
        gameArea.appendChild(item);
        setTimeout(() => { if (item.parentNode) item.remove(); }, 1500);
    };

    const spawnInterval = setInterval(spawnItem, 400);
    runGameTimer(15, spawnInterval, () => endGameWithBonus('bugs', '🦋', 'bugs caught', 'wasps'));
}

// ── Fishing Game ──
function showFishingGame() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="minigame-unlock">
            <h3>🎣 Fishing!</h3>
            <p style="color:#5c4a32">Catch fish before they swim away! 15 seconds!</p>
            <button class="minigame-btn" onclick="startFishingGame()">Start Fishing!</button>
        </div>
        <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
    `;
}

function startFishingGame() {
    const card = document.getElementById('card');
    gameScore = 0;
    window.tappedBadItem = false;

    card.innerHTML = `
        <div style="text-align:center;margin-bottom:0.5rem">
            <span id="game-timer" style="font-weight:800;font-size:1.2rem;color:#3d7c47">15</span>s
            <span style="margin-left:1rem">Fish: <span id="game-score" style="font-weight:800;color:#c0732a">0</span></span>
        </div>
        <p style="text-align:center;font-size:0.8rem;color:#c0392b;margin-bottom:0.5rem">⚠️ Don't catch the trash! 🥾</p>
        <div class="bug-game" id="game-area" style="background:linear-gradient(180deg, #87ceeb 0%, #1e90ff 50%, #000080 100%)"></div>
    `;

    const gameArea = document.getElementById('game-area');
    const goodFish = ['🐟', '🐠', '🐡', '🦈', '🐙', '🦑', '🦐', '🦀'];
    const badItems = ['🥾', '🗑️', '👢'];

    const spawnItem = () => {
        const item = document.createElement('div');
        item.className = 'bug';
        const isBad = Math.random() < 0.2;
        item.textContent = isBad ? pickRandom(badItems) : pickRandom(goodFish);
        item.style.left = '-10%';
        item.style.top = Math.random() * 70 + 15 + '%';
        item.style.transition = 'left 2s linear';
        item.onclick = () => {
            if (isBad) {
                window.tappedBadItem = true;
                item.textContent = '💥';
                item.style.background = '#ff6b6b';
                playSound('wrong');
                setTimeout(() => item.remove(), 300);
            } else {
                gameScore++;
                document.getElementById('game-score').textContent = gameScore;
                item.textContent = '💥';
                setTimeout(() => item.remove(), 200);
                playSound('correct');
            }
        };
        gameArea.appendChild(item);
        setTimeout(() => { item.style.left = '110%'; }, 50);
        setTimeout(() => { if (item.parentNode) item.remove(); }, 2100);
    };

    const spawnInterval = setInterval(spawnItem, 500);
    runGameTimer(15, spawnInterval, () => endGameWithBonus('fish', '🎣', 'fish caught', 'trash'));
}

// ── Balloon Pop Game ──
function showBalloonGame() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="minigame-unlock">
            <h3>🎈 Balloon Pop!</h3>
            <p style="color:#5c4a32">Pop the balloons before they float away!</p>
            <button class="minigame-btn" onclick="startBalloonGame()">Start Popping!</button>
        </div>
        <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
    `;
}

function startBalloonGame() {
    const card = document.getElementById('card');
    gameScore = 0;
    window.tappedBadItem = false;

    card.innerHTML = `
        <div style="text-align:center;margin-bottom:0.5rem">
            <span id="game-timer" style="font-weight:800;font-size:1.2rem;color:#3d7c47">15</span>s
            <span style="margin-left:1rem">Popped: <span id="game-score" style="font-weight:800;color:#c0732a">0</span></span>
        </div>
        <p style="text-align:center;font-size:0.8rem;color:#c0392b;margin-bottom:0.5rem">⚠️ Don't pop the black balloons! 🖤</p>
        <div class="bug-game" id="game-area" style="background:linear-gradient(180deg, #87ceeb 0%, #b0e0e6 50%, #98fb98 100%)"></div>
    `;

    const gameArea = document.getElementById('game-area');
    const goodColors = ['#ff6b6b', '#feca57', '#48dbfb', '#ff9ff3', '#54a0ff', '#5f27cd'];

    const spawnItem = () => {
        const item = document.createElement('div');
        item.className = 'bug';
        item.textContent = '🎈';
        const isBad = Math.random() < 0.15;
        item.style.color = isBad ? '#222' : pickRandom(goodColors);
        item.style.left = Math.random() * 80 + 10 + '%';
        item.style.bottom = '-10%';
        item.style.top = 'auto';
        item.style.transition = 'bottom 3s linear';
        item.style.fontSize = '2.5rem';
        item.onclick = () => {
            if (isBad) {
                window.tappedBadItem = true;
                item.textContent = '💀';
                playSound('wrong');
                setTimeout(() => item.remove(), 300);
            } else {
                gameScore++;
                document.getElementById('game-score').textContent = gameScore;
                item.textContent = '💥';
                setTimeout(() => item.remove(), 150);
                playSound('correct');
            }
        };
        gameArea.appendChild(item);
        setTimeout(() => { item.style.bottom = '110%'; }, 50);
        setTimeout(() => { if (item.parentNode) item.remove(); }, 3100);
    };

    const spawnInterval = setInterval(spawnItem, 400);
    runGameTimer(15, spawnInterval, () => endGameWithBonus('balloons', '🎈', 'balloons popped', 'black balloons'));
}

// ── Shell Collecting Game ──
function showShellGame() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="minigame-unlock">
            <h3>🐚 Shell Collecting!</h3>
            <p style="color:#5c4a32">Grab shells before the waves take them!</p>
            <button class="minigame-btn" onclick="startShellGame()">Start Collecting!</button>
        </div>
        <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
    `;
}

function startShellGame() {
    const card = document.getElementById('card');
    gameScore = 0;
    window.tappedBadItem = false;

    card.innerHTML = `
        <div style="text-align:center;margin-bottom:0.5rem">
            <span id="game-timer" style="font-weight:800;font-size:1.2rem;color:#3d7c47">15</span>s
            <span style="margin-left:1rem">Shells: <span id="game-score" style="font-weight:800;color:#c0732a">0</span></span>
        </div>
        <p style="text-align:center;font-size:0.8rem;color:#c0392b;margin-bottom:0.5rem">⚠️ Don't touch the crabs! 🦀</p>
        <div class="bug-game" id="game-area" style="background:linear-gradient(180deg, #87ceeb 20%, #1e90ff 40%, #f4a460 60%, #deb887 100%)"></div>
    `;

    const gameArea = document.getElementById('game-area');
    const goodShells = ['🐚', '🦪', '🐚'];
    const badItem = '🦀';

    const spawnItem = () => {
        const item = document.createElement('div');
        item.className = 'bug';
        const isBad = Math.random() < 0.2;
        item.textContent = isBad ? badItem : pickRandom(goodShells);
        item.style.left = Math.random() * 80 + 10 + '%';
        item.style.top = Math.random() * 30 + 60 + '%';
        item.onclick = () => {
            if (isBad) {
                window.tappedBadItem = true;
                item.textContent = '😵';
                playSound('wrong');
                setTimeout(() => item.remove(), 300);
            } else {
                gameScore++;
                document.getElementById('game-score').textContent = gameScore;
                item.textContent = '✨';
                setTimeout(() => item.remove(), 150);
                playSound('correct');
            }
        };
        gameArea.appendChild(item);
        setTimeout(() => { if (item.parentNode) item.remove(); }, 1200);
    };

    const spawnInterval = setInterval(spawnItem, 350);
    runGameTimer(15, spawnInterval, () => endGameWithBonus('shells', '🐚', 'shells collected', 'crabs'));
}

// ── Fossil Dig Game ──
function showFossilGame() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="minigame-unlock">
            <h3>🦴 Fossil Dig!</h3>
            <p style="color:#5c4a32">Tap the X marks to dig up fossils!</p>
            <button class="minigame-btn" onclick="startFossilGame()">Start Digging!</button>
        </div>
        <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
    `;
}

function startFossilGame() {
    const card = document.getElementById('card');
    gameScore = 0;

    card.innerHTML = `
        <div style="text-align:center;margin-bottom:0.5rem">
            <span id="game-timer" style="font-weight:800;font-size:1.2rem;color:#3d7c47">15</span>s
            <span style="margin-left:1rem">Fossils: <span id="game-score" style="font-weight:800;color:#c0732a">0</span></span>
        </div>
        <div class="bug-game" id="game-area" style="background:linear-gradient(180deg, #8b4513 0%, #a0522d 30%, #d2691e 60%, #deb887 100%)"></div>
    `;

    const gameArea = document.getElementById('game-area');
    const fossils = ['🦴', '🦷', '💀', '🦴', '🐚'];

    const spawnItem = () => {
        const item = document.createElement('div');
        item.className = 'bug';
        item.textContent = '❌';
        item.style.left = Math.random() * 80 + 10 + '%';
        item.style.top = Math.random() * 80 + 10 + '%';
        item.style.fontSize = '1.5rem';
        item.onclick = () => {
            gameScore++;
            document.getElementById('game-score').textContent = gameScore;
            item.textContent = pickRandom(fossils);
            item.style.fontSize = '2rem';
            playSound('correct');
            setTimeout(() => item.remove(), 500);
        };
        gameArea.appendChild(item);
        setTimeout(() => { if (item.parentNode) item.remove(); }, 2000);
    };

    const spawnInterval = setInterval(spawnItem, 600);
    runGameTimer(15, spawnInterval, () => endGame('fossils', '🦴', 'fossils found'));
}

// ── Star Catching Game ──
function showStarGame() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div class="minigame-unlock">
            <h3>🌟 Star Catching!</h3>
            <p style="color:#5c4a32">Catch shooting stars and make wishes!</p>
            <button class="minigame-btn" onclick="startStarGame()">Start Wishing!</button>
        </div>
        <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
    `;
}

function startStarGame() {
    const card = document.getElementById('card');
    gameScore = 0;

    card.innerHTML = `
        <div style="text-align:center;margin-bottom:0.5rem">
            <span id="game-timer" style="font-weight:800;font-size:1.2rem;color:#ffd700">15</span>s
            <span style="margin-left:1rem">Wishes: <span id="game-score" style="font-weight:800;color:#ffd700">0</span></span>
        </div>
        <div class="bug-game" id="game-area" style="background:linear-gradient(180deg, #0a0a2e 0%, #1a1a4e 50%, #2a2a6e 100%)"></div>
    `;

    const gameArea = document.getElementById('game-area');
    const stars = ['⭐', '🌟', '✨', '💫', '⭐'];

    // Add some static stars for ambiance
    for (let i = 0; i < 20; i++) {
        const star = document.createElement('div');
        star.style.position = 'absolute';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.fontSize = '0.5rem';
        star.style.opacity = Math.random() * 0.5 + 0.3;
        star.textContent = '·';
        star.style.color = 'white';
        star.style.pointerEvents = 'none';
        gameArea.appendChild(star);
    }

    const spawnItem = () => {
        const item = document.createElement('div');
        item.className = 'bug';
        item.textContent = pickRandom(stars);
        item.style.right = '-10%';
        item.style.left = 'auto';
        item.style.top = Math.random() * 50 + '%';
        item.style.transition = 'right 1.5s linear, top 1.5s linear';
        item.style.fontSize = '2rem';
        item.onclick = () => {
            gameScore++;
            document.getElementById('game-score').textContent = gameScore;
            item.textContent = '🌠';
            item.style.fontSize = '2.5rem';
            playSound('correct');
            setTimeout(() => item.remove(), 300);
        };
        gameArea.appendChild(item);
        const endTop = parseFloat(item.style.top) + 40;
        setTimeout(() => {
            item.style.right = '110%';
            item.style.top = endTop + '%';
        }, 50);
        setTimeout(() => { if (item.parentNode) item.remove(); }, 1600);
    };

    const spawnInterval = setInterval(spawnItem, 400);
    runGameTimer(15, spawnInterval, () => endGame('stars', '🌟', 'wishes made'));
}

// ── Shared Game Functions ──
function runGameTimer(seconds, spawnInterval, endCallback) {
    let timeLeft = seconds;
    const timerEl = document.getElementById('game-timer');

    const countdown = setInterval(() => {
        timeLeft--;
        timerEl.textContent = timeLeft;

        if (timeLeft <= 0) {
            clearInterval(countdown);
            clearInterval(spawnInterval);
            endCallback();
        }
    }, 1000);
}

function endGame(collectibleType, icon, message) {
    const card = document.getElementById('card');

    // Add to collectibles
    if (collectibleType === 'bugs') collectibles.bugs += gameScore;
    else if (collectibleType === 'fish') collectibles.fish += gameScore;
    else if (collectibleType === 'shells') collectibles.shells += gameScore;
    // Stars and fossils don't add to collectibles but are still fun!

    renderCollectiblesBar();
    saveCollectibles();

    if (gameScore >= 10) launchConfetti();

    const trophy = gameScore >= 15 ? '🏆' : gameScore >= 10 ? '🌟' : gameScore >= 5 ? '⭐' : '👏';

    card.innerHTML = `
        <div style="text-align:center;padding:2rem">
            <h2 style="color:#3d7c47">${icon} Game Over!</h2>
            <div style="font-size:3rem;margin:1rem 0">${trophy}</div>
            <div style="font-size:2rem;font-weight:800;color:#c0732a">${gameScore} ${message}!</div>
            ${collectibleType === 'bugs' || collectibleType === 'fish' || collectibleType === 'shells' ?
                `<p style="color:#7a9a5a;margin-top:0.5rem">+${gameScore} added to your collection!</p>` : ''}
            <button class="play-again-btn" onclick="start${collectibleType.charAt(0).toUpperCase() + collectibleType.slice(1)}Game ? start${collectibleType.charAt(0).toUpperCase() + collectibleType.slice(1)}Game() : showGamesMenu()" style="margin-top:1rem">Play Again</button>
            <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
        </div>
    `;

    // Fix the play again button
    const playAgainBtn = card.querySelector('.play-again-btn');
    const gameMap = {
        bugs: startBugGame,
        fish: startFishingGame,
        shells: startShellGame,
        fossils: startFossilGame,
        stars: startStarGame,
        balloons: startBalloonGame
    };
    playAgainBtn.onclick = gameMap[collectibleType] || showGamesMenu;
}

// End game with bonus question if avoided bad items!
function endGameWithBonus(collectibleType, icon, message, avoidedWhat) {
    const card = document.getElementById('card');

    // Add to collectibles first
    if (collectibleType === 'bugs') collectibles.bugs += gameScore;
    else if (collectibleType === 'fish') collectibles.fish += gameScore;
    else if (collectibleType === 'shells') collectibles.shells += gameScore;

    renderCollectiblesBar();
    saveCollectibles();

    // Check if player avoided all bad items
    if (!window.tappedBadItem && gameScore > 0) {
        // BONUS QUESTION TIME!
        const a = Math.floor(Math.random() * 10) + 2;
        const b = Math.floor(Math.random() * 10) + 2;
        const correctAnswer = a * b;

        card.innerHTML = `
            <div style="text-align:center;padding:1.5rem">
                <h2 style="color:#f39c12">🌟 BONUS QUESTION! 🌟</h2>
                <p style="color:#3d7c47;font-weight:700">You avoided all the ${avoidedWhat}!</p>
                <p style="color:#5c4a32;margin:1rem 0">Answer correctly for +10 bonus points!</p>
                <div style="font-size:2rem;font-weight:800;color:#3d7c47;margin:1rem 0">
                    ${a} × ${b} = ?
                </div>
                <input type="number" id="bonus-answer" class="answer-input" style="font-size:1.5rem;width:120px;text-align:center" autocomplete="off">
                <button class="submit-btn" onclick="checkBonusAnswer(${correctAnswer}, '${collectibleType}', '${icon}', '${message}')" style="margin-top:1rem;font-size:1.2rem">Submit!</button>
            </div>
        `;

        document.getElementById('bonus-answer').focus();

        // Allow Enter key
        document.getElementById('bonus-answer').onkeydown = (e) => {
            if (e.key === 'Enter') {
                checkBonusAnswer(correctAnswer, collectibleType, icon, message);
            }
        };
    } else {
        // Normal end (tapped bad item or no score)
        if (gameScore >= 10) launchConfetti();
        const trophy = gameScore >= 15 ? '🏆' : gameScore >= 10 ? '🌟' : gameScore >= 5 ? '⭐' : '👏';

        card.innerHTML = `
            <div style="text-align:center;padding:2rem">
                <h2 style="color:#3d7c47">${icon} Game Over!</h2>
                ${window.tappedBadItem ? '<p style="color:#c0392b">Oops! You tapped a bad item - no bonus this time!</p>' : ''}
                <div style="font-size:3rem;margin:1rem 0">${trophy}</div>
                <div style="font-size:2rem;font-weight:800;color:#c0732a">${gameScore} ${message}!</div>
                ${collectibleType === 'bugs' || collectibleType === 'fish' || collectibleType === 'shells' ?
                    `<p style="color:#7a9a5a;margin-top:0.5rem">+${gameScore} added to your collection!</p>` : ''}
                <button class="play-again-btn" style="margin-top:1rem">Play Again</button>
                <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
            </div>
        `;

        const gameMap = { bugs: startBugGame, fish: startFishingGame, shells: startShellGame, fossils: startFossilGame, stars: startStarGame, balloons: startBalloonGame };
        card.querySelector('.play-again-btn').onclick = gameMap[collectibleType] || showGamesMenu;
    }
}

function checkBonusAnswer(correctAnswer, collectibleType, icon, message) {
    const input = document.getElementById('bonus-answer');
    const userAnswer = parseInt(input.value);
    const card = document.getElementById('card');

    if (userAnswer === correctAnswer) {
        // CORRECT! +10 bonus!
        gameScore += 10;
        if (collectibleType === 'bugs') collectibles.bugs += 10;
        else if (collectibleType === 'fish') collectibles.fish += 10;
        else if (collectibleType === 'shells') collectibles.shells += 10;

        renderCollectiblesBar();
        saveCollectibles();
        launchConfetti();
        playSound('fanfare');

        card.innerHTML = `
            <div style="text-align:center;padding:2rem">
                <h2 style="color:#27ae60">🎉 BONUS EARNED! 🎉</h2>
                <div style="font-size:4rem;margin:1rem 0">🏆</div>
                <div style="font-size:2rem;font-weight:800;color:#f39c12">+10 BONUS POINTS!</div>
                <div style="font-size:1.5rem;font-weight:700;color:#c0732a;margin-top:0.5rem">Total: ${gameScore} ${message}!</div>
                <button class="play-again-btn" style="margin-top:1rem">Play Again</button>
                <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
            </div>
        `;
    } else {
        // Wrong answer
        playSound('wrong');

        card.innerHTML = `
            <div style="text-align:center;padding:2rem">
                <h2 style="color:#e74c3c">Not quite!</h2>
                <p style="color:#5c4a32">The answer was ${correctAnswer}</p>
                <div style="font-size:3rem;margin:1rem 0">😅</div>
                <div style="font-size:1.5rem;font-weight:700;color:#c0732a">${gameScore} ${message}!</div>
                <p style="color:#7a9a5a">Try again next time for the bonus!</p>
                <button class="play-again-btn" style="margin-top:1rem">Play Again</button>
                <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
            </div>
        `;
    }

    const gameMap = { bugs: startBugGame, fish: startFishingGame, shells: startShellGame, fossils: startFossilGame, stars: startStarGame, balloons: startBalloonGame };
    card.querySelector('.play-again-btn').onclick = gameMap[collectibleType] || showGamesMenu;
}

// Add mini-game button
function addMinigameButton() {
    const modeSelect = document.querySelector('.mode-select');
    if (!modeSelect.querySelector('#btn-minigame')) {
        const btn = document.createElement('button');
        btn.id = 'btn-minigame';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🎮</span>Games';
        btn.onclick = showGamesMenu;
        modeSelect.appendChild(btn);
    }
}


// ── Update submitAnswer to include collectibles and bonus ──
const originalSubmitAnswer = submitAnswer;
submitAnswer = function() {
    if (answered) return;
    const inp = document.getElementById('answer-input');
    const userAnswer = inp.value.trim();
    if (userAnswer === '') return;

    const correct = parseInt(inp.dataset.answer);
    const isCorrect = parseInt(userAnswer) === correct;

    // In breakdown mode, handle steps
    if (currentMode === 'breakdown' && bdStep < 2) {
        if (isCorrect) {
            inp.classList.add('correct');
            bdStep++;
            setTimeout(() => {
                inp.value = '';
                inp.className = 'answer-input';
                showBreakdownStep();
                inp.focus();
            }, 600);
        } else {
            inp.classList.add('wrong');
            const feedback = document.getElementById('feedback');
            feedback.className = 'feedback wrong';
            feedback.textContent = `The answer is ${correct}. Let's keep going!`;
            bdStep++;
            setTimeout(() => {
                feedback.className = 'feedback';
                feedback.style.display = 'none';
                inp.value = '';
                inp.className = 'answer-input';
                showBreakdownStep();
                inp.focus();
            }, 1500);
        }
        return;
    }

    // Final answer (times tables or breakdown final step)
    answered = true;
    total++;
    inp.disabled = true;

    const feedback = document.getElementById('feedback');

    if (isCorrect) {
        const comboBonus = getComboBonus();
        const bonusMultiplier = getBonusMultiplier();
        score += ((isDoublePoints ? 2 : 1) + comboBonus) * bonusMultiplier;
        streak++;
        if (streak > bestStreak) bestStreak = streak;
        inp.classList.add('correct');
        feedback.className = 'feedback correct';
        playSound('correct');
        mascotReact(true);
        runCharacter();
        updateCombo(true);
        maybeCollectItem(); // Chance to find collectible!
        petBuddyReact(true); // Pet reacts!
        growFlower(); // Chance to grow a flower!
        discoverCreature('bugs'); // Chance to discover for encyclopedia
        maybeUnlockSong(); // Chance to unlock a K.K. song
        createShootingStar(); // Maybe a shooting star appears!
        if (streak >= 10) showAnimalParade(); // Animal parade on big streak!
        feedback.innerHTML = pickRandom(correctMessages);
    } else {
        streak = 0;
        inp.classList.add('wrong');
        feedback.className = 'feedback wrong';
        feedback.innerHTML = `${pickRandom(wrongMessages)} The answer was <strong>${correct}</strong>.`;
        playSound('wrong');
        mascotReact(false);
        updateCombo(false);
    }

    // Record problem for this round
    const key = problemKey(currentProblemA, currentProblemB);
    roundProblems.push({ key, correct: isCorrect });

    updateScoreboard();

    const nextBtn = document.getElementById('next-btn');
    nextBtn.style.display = 'block';
    nextBtn.textContent = total >= roundLength ? 'See Results 🎉' : 'Next Question';

    if (streak >= 5) {
        document.getElementById('streak-msg').textContent = `🔥 ${streak} in a row! ${pickRandom(streakMessages)}`;
    } else if (streak >= 3) {
        document.getElementById('streak-msg').textContent = `✨ ${streak} in a row! Nice!`;
    } else {
        document.getElementById('streak-msg').textContent = '';
    }

    // Reset bonus question for next
    isBonusQuestion = false;
};

// ── Update nextQuestion to check for bonus ──
const originalNextQuestion = nextQuestion;
nextQuestion = function() {
    if (total >= roundLength) {
        isPracticeMode = false;
        showRoundEnd();
        return;
    }

    // Check for bonus question
    checkBonusQuestion();

    if (isPracticeMode) {
        nextPracticeQuestion();
    } else if (currentMode === 'times') {
        nextTimesQuestion();
    } else {
        nextBreakdownQuestion();
    }
};

// ── Update showRoundEnd to add to leaderboard ──
const originalShowRoundEnd = showRoundEnd;
showRoundEnd = function() {
    // Add score to leaderboard
    const name = multData.islandName || 'Islander';
    updateLeaderboard(name, score);

    // Reset powerups for next round
    powerups = { skip: 3, hint: 3 };
    renderPowerupsBar();

    // Maybe get a letter from Mom!
    maybeShowLetter();

    // Call original
    originalShowRoundEnd();
};

// ── Initialize all new features ──
// ══════════════════════════════════════════════════════════════════════════
// EVEN MORE AWESOME FEATURES!
// ══════════════════════════════════════════════════════════════════════════

// ── Pet Buddy System ──
let petBuddy = { type: '🐕', name: 'Buddy', level: 1, happiness: 100 };
const PET_TYPES = ['🐕', '🐈', '🐹', '🐰', '🦊', '🐻', '🐼', '🦁', '🐸', '🦉'];

function createPetBuddy() {
    let pet = document.getElementById('pet-buddy');
    if (!pet) {
        pet = document.createElement('div');
        pet.id = 'pet-buddy';
        pet.style.cssText = `
            position: fixed;
            bottom: 70px;
            right: 70px;
            font-size: 2.5rem;
            z-index: 100;
            cursor: pointer;
            transition: transform 0.3s;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        `;
        pet.onclick = petBuddyClick;
        document.body.appendChild(pet);
    }
    pet.textContent = petBuddy.type;
    pet.title = `${petBuddy.name} (Level ${petBuddy.level})`;
}

function petBuddyClick() {
    const pet = document.getElementById('pet-buddy');
    pet.style.transform = 'scale(1.3) rotate(10deg)';
    setTimeout(() => pet.style.transform = '', 300);

    // Show pet menu
    showPetMenu();
}

function petBuddyReact(isHappy) {
    const pet = document.getElementById('pet-buddy');
    if (!pet) return;

    if (isHappy) {
        pet.style.animation = 'mascotHappy 0.5s ease-out';
        petBuddy.happiness = Math.min(100, petBuddy.happiness + 5);
    } else {
        pet.style.animation = 'mascotSad 0.5s ease-out';
    }
    setTimeout(() => pet.style.animation = '', 500);
}

function showPetMenu() {
    const popup = document.createElement('div');
    popup.className = 'pet-popup';
    popup.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); display: flex; align-items: center;
        justify-content: center; z-index: 3000;
    `;

    const petOptions = PET_TYPES.map(p =>
        `<span style="font-size:2rem;cursor:pointer;padding:0.3rem;" onclick="changePet('${p}')">${p}</span>`
    ).join('');

    popup.innerHTML = `
        <div style="background: linear-gradient(135deg, #ffecd2, #fcb69f); border-radius: 20px; padding: 1.5rem; text-align: center; max-width: 300px;">
            <div style="font-size: 4rem; margin-bottom: 0.5rem;">${petBuddy.type}</div>
            <h3 style="color: #3d7c47;">${petBuddy.name}</h3>
            <p style="color: #5c4a32;">Level ${petBuddy.level} • Happiness: ${petBuddy.happiness}%</p>
            <div style="margin: 1rem 0;">
                <input type="text" id="pet-name-input" value="${petBuddy.name}"
                    style="padding: 0.5rem; border-radius: 8px; border: 2px solid #3d7c47; text-align: center; font-family: inherit;">
            </div>
            <p style="color: #7a9a5a; font-size: 0.85rem; margin-bottom: 0.5rem;">Choose your pet:</p>
            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 0.3rem; margin-bottom: 1rem;">
                ${petOptions}
            </div>
            <button class="minigame-btn" onclick="savePetSettings()">Save</button>
            <button class="back-btn" onclick="this.parentElement.parentElement.remove()">Close</button>
        </div>
    `;
    document.body.appendChild(popup);
}

function changePet(type) {
    petBuddy.type = type;
    document.getElementById('pet-buddy').textContent = type;
}

function savePetSettings() {
    const nameInput = document.getElementById('pet-name-input');
    if (nameInput) petBuddy.name = nameInput.value || 'Buddy';
    multData.petBuddy = petBuddy;
    saveMultiplicationData();
    document.querySelector('.pet-popup')?.remove();
    createPetBuddy();
}

// ── Daily Spin Wheel ──
let lastSpinDate = null;

function canSpinToday() {
    const today = new Date().toISOString().split('T')[0];
    return lastSpinDate !== today;
}

function showSpinWheel() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    const canSpin = canSpinToday();

    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🎰 Daily Prize Wheel!</h3>
            <div id="wheel-container" style="position: relative; width: 200px; height: 200px; margin: 1rem auto;">
                <div id="wheel" style="width: 100%; height: 100%; border-radius: 50%;
                    background: conic-gradient(#ff6b6b 0deg 45deg, #feca57 45deg 90deg, #48dbfb 90deg 135deg,
                    #ff9ff3 135deg 180deg, #54a0ff 180deg 225deg, #5f27cd 225deg 270deg,
                    #00d2d3 270deg 315deg, #1dd1a1 315deg 360deg);
                    display: flex; align-items: center; justify-content: center;
                    font-size: 2rem; transition: transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99);">
                    🎁
                </div>
                <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 1.5rem;">▼</div>
            </div>
            ${canSpin ?
                `<button class="minigame-btn" onclick="spinWheel()">🎰 Spin the Wheel!</button>` :
                `<p style="color: #7a9a5a;">Come back tomorrow for another spin!</p>`
            }
            <div id="spin-result" style="margin-top: 1rem; font-size: 1.2rem; font-weight: 700;"></div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

function spinWheel() {
    if (!canSpinToday()) return;

    const wheel = document.getElementById('wheel');
    const prizes = [
        { name: '10 Shells', icon: '🐚', action: () => { collectibles.shells += 10; } },
        { name: '5 Bugs', icon: '🦋', action: () => { collectibles.bugs += 5; } },
        { name: '5 Fish', icon: '🐟', action: () => { collectibles.fish += 5; } },
        { name: 'Power-up Refill', icon: '⚡', action: () => { powerups = { skip: 5, hint: 5 }; } },
        { name: 'Double Points Next Round', icon: '⭐', action: () => { isDoublePoints = true; } },
        { name: 'Pet Level Up!', icon: '🐕', action: () => { petBuddy.level++; } },
        { name: 'Lucky Star', icon: '🌟', action: () => {} },
        { name: 'Rainbow Gift', icon: '🌈', action: () => { collectibles.shells += 3; collectibles.bugs += 3; collectibles.fish += 3; } }
    ];

    const randomPrize = Math.floor(Math.random() * prizes.length);
    const rotation = 1800 + (randomPrize * 45) + Math.random() * 40;

    wheel.style.transform = `rotate(${rotation}deg)`;

    setTimeout(() => {
        const prize = prizes[randomPrize];
        prize.action();
        renderCollectiblesBar();
        renderPowerupsBar();
        saveCollectibles();

        document.getElementById('spin-result').innerHTML = `
            <div style="font-size: 3rem;">${prize.icon}</div>
            <div style="color: #3d7c47;">You won: ${prize.name}!</div>
        `;

        lastSpinDate = new Date().toISOString().split('T')[0];
        if (multData.preferences) multData.preferences.lastSpinDate = lastSpinDate;
        else multData.preferences = { lastSpinDate };
        saveMultiplicationData();

        launchConfetti();
        playSound('fanfare');
    }, 3000);
}

// ── Encyclopedia ──
let encyclopedia = { bugs: [], fish: [], fossils: [] };
const ALL_BUGS = ['🦋', '🐛', '🐞', '🦗', '🐝', '🪲', '🐜', '🦟', '🪳', '🦠'];
const ALL_FISH = ['🐟', '🐠', '🐡', '🦈', '🐙', '🦑', '🦐', '🦀', '🐳', '🐋'];
const ALL_FOSSILS = ['🦴', '🦷', '💀', '🦕', '🦖'];

function showEncyclopedia() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    const renderCollection = (title, icon, collected, all) => {
        const items = all.map(item => {
            const found = collected.includes(item);
            return `<span style="font-size: 1.8rem; opacity: ${found ? 1 : 0.2}; filter: ${found ? 'none' : 'grayscale(1)'};">${item}</span>`;
        }).join(' ');
        return `
            <div style="margin-bottom: 1rem;">
                <h4 style="color: #3d7c47;">${icon} ${title} (${collected.length}/${all.length})</h4>
                <div style="background: rgba(255,255,255,0.5); padding: 0.5rem; border-radius: 10px;">${items}</div>
            </div>
        `;
    };

    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">📖 Encyclopedia</h3>
            <p style="color: #7a9a5a; margin-bottom: 1rem;">Collect them all!</p>
            ${renderCollection('Bugs', '🦋', encyclopedia.bugs, ALL_BUGS)}
            ${renderCollection('Fish', '🐟', encyclopedia.fish, ALL_FISH)}
            ${renderCollection('Fossils', '🦴', encyclopedia.fossils, ALL_FOSSILS)}
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

function discoverCreature(type) {
    const lists = { bugs: ALL_BUGS, fish: ALL_FISH, fossils: ALL_FOSSILS };
    const all = lists[type];
    const undiscovered = all.filter(c => !encyclopedia[type].includes(c));

    if (undiscovered.length > 0 && Math.random() < 0.3) {
        const newCreature = pickRandom(undiscovered);
        encyclopedia[type].push(newCreature);
        showDiscoveryPopup(newCreature, type);
        saveEncyclopedia();
    }
}

function showDiscoveryPopup(creature, type) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
        background: linear-gradient(135deg, #667eea, #764ba2); color: white;
        padding: 1rem 2rem; border-radius: 20px; z-index: 2000;
        text-align: center; animation: badgePop 0.5s ease-out;
        box-shadow: 0 10px 40px rgba(102,126,234,0.5);
    `;
    popup.innerHTML = `
        <div style="font-size: 3rem;">${creature}</div>
        <div style="font-weight: 700;">New ${type.slice(0, -1)} discovered!</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
    setTimeout(() => popup.remove(), 2000);
}

function saveEncyclopedia() {
    multData.encyclopedia = encyclopedia;
    saveMultiplicationData();
}

// ── Backpack / Inventory ──
function showBackpack() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🎒 Your Backpack</h3>

            <div style="background: rgba(255,255,255,0.7); border-radius: 15px; padding: 1rem; margin: 1rem 0;">
                <h4 style="color: #5c4a32; margin-bottom: 0.5rem;">Collectibles</h4>
                <div style="display: flex; justify-content: center; gap: 1.5rem; font-size: 1.3rem;">
                    <div>🐚 <strong>${collectibles.shells}</strong></div>
                    <div>🦋 <strong>${collectibles.bugs}</strong></div>
                    <div>🐟 <strong>${collectibles.fish}</strong></div>
                </div>
            </div>

            <div style="background: rgba(255,255,255,0.7); border-radius: 15px; padding: 1rem; margin: 1rem 0;">
                <h4 style="color: #5c4a32; margin-bottom: 0.5rem;">Power-ups</h4>
                <div style="display: flex; justify-content: center; gap: 1.5rem; font-size: 1.1rem;">
                    <div>⏭️ Skips: <strong>${powerups.skip}</strong></div>
                    <div>💡 Hints: <strong>${powerups.hint}</strong></div>
                </div>
            </div>

            <div style="background: rgba(255,255,255,0.7); border-radius: 15px; padding: 1rem; margin: 1rem 0;">
                <h4 style="color: #5c4a32; margin-bottom: 0.5rem;">Stats</h4>
                <div style="font-size: 0.9rem; color: #5c4a32;">
                    <div>Total Questions: <strong>${multData.stats.totalAnswered}</strong></div>
                    <div>Correct Answers: <strong>${multData.stats.totalCorrect}</strong></div>
                    <div>Best Streak: <strong>${multData.stats.bestStreak}</strong></div>
                    <div>Daily Streak: <strong>${multData.stats.dailyStreak || 0}</strong> days</div>
                </div>
            </div>

            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

// ── Trophies Room ──
const TROPHIES = [
    { id: 'first_game', name: 'First Steps', desc: 'Play your first round', icon: '🎮', check: () => multData.stats.roundsPlayed >= 1 },
    { id: 'ten_rounds', name: 'Getting Started', desc: 'Play 10 rounds', icon: '🌟', check: () => multData.stats.roundsPlayed >= 10 },
    { id: 'fifty_rounds', name: 'Dedicated', desc: 'Play 50 rounds', icon: '💪', check: () => multData.stats.roundsPlayed >= 50 },
    { id: 'hundred_correct', name: 'Century', desc: '100 correct answers', icon: '💯', check: () => multData.stats.totalCorrect >= 100 },
    { id: 'five_hundred_correct', name: 'Math Whiz', desc: '500 correct answers', icon: '🧙', check: () => multData.stats.totalCorrect >= 500 },
    { id: 'streak_5', name: 'Hot Streak', desc: '5 in a row', icon: '🔥', check: () => multData.stats.bestStreak >= 5 },
    { id: 'streak_10', name: 'On Fire', desc: '10 in a row', icon: '🌋', check: () => multData.stats.bestStreak >= 10 },
    { id: 'streak_20', name: 'Unstoppable', desc: '20 in a row', icon: '⚡', check: () => multData.stats.bestStreak >= 20 },
    { id: 'all_levels', name: 'Island Master', desc: 'Unlock all levels', icon: '🏆', check: () => unlockedLevel >= LEVELS.length },
    { id: 'collector', name: 'Collector', desc: '50 total collectibles', icon: '🎁', check: () => (collectibles.shells + collectibles.bugs + collectibles.fish) >= 50 },
    { id: 'daily_7', name: 'Week Warrior', desc: '7 day streak', icon: '📅', check: () => (multData.stats.dailyStreak || 0) >= 7 },
    { id: 'pet_lover', name: 'Pet Lover', desc: 'Level up your pet', icon: '🐕', check: () => petBuddy.level >= 2 }
];

function showTrophies() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    const trophiesHTML = TROPHIES.map(t => {
        const earned = t.check();
        return `
            <div style="display: flex; align-items: center; gap: 0.8rem; padding: 0.5rem;
                background: ${earned ? 'rgba(61,124,71,0.1)' : 'rgba(0,0,0,0.05)'};
                border-radius: 10px; margin-bottom: 0.4rem; opacity: ${earned ? 1 : 0.5};">
                <span style="font-size: 1.5rem;">${earned ? t.icon : '🔒'}</span>
                <div>
                    <div style="font-weight: 700; color: ${earned ? '#3d7c47' : '#999'};">${t.name}</div>
                    <div style="font-size: 0.8rem; color: #7a9a5a;">${t.desc}</div>
                </div>
            </div>
        `;
    }).join('');

    const earnedCount = TROPHIES.filter(t => t.check()).length;

    card.innerHTML = `
        <div>
            <h3 style="color: #3d7c47; text-align: center;">🏆 Trophy Room</h3>
            <p style="color: #7a9a5a; text-align: center; margin-bottom: 1rem;">${earnedCount}/${TROPHIES.length} trophies earned</p>
            <div style="max-height: 300px; overflow-y: auto;">
                ${trophiesHTML}
            </div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

// ── Jukebox (K.K. Songs) ──
let collectedSongs = ['K.K. Island', 'K.K. Bossa', 'K.K. Jazz', 'Bubblegum K.K.', 'K.K. Disco'];
const ALL_SONGS = ['K.K. Island', 'K.K. Bossa', 'K.K. Jazz', 'Bubblegum K.K.', 'K.K. Disco',
    'K.K. Rock', 'K.K. Soul', 'K.K. Reggae', 'K.K. Country', 'K.K. Lullaby'];

function showJukebox() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    const songsHTML = ALL_SONGS.map(song => {
        const owned = collectedSongs.includes(song);
        return `
            <div style="display: flex; align-items: center; justify-content: space-between;
                padding: 0.6rem; background: rgba(255,255,255,0.6); border-radius: 10px;
                margin-bottom: 0.4rem; opacity: ${owned ? 1 : 0.4};">
                <span>🎵 ${owned ? song : '???'}</span>
                ${owned ? `<button onclick="playSongMelody('${song}')" style="background: #3d7c47; color: white; border: none; border-radius: 8px; padding: 0.3rem 0.8rem; cursor: pointer;">▶️</button>` : '🔒'}
            </div>
        `;
    }).join('');

    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">📻 K.K. Jukebox</h3>
            <p style="color: #7a9a5a; margin-bottom: 1rem;">${collectedSongs.length}/${ALL_SONGS.length} songs collected</p>
            <div style="text-align: left;">
                ${songsHTML}
            </div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

function playSongMelody(songName) {
    // Play a little melody based on song name
    const melodies = {
        'K.K. Island': [523, 587, 659, 784, 659, 523],
        'K.K. Bossa': [392, 440, 523, 587, 523, 440],
        'K.K. Jazz': [440, 523, 587, 659, 698, 659],
        'Bubblegum K.K.': [784, 880, 784, 659, 784, 880],
        'K.K. Disco': [523, 659, 784, 880, 784, 659],
        'K.K. Rock': [330, 392, 440, 523, 440, 392],
        'K.K. Soul': [440, 523, 587, 523, 440, 392],
        'K.K. Reggae': [392, 440, 392, 330, 392, 440],
        'K.K. Country': [523, 587, 659, 587, 523, 440],
        'K.K. Lullaby': [659, 587, 523, 494, 523, 587]
    };

    const melody = melodies[songName] || melodies['K.K. Island'];
    melody.forEach((freq, i) => {
        setTimeout(() => {
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            osc.connect(gain);
            gain.connect(audioContext.destination);
            osc.frequency.setValueAtTime(freq, audioContext.currentTime);
            gain.gain.setValueAtTime(0.1, audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            osc.start();
            osc.stop(audioContext.currentTime + 0.3);
        }, i * 200);
    });
}

function maybeUnlockSong() {
    if (Math.random() < 0.05) { // 5% chance
        const locked = ALL_SONGS.filter(s => !collectedSongs.includes(s));
        if (locked.length > 0) {
            const newSong = pickRandom(locked);
            collectedSongs.push(newSong);
            showSongUnlock(newSong);
            saveSongs();
        }
    }
}

function showSongUnlock(song) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
        background: linear-gradient(135deg, #667eea, #764ba2); color: white;
        padding: 1rem 2rem; border-radius: 20px; z-index: 2000;
        text-align: center; animation: badgePop 0.5s ease-out;
    `;
    popup.innerHTML = `
        <div style="font-size: 2rem;">🎵</div>
        <div style="font-weight: 700;">New song unlocked!</div>
        <div>${song}</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
    setTimeout(() => popup.remove(), 2500);
}

function saveSongs() {
    multData.collectedSongs = collectedSongs;
    saveMultiplicationData();
}

// ── Letters from Mom ──
const MOM_LETTERS = [
    "Hi sweetie! I'm so proud of how hard you're working on your math! Keep it up! Love, Mom 💕",
    "Dear child, I baked some cookies for you! Well, virtual ones. 🍪 Keep practicing! - Mom",
    "Hello! The weather here is lovely. I hope your island is doing well! Keep learning! Love, Mom 🌸",
    "My dear, I heard you're becoming a math champion! That's wonderful! - Mom 💝",
    "Hi there! Remember, every expert was once a beginner. You're doing great! Love, Mom ⭐",
    "Dear one, I found this shell and thought of you! 🐚 Keep up the amazing work! - Mom",
    "Hello sweetie! Math is like a garden - the more you practice, the more it grows! 🌺 - Mom",
    "My child, I'm sending you good luck vibes! You've got this! Love, Mom 🍀"
];

function maybeShowLetter() {
    if (Math.random() < 0.08) { // 8% chance after a round
        setTimeout(() => showLetterFromMom(), 1500);
    }
}

function showLetterFromMom() {
    const letter = pickRandom(MOM_LETTERS);

    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.7); display: flex; align-items: center;
        justify-content: center; z-index: 3000;
    `;
    popup.innerHTML = `
        <div style="background: #fffef0; border-radius: 5px; padding: 2rem; max-width: 300px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3); font-family: 'Comic Sans MS', cursive, sans-serif;
            border: 3px solid #d4a574; transform: rotate(-2deg);">
            <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">💌 Letter from Mom</div>
            <p style="color: #5c4a32; line-height: 1.6; margin-bottom: 1rem;">${letter}</p>
            <button onclick="this.parentElement.parentElement.remove()"
                style="background: #3d7c47; color: white; border: none; border-radius: 8px;
                padding: 0.5rem 1rem; cursor: pointer; font-family: inherit;">Thanks Mom! 💕</button>
        </div>
    `;
    document.body.appendChild(popup);
}

// ── Shooting Stars ──
function createShootingStar() {
    if (Math.random() > 0.3) return; // 30% chance

    const star = document.createElement('div');
    star.style.cssText = `
        position: fixed;
        top: ${Math.random() * 30}%;
        right: -50px;
        font-size: 1.5rem;
        z-index: 50;
        cursor: pointer;
        transition: all 2s linear;
        pointer-events: auto;
    `;
    star.textContent = '🌠';
    star.onclick = () => {
        star.textContent = '✨';
        score += 2;
        updateScoreboard();
        playSound('correct');
        setTimeout(() => star.remove(), 300);
    };
    document.body.appendChild(star);

    setTimeout(() => {
        star.style.right = '110%';
        star.style.top = (parseFloat(star.style.top) + 30) + '%';
    }, 50);

    setTimeout(() => { if (star.parentNode) star.remove(); }, 2500);
}

// ── Animal Parade ──
function showAnimalParade() {
    const animals = ['🐕', '🐈', '🐰', '🐻', '🦊', '🐸', '🦉', '🐧', '🐿️', '🦆'];
    const container = document.createElement('div');
    container.style.cssText = `
        position: fixed; bottom: 20px; left: -100%; width: 200%;
        display: flex; gap: 20px; z-index: 50; pointer-events: none;
        animation: paradeWalk 4s linear forwards;
    `;

    animals.forEach((animal, i) => {
        const a = document.createElement('span');
        a.textContent = animal;
        a.style.cssText = `font-size: 2rem; animation: bounce 0.5s ease-in-out infinite; animation-delay: ${i * 0.1}s;`;
        container.appendChild(a);
    });

    // Add parade animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes paradeWalk { from { left: -100%; } to { left: 100%; } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    `;
    document.head.appendChild(style);
    document.body.appendChild(container);

    setTimeout(() => { container.remove(); style.remove(); }, 4000);
}

// ── Flower Garden ──
let garden = { flowers: [], waterLevel: 100 };
const FLOWER_TYPES = ['🌸', '🌺', '🌻', '🌹', '🌷', '💐', '🌼', '🏵️'];

function showGarden() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');

    const flowersHTML = garden.flowers.length > 0
        ? garden.flowers.map(f => `<span style="font-size: 2rem;">${f}</span>`).join(' ')
        : '<p style="color: #7a9a5a;">No flowers yet! Answer questions correctly to grow flowers!</p>';

    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🌺 Your Garden</h3>
            <p style="color: #7a9a5a;">Water Level: ${garden.waterLevel}% 💧</p>
            <div style="background: linear-gradient(180deg, #87ceeb 0%, #90ee90 50%, #8b4513 100%);
                border-radius: 15px; padding: 2rem; min-height: 150px; margin: 1rem 0;
                display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 0.5rem;">
                ${flowersHTML}
            </div>
            <p style="color: #7a9a5a; font-size: 0.85rem;">${garden.flowers.length} flowers growing</p>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back to Times Tables</button>
        </div>
    `;
}

function growFlower() {
    if (Math.random() < 0.15 && garden.flowers.length < 30) { // 15% chance, max 30 flowers
        const newFlower = pickRandom(FLOWER_TYPES);
        garden.flowers.push(newFlower);
        showFlowerGrowPopup(newFlower);
        saveGarden();
    }
}

function showFlowerGrowPopup(flower) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
        font-size: 2rem; z-index: 1000; animation: floatUp 1.5s ease-out forwards;
    `;
    popup.textContent = flower + ' +1';

    const style = document.createElement('style');
    style.textContent = `@keyframes floatUp { to { transform: translateX(-50%) translateY(-50px); opacity: 0; } }`;
    document.head.appendChild(style);
    document.body.appendChild(popup);

    setTimeout(() => { popup.remove(); style.remove(); }, 1500);
}

function saveGarden() {
    multData.garden = garden;
    saveMultiplicationData();
}

// ══════════════════════════════════════════════════════════════════════════
// ALL THE REMAINING AWESOME FEATURES!
// ══════════════════════════════════════════════════════════════════════════

// ── Villager Visitors ──
const VISITING_VILLAGERS = [
    { name: "Tom Nook", emoji: "🦝", message: "Yes yes! Keep up the great work!" },
    { name: "Isabelle", emoji: "🐕", message: "You're doing amazing today!" },
    { name: "Celeste", emoji: "🦉", message: "The stars are aligned for you!" },
    { name: "K.K. Slider", emoji: "🐕", message: "This next song is for you..." },
    { name: "Blathers", emoji: "🦉", message: "Hoo! Splendid progress!" },
    { name: "Kicks", emoji: "🦨", message: "Looking good, friend!" },
    { name: "Flick", emoji: "🦎", message: "You're as cool as a rare bug!" },
    { name: "CJ", emoji: "🦫", message: "That answer was a big catch!" },
    { name: "Pascal", emoji: "🦦", message: "Like, math is groovy, maaan..." },
    { name: "Mabel", emoji: "🦔", message: "You're sew talented!" }
];

function maybeShowVillagerVisitor() {
    if (Math.random() < 0.1) { // 10% chance
        const villager = pickRandom(VISITING_VILLAGERS);
        showVillagerPopup(villager);
    }
}

function showVillagerPopup(villager) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
        background: linear-gradient(135deg, #ffecd2, #fcb69f); border-radius: 20px;
        padding: 1rem 1.5rem; z-index: 2000; text-align: center;
        animation: badgePop 0.5s ease-out; box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    `;
    popup.innerHTML = `
        <div style="font-size: 2.5rem;">${villager.emoji}</div>
        <div style="font-weight: 700; color: #3d7c47;">${villager.name}</div>
        <div style="color: #5c4a32; font-style: italic;">"${villager.message}"</div>
    `;
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 3000);
}

// ── Custom Catchphrase ──
let customCatchphrase = "";

function showCatchphraseEditor() {
    const phrase = prompt("Enter your custom catchphrase! (like ~sweetie~ or yeah buddy!)", customCatchphrase || "~island life~");
    if (phrase !== null && phrase.trim()) {
        customCatchphrase = phrase.trim();
        multData.catchphrase = customCatchphrase;
        saveMultiplicationData();
    }
}

function getCatchphrase() {
    return customCatchphrase || pickRandom(["~island life~", "yeah buddy!", "groovy~", "wahoo!"]);
}

// ── Real Seasons ──
function getCurrentSeason() {
    const month = new Date().getMonth();
    if (month >= 2 && month <= 4) return { name: "Spring", emoji: "🌸", colors: ["#ffb7c5", "#98fb98"] };
    if (month >= 5 && month <= 7) return { name: "Summer", emoji: "☀️", colors: ["#87ceeb", "#ffd700"] };
    if (month >= 8 && month <= 10) return { name: "Fall", emoji: "🍂", colors: ["#ff8c00", "#8b4513"] };
    return { name: "Winter", emoji: "❄️", colors: ["#e0ffff", "#b0c4de"] };
}

// ── Island Decorations ──
let islandDecorations = [];
const DECORATION_ITEMS = ["🌳", "🌲", "🌴", "🌺", "🌻", "🏠", "⛲", "🗿", "🎪", "🎡", "🏕️", "🌉"];

function showDecorationShop() {
    practiceViewActive = true;
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    const cost = 10; // shells per decoration

    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🏠 Decoration Shop</h3>
            <p style="color: #5c4a32;">Buy decorations with shells! (${cost} 🐚 each)</p>
            <p style="color: #7a9a5a;">You have: ${collectibles.shells} 🐚</p>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; margin: 1rem 0;">
                ${DECORATION_ITEMS.map(d => `
                    <button onclick="buyDecoration('${d}')" style="font-size: 2rem; padding: 0.5rem; border: 2px solid #3d7c47; border-radius: 10px; background: white; cursor: pointer;">${d}</button>
                `).join('')}
            </div>
            <p style="color: #7a9a5a; font-size: 0.9rem;">Your decorations: ${islandDecorations.join(' ') || 'None yet!'}</p>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back</button>
        </div>
    `;
}

function buyDecoration(item) {
    if (collectibles.shells >= 10) {
        collectibles.shells -= 10;
        islandDecorations.push(item);
        multData.decorations = islandDecorations;
        saveMultiplicationData();
        renderCollectiblesBar();
        showDecorationShop();
        playSound('correct');
    } else {
        alert("Not enough shells! Keep playing to collect more!");
    }
}

// ── Sticker Collection ──
let stickers = [];
const ALL_STICKERS = [
    { id: "first_win", name: "First Win", emoji: "⭐", condition: () => multData.stats.totalCorrect >= 1 },
    { id: "streak_3", name: "Hot Start", emoji: "🔥", condition: () => multData.stats.bestStreak >= 3 },
    { id: "streak_10", name: "On Fire", emoji: "💥", condition: () => multData.stats.bestStreak >= 10 },
    { id: "hundred", name: "Century", emoji: "💯", condition: () => multData.stats.totalCorrect >= 100 },
    { id: "collector", name: "Collector", emoji: "🎁", condition: () => (collectibles.shells + collectibles.bugs + collectibles.fish) >= 20 },
    { id: "gardener", name: "Gardener", emoji: "🌺", condition: () => garden.flowers.length >= 5 },
    { id: "explorer", name: "Explorer", emoji: "🗺️", condition: () => getUnlockedPlaces() >= 5 },
    { id: "musician", name: "Music Fan", emoji: "🎵", condition: () => collectedSongs.length >= 3 },
    { id: "dedicated", name: "Dedicated", emoji: "📅", condition: () => (multData.stats.dailyStreak || 0) >= 3 },
    { id: "champion", name: "Champion", emoji: "🏆", condition: () => unlockedLevel >= LEVELS.length }
];

function checkStickers() {
    for (const s of ALL_STICKERS) {
        if (!stickers.includes(s.id) && s.condition()) {
            stickers.push(s.id);
            showStickerUnlock(s);
            multData.stickers = stickers;
            saveMultiplicationData();
        }
    }
}

function showStickerUnlock(sticker) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #ffd700, #ffec8b); border-radius: 20px;
        padding: 1.5rem; z-index: 2000; text-align: center; animation: badgePop 0.5s ease-out;
    `;
    popup.innerHTML = `
        <div style="font-size: 4rem;">${sticker.emoji}</div>
        <div style="font-weight: 800; color: #5c4a32;">New Sticker!</div>
        <div style="color: #8b7355;">${sticker.name}</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
    setTimeout(() => popup.remove(), 2500);
}

function showStickerBook() {
    practiceViewActive = true;
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🎟️ Sticker Book</h3>
            <p style="color: #7a9a5a;">${stickers.length}/${ALL_STICKERS.length} stickers collected!</p>
            <div style="display: flex; flex-wrap: wrap; gap: 0.8rem; justify-content: center; margin: 1rem 0;">
                ${ALL_STICKERS.map(s => `
                    <div style="font-size: 2rem; opacity: ${stickers.includes(s.id) ? 1 : 0.2}; filter: ${stickers.includes(s.id) ? 'none' : 'grayscale(1)'};"
                         title="${s.name}">${s.emoji}</div>
                `).join('')}
            </div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back</button>
        </div>
    `;
}

// ── Lucky Items ──
let luckyItemActive = false;
const LUCKY_ITEMS = ["🍀", "⭐", "🌈", "💎"];

function maybeGetLuckyItem() {
    if (Math.random() < 0.05) { // 5% chance
        luckyItemActive = true;
        const item = pickRandom(LUCKY_ITEMS);
        showLuckyItemPopup(item);
    }
}

function showLuckyItemPopup(item) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
        background: linear-gradient(135deg, #ffd700, #98fb98); border-radius: 20px;
        padding: 1rem 2rem; z-index: 2000; text-align: center; animation: badgePop 0.5s ease-out;
    `;
    popup.innerHTML = `
        <div style="font-size: 3rem;">${item}</div>
        <div style="font-weight: 700; color: #3d7c47;">Lucky Item Found!</div>
        <div style="color: #5c4a32;">+2 bonus points this round!</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
    setTimeout(() => popup.remove(), 2000);
}

// ── Birthday Mode ──
function checkBirthday() {
    const today = new Date();
    const savedBirthday = multData.birthday;
    if (savedBirthday) {
        const [month, day] = savedBirthday.split('-').map(Number);
        if (today.getMonth() + 1 === month && today.getDate() === day) {
            return true;
        }
    }
    return false;
}

function showBirthdaySetup() {
    const date = prompt("When is your birthday? (MM-DD format, like 03-15 for March 15)");
    if (date && date.match(/^\d{2}-\d{2}$/)) {
        multData.birthday = date;
        saveMultiplicationData();
        alert("Birthday saved! 🎂");
    }
}

function showBirthdayCelebration() {
    launchConfetti();
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); display: flex; align-items: center;
        justify-content: center; z-index: 3000;
    `;
    popup.innerHTML = `
        <div style="background: linear-gradient(135deg, #ff69b4, #ffd700); border-radius: 20px;
            padding: 2rem; text-align: center; animation: levelUpPop 0.6s ease-out;">
            <div style="font-size: 5rem;">🎂</div>
            <h2 style="color: white;">Happy Birthday!</h2>
            <p style="color: white;">All the villagers are celebrating with you today!</p>
            <p style="color: #ffe4e1;">🎁 You get TRIPLE points today! 🎁</p>
            <button onclick="this.parentElement.parentElement.remove()" class="minigame-btn" style="margin-top: 1rem;">Thank you! 🎉</button>
        </div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
}

// ── Message in a Bottle ──
const BOTTLE_MESSAGES = [
    "Keep going! You're doing great! - A friendly islander",
    "Math is like fishing - patience pays off! 🐟",
    "Every problem solved is a step forward! ✨",
    "The ocean brought you good luck today! 🌊",
    "Believe in yourself! - Found on a distant shore",
    "You're making waves of progress! 🏝️",
    "This bottle traveled far to find YOU! 🍾"
];

function maybeShowBottleMessage() {
    if (Math.random() < 0.05) {
        const message = pickRandom(BOTTLE_MESSAGES);
        showBottlePopup(message);
    }
}

function showBottlePopup(message) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%);
        background: #f5deb3; border: 3px solid #8b4513; border-radius: 10px;
        padding: 1rem 1.5rem; z-index: 2000; max-width: 280px;
        font-family: 'Comic Sans MS', cursive; animation: badgePop 0.5s ease-out;
    `;
    popup.innerHTML = `
        <div style="font-size: 1.5rem; text-align: center;">🍾📜</div>
        <div style="color: #5c4a32; font-style: italic; text-align: center;">"${message}"</div>
    `;
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 4000);
}

// ── Memory Match Mini-Game ──
let memoryCards = [];
let flippedCards = [];
let memoryMatches = 0;

function showMemoryGame() {
    practiceViewActive = true;
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🃏 Memory Match!</h3>
            <p style="color: #5c4a32;">Match the multiplication pairs!</p>
            <button class="minigame-btn" onclick="startMemoryGame()">Start Game!</button>
            <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
        </div>
    `;
}

function startMemoryGame() {
    // Create pairs of multiplication problems and answers
    const pairs = [
        { q: "2×3", a: "6" }, { q: "4×5", a: "20" },
        { q: "3×4", a: "12" }, { q: "6×7", a: "42" }
    ];

    memoryCards = [];
    pairs.forEach((p, i) => {
        memoryCards.push({ id: i, type: 'q', value: p.q, pairId: i });
        memoryCards.push({ id: i + 10, type: 'a', value: p.a, pairId: i });
    });

    // Shuffle
    memoryCards.sort(() => Math.random() - 0.5);
    flippedCards = [];
    memoryMatches = 0;

    renderMemoryBoard();
}

function renderMemoryBoard() {
    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🃏 Memory Match!</h3>
            <p style="color: #7a9a5a;">Matches: ${memoryMatches}/4</p>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; margin: 1rem 0;">
                ${memoryCards.map((c, i) => `
                    <button onclick="flipMemoryCard(${i})" id="mem-${i}"
                        style="height: 60px; font-size: 1rem; font-weight: 700; border-radius: 10px;
                        border: 2px solid #3d7c47; background: ${c.flipped || c.matched ? '#90ee90' : '#3d7c47'};
                        color: ${c.flipped || c.matched ? '#3d7c47' : 'white'}; cursor: pointer;"
                        ${c.matched ? 'disabled' : ''}>
                        ${c.flipped || c.matched ? c.value : '?'}
                    </button>
                `).join('')}
            </div>
            <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
        </div>
    `;
}

function flipMemoryCard(index) {
    if (memoryCards[index].flipped || memoryCards[index].matched || flippedCards.length >= 2) return;

    memoryCards[index].flipped = true;
    flippedCards.push(index);
    renderMemoryBoard();

    if (flippedCards.length === 2) {
        const [first, second] = flippedCards;
        if (memoryCards[first].pairId === memoryCards[second].pairId) {
            memoryCards[first].matched = true;
            memoryCards[second].matched = true;
            memoryMatches++;
            flippedCards = [];
            playSound('correct');

            if (memoryMatches === 4) {
                setTimeout(() => {
                    launchConfetti();
                    alert("You won! 🎉");
                    showGamesMenu();
                }, 500);
            } else {
                renderMemoryBoard();
            }
        } else {
            setTimeout(() => {
                memoryCards[first].flipped = false;
                memoryCards[second].flipped = false;
                flippedCards = [];
                renderMemoryBoard();
            }, 1000);
        }
    }
}

// ── Target Practice Game ──
function showTargetGame() {
    practiceViewActive = true;
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🎯 Target Practice!</h3>
            <p style="color: #5c4a32;">Hit the correct answer!</p>
            <button class="minigame-btn" onclick="startTargetGame()">Start!</button>
            <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
        </div>
    `;
}

let targetScore = 0;
let targetRound = 0;

function startTargetGame() {
    targetScore = 0;
    targetRound = 0;
    nextTargetRound();
}

function nextTargetRound() {
    if (targetRound >= 5) {
        endTargetGame();
        return;
    }

    const a = randInt(2, 9);
    const b = randInt(2, 9);
    const correct = a * b;
    const wrong1 = correct + randInt(1, 5);
    const wrong2 = correct - randInt(1, 5);
    const wrong3 = correct + randInt(6, 10);

    const answers = [correct, wrong1, wrong2, wrong3].sort(() => Math.random() - 0.5);

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🎯 ${a} × ${b} = ?</h3>
            <p style="color: #7a9a5a;">Score: ${targetScore} | Round ${targetRound + 1}/5</p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
                ${answers.map(ans => `
                    <button onclick="hitTarget(${ans}, ${correct})" style="
                        width: 80px; height: 80px; border-radius: 50%; font-size: 1.5rem; font-weight: 800;
                        background: radial-gradient(circle, #ff6b6b, #ff0000, #8b0000);
                        color: white; border: 4px solid #ffd700; cursor: pointer; margin: 0 auto;
                    ">${ans}</button>
                `).join('')}
            </div>
        </div>
    `;
}

function hitTarget(answer, correct) {
    if (answer === correct) {
        targetScore += 10;
        playSound('correct');
    } else {
        playSound('wrong');
    }
    targetRound++;
    nextTargetRound();
}

function endTargetGame() {
    if (targetScore >= 40) launchConfetti();
    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🎯 Game Over!</h3>
            <div style="font-size: 3rem;">${targetScore >= 40 ? '🏆' : targetScore >= 20 ? '⭐' : '🎯'}</div>
            <div style="font-size: 2rem; font-weight: 800; color: #c0732a;">${targetScore} points!</div>
            <button class="play-again-btn" onclick="startTargetGame()">Play Again</button>
            <button class="back-btn" onclick="showGamesMenu()">Back to Games</button>
        </div>
    `;
}

// ── Puzzle Pieces ──
let puzzlePieces = 0;
const PUZZLE_GOAL = 20;

function maybeGetPuzzlePiece() {
    if (Math.random() < 0.15) {
        puzzlePieces++;
        showPuzzlePiecePopup();
        if (puzzlePieces >= PUZZLE_GOAL) {
            setTimeout(() => showPuzzleComplete(), 1500);
        }
    }
}

function showPuzzlePiecePopup() {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 30%; left: 50%; transform: translateX(-50%);
        font-size: 2rem; z-index: 1000; animation: floatUp 1s ease-out forwards;
    `;
    popup.textContent = '🧩 +1';
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 1000);
}

function showPuzzleComplete() {
    launchConfetti();
    puzzlePieces = 0;
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #ffd700, #ff69b4); border-radius: 20px;
        padding: 2rem; text-align: center; z-index: 2000; animation: badgePop 0.5s ease-out;
    `;
    popup.innerHTML = `
        <div style="font-size: 4rem;">🖼️</div>
        <div style="font-weight: 800; color: white;">Puzzle Complete!</div>
        <div style="color: #ffe4e1;">You revealed a beautiful island picture!</div>
        <button onclick="this.parentElement.remove()" class="minigame-btn" style="margin-top:1rem;">Awesome!</button>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
}

// ── Guestbook ──
const GUESTBOOK_ENTRIES = [
    { name: "Tom Nook", message: "Great progress! Keep it up, yes yes!" },
    { name: "Isabelle", message: "You're the best islander ever!" },
    { name: "K.K. Slider", message: "Your math skills rock!" },
    { name: "Celeste", message: "Wishing upon stars for you!" },
    { name: "Blathers", message: "Such impressive knowledge, hoo!" }
];

function showGuestbook() {
    practiceViewActive = true;
    document.querySelector('.score-bar').style.display = 'none';

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">📝 Island Guestbook</h3>
            <div style="text-align: left; margin: 1rem 0;">
                ${GUESTBOOK_ENTRIES.map(e => `
                    <div style="background: #fff8dc; border-radius: 10px; padding: 0.8rem; margin-bottom: 0.5rem; border-left: 4px solid #3d7c47;">
                        <div style="font-weight: 700; color: #3d7c47;">${e.name}</div>
                        <div style="color: #5c4a32; font-style: italic;">"${e.message}"</div>
                    </div>
                `).join('')}
            </div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))">Back</button>
        </div>
    `;
}

// ── Plant Trees ──
let trees = [];

function plantTree() {
    if (collectibles.shells >= 5) {
        collectibles.shells -= 5;
        trees.push(pickRandom(["🌳", "🌲", "🌴", "🎄"]));
        multData.trees = trees;
        saveMultiplicationData();
        renderCollectiblesBar();
        playSound('correct');
    }
}

// ── Build Bridges ──
let bridges = 0;

function buildBridge() {
    if (collectibles.shells >= 20) {
        collectibles.shells -= 20;
        bridges++;
        multData.bridges = bridges;
        saveMultiplicationData();
        renderCollectiblesBar();
        launchConfetti();
    }
}

// ── Character Emotions ──
const EMOTIONS = ["😊", "😄", "🥳", "😎", "🤩", "😇", "🥰", "😋"];

function showEmotion() {
    const emotion = pickRandom(EMOTIONS);
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        font-size: 5rem; z-index: 1000; animation: badgePop 0.5s ease-out;
        pointer-events: none;
    `;
    popup.textContent = emotion;
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 1000);
}

// ── Rainy Day Bonus ──
function isRainyDay() {
    // Simulate based on random chance per session
    if (window.todayIsRainy === undefined) {
        window.todayIsRainy = Math.random() < 0.2; // 20% chance
    }
    return window.todayIsRainy;
}

function getRainyBonus() {
    return isRainyDay() ? 1.5 : 1;
}

// ── Rare Spawns in Games ──
const RARE_CREATURES = ["🦋", "🦚", "🦩", "🦄", "🐉", "🦖"];

function maybeSpawnRare() {
    if (Math.random() < 0.02) { // 2% chance
        const rare = pickRandom(RARE_CREATURES);
        showRareSpawn(rare);
        return rare;
    }
    return null;
}

function showRareSpawn(creature) {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #ffd700, #ff69b4); border-radius: 20px;
        padding: 1.5rem; text-align: center; z-index: 2000; animation: badgePop 0.5s ease-out;
    `;
    popup.innerHTML = `
        <div style="font-size: 4rem;">${creature}</div>
        <div style="font-weight: 800; color: white;">RARE SPAWN!</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
    setTimeout(() => popup.remove(), 2000);
}

// ── Weekly Challenges ──
const WEEKLY_CHALLENGES = [
    { name: "Answer 50 questions", goal: 50, type: "answers" },
    { name: "Get a 10 streak", goal: 10, type: "streak" },
    { name: "Collect 20 items", goal: 20, type: "collect" },
    { name: "Play 5 mini-games", goal: 5, type: "games" }
];

function getWeeklyChallenge() {
    const weekNum = Math.floor(Date.now() / (7 * 24 * 60 * 60 * 1000));
    return WEEKLY_CHALLENGES[weekNum % WEEKLY_CHALLENGES.length];
}

// ── Space Mode ──
function triggerSpaceMode() {
    document.body.style.background = 'linear-gradient(180deg, #0a0a2e, #1a1a4e, #2a2a6e)';

    // Add stars
    for (let i = 0; i < 50; i++) {
        const star = document.createElement('div');
        star.style.cssText = `
            position: fixed; background: white; border-radius: 50%;
            width: ${Math.random() * 3}px; height: ${Math.random() * 3}px;
            left: ${Math.random() * 100}%; top: ${Math.random() * 100}%;
            z-index: -1; animation: twinkle 1s ease-in-out infinite;
        `;
        star.className = 'space-star';
        document.body.appendChild(star);
    }

    // Show rocket
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        font-size: 5rem; z-index: 1000; animation: levelUpPop 0.6s ease-out;
    `;
    popup.innerHTML = '🚀✨';
    document.body.appendChild(popup);
    playSound('fanfare');

    setTimeout(() => {
        popup.remove();
        document.querySelectorAll('.space-star').forEach(s => s.remove());
        document.body.style.background = '';
    }, 5000);
}

// ── Mystery Islands ──
const MYSTERY_ISLANDS = [
    { name: "Tarantula Island", emoji: "🕷️", reward: { bugs: 10 } },
    { name: "Money Rock Island", emoji: "💰", reward: { shells: 15 } },
    { name: "Bamboo Island", emoji: "🎋", reward: { shells: 5 } },
    { name: "Scorpion Island", emoji: "🦂", reward: { bugs: 10 } },
    { name: "Rare Flower Island", emoji: "🌺", reward: { flowers: 5 } },
    { name: "Big Fish Island", emoji: "🐟", reward: { fish: 10 } }
];

function visitMysteryIsland() {
    if (collectibles.shells < 10) {
        alert("You need 10 shells for a Mystery Island ticket!");
        return;
    }

    collectibles.shells -= 10;
    renderCollectiblesBar();

    const island = pickRandom(MYSTERY_ISLANDS);

    // Apply rewards
    if (island.reward.bugs) collectibles.bugs += island.reward.bugs;
    if (island.reward.fish) collectibles.fish += island.reward.fish;
    if (island.reward.shells) collectibles.shells += island.reward.shells;
    if (island.reward.flowers) {
        for (let i = 0; i < island.reward.flowers; i++) {
            garden.flowers.push(pickRandom(FLOWER_TYPES));
        }
    }

    saveCollectibles();
    saveGarden();
    launchConfetti();

    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); display: flex; align-items: center;
        justify-content: center; z-index: 3000;
    `;
    popup.innerHTML = `
        <div style="background: linear-gradient(135deg, #87ceeb, #90ee90); border-radius: 20px;
            padding: 2rem; text-align: center; animation: levelUpPop 0.6s ease-out;">
            <div style="font-size: 5rem;">${island.emoji}</div>
            <h2 style="color: #3d7c47;">${island.name}!</h2>
            <p style="color: #5c4a32;">You found amazing treasures!</p>
            <button onclick="this.parentElement.parentElement.remove()" class="minigame-btn" style="margin-top: 1rem;">Return Home</button>
        </div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
}

// ── Night Owl / Rainy Day Bonuses ──
function getTimeBonus() {
    const hour = new Date().getHours();
    if (hour >= 21 || hour < 6) {
        return { active: true, name: '🌙 Night Owl Bonus!', multiplier: 1.5 };
    }
    return { active: false, name: '', multiplier: 1 };
}

// ── Add buttons for new features ──
// ══════════════════════════════════════════════════════════════════════════
// MULTIPLAYER MODE
// ══════════════════════════════════════════════════════════════════════════

let multiplayerMode = false;
let players = [
    { name: 'Player 1', score: 0, color: '#ff69b4' },
    { name: 'Player 2', score: 0, color: '#00bfff' }
];
let currentPlayer = 0;
let multiplayerRound = 0;
const MULTIPLAYER_ROUNDS = 10;

function showMultiplayerSetup() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';
    document.body.classList.add('theme-multiplayer');

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #ff1493;">👫 2 Player Mode!</h3>
            <p style="color: #5c4a32; margin-bottom: 1rem;">Take turns answering questions. Highest score wins!</p>

            <div style="background: rgba(255,255,255,0.8); border-radius: 15px; padding: 1rem; margin-bottom: 1rem;">
                <div style="margin-bottom: 1rem;">
                    <label style="color: #ff69b4; font-weight: 700;">🌸 Player 1:</label>
                    <input type="text" id="player1-name" value="${players[0].name}"
                        style="margin-left: 0.5rem; padding: 0.4rem; border-radius: 8px; border: 2px solid #ff69b4; font-family: inherit; width: 120px;">
                </div>
                <div>
                    <label style="color: #00bfff; font-weight: 700;">💙 Player 2:</label>
                    <input type="text" id="player2-name" value="${players[1].name}"
                        style="margin-left: 0.5rem; padding: 0.4rem; border-radius: 8px; border: 2px solid #00bfff; font-family: inherit; width: 120px;">
                </div>
            </div>

            <button class="minigame-btn" onclick="startMultiplayer()" style="background: linear-gradient(135deg, #ff69b4, #00bfff);">
                🎮 Start Game!
            </button>
            <button class="back-btn" onclick="exitMultiplayer()">Back</button>
        </div>
    `;
}

function startMultiplayer() {
    players[0].name = document.getElementById('player1-name').value || 'Player 1';
    players[1].name = document.getElementById('player2-name').value || 'Player 2';
    players[0].score = 0;
    players[1].score = 0;
    currentPlayer = 0;
    multiplayerRound = 0;
    multiplayerMode = true;

    nextMultiplayerQuestion();
}

function nextMultiplayerQuestion() {
    if (multiplayerRound >= MULTIPLAYER_ROUNDS * 2) {
        showMultiplayerResults();
        return;
    }

    const card = document.getElementById('card');
    answered = false;

    // Pick a random multiplication problem
    const a = randInt(2, 12);
    const b = randInt(2, 12);
    const answer = a * b;

    currentProblemA = a;
    currentProblemB = b;

    const player = players[currentPlayer];

    card.innerHTML = `
        <div class="multiplayer-scoreboard">
            <div class="player-score ${currentPlayer === 0 ? 'active' : ''}">
                <div class="player-name">🌸 ${players[0].name}</div>
                <div class="player-points">${players[0].score}</div>
            </div>
            <div class="player-score ${currentPlayer === 1 ? 'active' : ''}">
                <div class="player-name">💙 ${players[1].name}</div>
                <div class="player-points">${players[1].score}</div>
            </div>
        </div>

        <div class="player-turn-indicator">
            ${currentPlayer === 0 ? '🌸' : '💙'} ${player.name}'s Turn!
        </div>

        <div class="question-text" style="margin: 1rem 0;">
            <span class="highlight">${a}</span> × <span class="highlight">${b}</span> = ?
        </div>

        <div class="answer-area">
            <input type="number" class="answer-input" id="mp-answer" autocomplete="off" data-answer="${answer}">
            <button class="submit-btn" onclick="submitMultiplayerAnswer()">Go!</button>
        </div>

        <div class="feedback" id="mp-feedback"></div>
        <button class="next-btn" id="mp-next" style="display:none;" onclick="nextMultiplayerTurn()">Next Turn</button>
    `;

    document.getElementById('mp-answer').focus();

    // Add enter key listener
    document.getElementById('mp-answer').onkeydown = (e) => {
        if (e.key === 'Enter') {
            if (document.getElementById('mp-next').style.display === 'block') {
                nextMultiplayerTurn();
            } else {
                submitMultiplayerAnswer();
            }
        }
    };
}

function submitMultiplayerAnswer() {
    if (answered) return;

    const inp = document.getElementById('mp-answer');
    const userAnswer = inp.value.trim();
    if (userAnswer === '') return;

    answered = true;
    const correct = parseInt(inp.dataset.answer);
    const isCorrect = parseInt(userAnswer) === correct;

    const feedback = document.getElementById('mp-feedback');
    const player = players[currentPlayer];

    if (isCorrect) {
        player.score += 10;
        inp.classList.add('correct');
        feedback.className = 'feedback correct';
        feedback.innerHTML = `✨ Correct! +10 points for ${player.name}!`;
        playSound('correct');
        launchConfetti();
    } else {
        inp.classList.add('wrong');
        feedback.className = 'feedback wrong';
        feedback.innerHTML = `The answer was ${correct}. No points this time!`;
        playSound('wrong');
    }

    // Update scoreboard
    document.querySelectorAll('.player-points')[currentPlayer].textContent = player.score;

    document.getElementById('mp-next').style.display = 'block';
    multiplayerRound++;
}

function nextMultiplayerTurn() {
    currentPlayer = currentPlayer === 0 ? 1 : 0;
    nextMultiplayerQuestion();
}

function showMultiplayerResults() {
    const card = document.getElementById('card');
    const winner = players[0].score > players[1].score ? players[0] :
                   players[1].score > players[0].score ? players[1] : null;

    launchConfetti();
    playSound('fanfare');

    card.innerHTML = `
        <div style="text-align: center;">
            <h2 style="color: #ff1493;">🎉 Game Over!</h2>

            <div class="multiplayer-scoreboard" style="margin: 1.5rem 0;">
                <div class="player-score ${winner === players[0] ? 'active' : ''}">
                    <div class="player-name">🌸 ${players[0].name}</div>
                    <div class="player-points">${players[0].score}</div>
                </div>
                <div class="player-score ${winner === players[1] ? 'active' : ''}">
                    <div class="player-name">💙 ${players[1].name}</div>
                    <div class="player-points">${players[1].score}</div>
                </div>
            </div>

            ${winner ?
                `<div style="font-size: 3rem; margin: 1rem 0;">🏆</div>
                 <h3 style="color: #3d7c47;">${winner.name} Wins!</h3>` :
                `<div style="font-size: 3rem; margin: 1rem 0;">🤝</div>
                 <h3 style="color: #3d7c47;">It's a Tie!</h3>`
            }

            <button class="play-again-btn" onclick="showMultiplayerSetup()" style="margin-top: 1rem; background: linear-gradient(135deg, #ff69b4, #00bfff);">
                Play Again!
            </button>
            <button class="back-btn" onclick="exitMultiplayer()">Back to Solo Mode</button>
        </div>
    `;
}

function exitMultiplayer() {
    multiplayerMode = false;
    document.body.classList.remove('theme-multiplayer');
    setMode('times', document.getElementById('btn-times'));
}

function addMoreButtons() {
    const modeSelect = document.querySelector('.mode-select');

    // Multiplayer button
    if (!modeSelect.querySelector('#btn-multiplayer')) {
        const btn = document.createElement('button');
        btn.id = 'btn-multiplayer';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">👫</span>2 Player';
        btn.onclick = showMultiplayerSetup;
        modeSelect.appendChild(btn);
    }

    // ACNH Trivia button
    if (!modeSelect.querySelector('#btn-acnh')) {
        const btn = document.createElement('button');
        btn.id = 'btn-acnh';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🏝️</span>ACNH Quiz';
        btn.onclick = showACNHMenu;
        modeSelect.appendChild(btn);
    }

    // Wheel button
    if (!modeSelect.querySelector('#btn-wheel')) {
        const btn = document.createElement('button');
        btn.id = 'btn-wheel';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🎰</span>Wheel';
        btn.onclick = showSpinWheel;
        modeSelect.appendChild(btn);
    }

    // Backpack button
    if (!modeSelect.querySelector('#btn-backpack')) {
        const btn = document.createElement('button');
        btn.id = 'btn-backpack';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🎒</span>Backpack';
        btn.onclick = showBackpack;
        modeSelect.appendChild(btn);
    }

    // Encyclopedia button
    if (!modeSelect.querySelector('#btn-encyclopedia')) {
        const btn = document.createElement('button');
        btn.id = 'btn-encyclopedia';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">📖</span>Encyclopedia';
        btn.onclick = showEncyclopedia;
        modeSelect.appendChild(btn);
    }

    // Trophies button
    if (!modeSelect.querySelector('#btn-trophies')) {
        const btn = document.createElement('button');
        btn.id = 'btn-trophies';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🏆</span>Trophies';
        btn.onclick = showTrophies;
        modeSelect.appendChild(btn);
    }

    // Jukebox button
    if (!modeSelect.querySelector('#btn-jukebox')) {
        const btn = document.createElement('button');
        btn.id = 'btn-jukebox';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">📻</span>Jukebox';
        btn.onclick = showJukebox;
        modeSelect.appendChild(btn);
    }

    // Garden button
    if (!modeSelect.querySelector('#btn-garden')) {
        const btn = document.createElement('button');
        btn.id = 'btn-garden';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🌺</span>Garden';
        btn.onclick = showGarden;
        modeSelect.appendChild(btn);
    }

    // Sticker Book button
    if (!modeSelect.querySelector('#btn-stickers')) {
        const btn = document.createElement('button');
        btn.id = 'btn-stickers';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">⭐</span>Stickers';
        btn.onclick = showStickerBook;
        modeSelect.appendChild(btn);
    }

    // Decoration Shop button
    if (!modeSelect.querySelector('#btn-decorations')) {
        const btn = document.createElement('button');
        btn.id = 'btn-decorations';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">🏠</span>Decor Shop';
        btn.onclick = showDecorationShop;
        modeSelect.appendChild(btn);
    }

    // Guestbook button
    if (!modeSelect.querySelector('#btn-guestbook')) {
        const btn = document.createElement('button');
        btn.id = 'btn-guestbook';
        btn.className = 'mode-btn';
        btn.innerHTML = '<span class="mode-icon">📕</span>Guestbook';
        btn.onclick = showGuestbook;
        modeSelect.appendChild(btn);
    }
}

// ── Load all new data ──
function loadNewFeatures() {
    if (multData.petBuddy) petBuddy = { ...petBuddy, ...multData.petBuddy };
    if (multData.encyclopedia) encyclopedia = { ...encyclopedia, ...multData.encyclopedia };
    if (multData.collectedSongs) collectedSongs = multData.collectedSongs;
    // One-time restore: grant 5 songs if fewer than 5 (lost songs fix)
    if (collectedSongs.length < 5) {
        const firstFive = ALL_SONGS.slice(0, 5);
        for (const song of firstFive) {
            if (!collectedSongs.includes(song)) collectedSongs.push(song);
        }
        multData.collectedSongs = collectedSongs;
        saveMultiplicationData();
    }
    if (multData.garden) garden = { ...garden, ...multData.garden };
    if (multData.preferences?.lastSpinDate) lastSpinDate = multData.preferences.lastSpinDate;
    loadWeatherPreference();
    setWeather();
}

function initNewFeatures() {
    addLeaderboardButton();
    addAvatarButton();
    addMapButton();
    addMinigameButton();
    addMoreButtons();
    renderDifficultySelect();
    renderPowerupsBar();
    renderCollectiblesBar();
    renderThemeSelect();
    createMusicToggle();
    createPetBuddy();

    // Load saved data
    if (multData.leaderboard) leaderboard = multData.leaderboard;
    if (multData.preferences?.theme) setTheme(multData.preferences.theme);
    loadAvatar();
    loadCollectibles();
    loadNewFeatures();
}

// Hook into data loading
const originalLoadMultiplicationData = loadMultiplicationData;
loadMultiplicationData = async function() {
    await originalLoadMultiplicationData();
    initNewFeatures();
};

// ── Isabelle's Morning Announcements ──
const ISABELLE_ANNOUNCEMENTS = [
    "Good morning! I hope you're ready for a wonderful day of math practice!",
    "Today's weather is perfect for learning! Let's do our best!",
    "I've heard there might be some bonus questions today. How exciting!",
    "Remember to take breaks and stay hydrated, dear islander!",
    "Tom Nook mentioned he's impressed by how hard you've been working!",
    "Blathers told me the museum is waiting for more of your discoveries!",
    "K.K. Slider might drop by later with a new song if you do well!",
    "The villagers are cheering for you today! You've got this!",
    "I polished your trophies this morning. They're looking great!",
    "Your pet buddy seems extra happy today! Give them some love!",
    "The flowers in your garden are blooming beautifully!",
    "I've prepared some special prizes for the wheel today!",
];

const ISABELLE_EVENTS = [
    { condition: () => getTimeBonus().active, message: "It's late! You get the Night Owl Bonus - 1.5x points! 🌙" },
    { condition: () => canSpinToday(), message: "The Prize Wheel is ready for a spin today! 🎰" },
    { condition: () => multData.stats.dailyStreak >= 3, message: `Amazing! You're on a ${multData.stats.dailyStreak}-day streak! Keep it up! 🔥` },
    { condition: () => garden.flowers.length >= 10, message: "Your garden is flourishing with beautiful flowers! 🌺" },
    { condition: () => petBuddy.level >= 3, message: `${petBuddy.name} is growing so big! Level ${petBuddy.level} already! 🐕` },
];

function showIsabelleAnnouncement() {
    const mainAnnouncement = pickRandom(ISABELLE_ANNOUNCEMENTS);
    const events = ISABELLE_EVENTS.filter(e => e.condition());
    const eventAnnouncement = events.length > 0 ? pickRandom(events).message : null;

    const popup = document.createElement('div');
    popup.id = 'isabelle-popup';
    popup.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.85); display: flex; align-items: center;
        justify-content: center; z-index: 5000; animation: fadeIn 0.5s ease-out;
    `;

    popup.innerHTML = `
        <div style="background: linear-gradient(135deg, #a8e6cf 0%, #dcedc1 50%, #ffd3b6 100%);
            border-radius: 20px; padding: 1.5rem; max-width: 340px; text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3); animation: levelUpPop 0.6s ease-out;">

            <div style="font-size: 4rem; margin-bottom: 0.5rem;">🐕</div>
            <h2 style="color: #3d7c47; font-size: 1.3rem; margin-bottom: 0.5rem;">Isabelle's Announcements</h2>

            <div style="background: rgba(255,255,255,0.7); border-radius: 12px; padding: 1rem; margin: 1rem 0;">
                <p style="color: #5c4a32; font-size: 0.95rem; line-height: 1.5;">"${mainAnnouncement}"</p>
            </div>

            ${eventAnnouncement ? `
                <div style="background: rgba(255,215,0,0.2); border: 2px solid #ffd700; border-radius: 12px; padding: 0.8rem; margin: 1rem 0;">
                    <p style="color: #5c4a32; font-size: 0.9rem; font-weight: 600;">📢 ${eventAnnouncement}</p>
                </div>
            ` : ''}

            <p style="color: #7a9a5a; font-size: 0.85rem; margin-bottom: 1rem;">
                "That's all for today! Have a wonderful time on your island!"
            </p>

            <button onclick="closeIsabelleAnnouncement()" style="
                background: #3d7c47; color: white; border: none; border-radius: 12px;
                padding: 0.8rem 2rem; font-family: inherit; font-weight: 700;
                font-size: 1rem; cursor: pointer;">
                Let's Go! 🎉
            </button>
        </div>
    `;

    document.body.appendChild(popup);
}

function closeIsabelleAnnouncement() {
    const popup = document.getElementById('isabelle-popup');
    if (popup) {
        popup.style.animation = 'fadeIn 0.3s ease-out reverse';
        setTimeout(() => {
            popup.remove();
            startRound(); // Start the game after closing
        }, 300);
    }
}

// ══════════════════════════════════════════════════════════
// ── Passport Stamps ──
// ══════════════════════════════════════════════════════════

const PASSPORT_STAMPS = {
    na:      { name: 'North America',  stamp: '🦅', color: '#4a90d9' },
    sa:      { name: 'South America',  stamp: '🦜', color: '#2ecc71' },
    europe:  { name: 'Europe',         stamp: '🏰', color: '#9b59b6' },
    africa:  { name: 'Africa',         stamp: '🦁', color: '#e67e22' },
    asia:    { name: 'Asia',           stamp: '🐼', color: '#e74c3c' },
    oceania: { name: 'Oceania',        stamp: '🦘', color: '#1abc9c' }
};

function getPassport() {
    if (!multData.passport) {
        multData.passport = {};
    }
    return multData.passport;
}

function awardPassportStamp(region, score) {
    if (region === 'world') return; // No stamp for "world" — pick a specific region!
    const passport = getPassport();
    const isGold = score === 10;
    const existing = passport[region];

    if (existing && existing.gold) return; // Already have gold, nothing to upgrade
    if (existing && !isGold) return; // Already have stamp, not upgrading to gold

    passport[region] = {
        earned: true,
        gold: isGold,
        date: new Date().toLocaleDateString()
    };

    saveMultiplicationData();
    showStampAnimation(region, isGold);
}

function showStampAnimation(region, isGold) {
    const info = PASSPORT_STAMPS[region];
    if (!info) return;

    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed; top: 15%; left: 50%; transform: translateX(-50%);
        background: ${isGold ? 'linear-gradient(135deg, #f6d365, #fda085)' : `linear-gradient(135deg, ${info.color}, ${info.color}cc)`};
        color: white; padding: 1.5rem 2.5rem; border-radius: 20px; z-index: 2000;
        text-align: center; animation: badgePop 0.5s ease-out;
        box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        border: 3px solid ${isGold ? '#f0c030' : 'rgba(255,255,255,0.4)'};
    `;
    popup.innerHTML = `
        <div style="font-size: 3rem;">${isGold ? '✨' : ''}${info.stamp}${isGold ? '✨' : ''}</div>
        <div style="font-weight: 800; font-size: 1.2rem;">${isGold ? 'GOLD ' : ''}Passport Stamp!</div>
        <div style="font-size: 0.9rem; margin-top: 0.3rem;">${info.name}</div>
        <div style="font-size: 0.8rem; margin-top: 0.2rem; opacity: 0.8;">${isGold ? 'Perfect score! 10/10' : 'Score 10/10 for gold!'}</div>
    `;
    document.body.appendChild(popup);
    playSound('fanfare');
    if (isGold) launchConfetti();
    setTimeout(() => popup.remove(), 3000);
}

function renderPassport() {
    const passport = getPassport();
    const regions = Object.keys(PASSPORT_STAMPS);
    const earned = regions.filter(r => passport[r]?.earned).length;
    const golds = regions.filter(r => passport[r]?.gold).length;

    return `
        <div style="background: linear-gradient(135deg, #1a3a5c, #2c5f8a); border-radius: 16px; padding: 1rem; margin-bottom: 1rem; color: white; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -20px; right: -20px; font-size: 5rem; opacity: 0.1;">🛂</div>
            <div style="font-weight: 800; font-size: 1.1rem; margin-bottom: 0.6rem;">🛂 My Passport <span style="font-size: 0.8rem; opacity: 0.7;">${earned}/${regions.length} stamps</span></div>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem;">
                ${regions.map(r => {
                    const info = PASSPORT_STAMPS[r];
                    const stamp = passport[r];
                    const isGold = stamp?.gold;
                    const isEarned = stamp?.earned;
                    return `
                        <div style="background: ${isEarned ? (isGold ? 'linear-gradient(135deg, #f6d365, #fda085)' : 'rgba(255,255,255,0.2)') : 'rgba(0,0,0,0.2)'};
                            border-radius: 10px; padding: 0.5rem; text-align: center;
                            border: 2px solid ${isGold ? '#f0c030' : (isEarned ? 'rgba(255,255,255,0.3)' : 'rgba(255,255,255,0.1)')};
                            ${!isEarned ? 'opacity: 0.5;' : ''}">
                            <div style="font-size: 1.5rem;">${isEarned ? info.stamp : '❓'}</div>
                            <div style="font-size: 0.65rem; font-weight: 700;">${info.name}</div>
                            ${isGold ? '<div style="font-size: 0.6rem;">⭐ GOLD</div>' : ''}
                            ${isEarned && !isGold ? '<div style="font-size: 0.6rem; opacity: 0.7;">✓ Earned</div>' : ''}
                            ${!isEarned ? '<div style="font-size: 0.6rem; opacity: 0.7;">Score 7+</div>' : ''}
                        </div>
                    `;
                }).join('')}
            </div>
            ${golds === regions.length ? '<div style="text-align: center; margin-top: 0.5rem; font-weight: 800;">🏆 ALL GOLD — Master Explorer! 🏆</div>' : ''}
        </div>
    `;
}

// ══════════════════════════════════════════════════════════
// ── World Quiz (Geography Game) ──
// ══════════════════════════════════════════════════════════

const GEO_REGIONS = {
    world:  { name: 'World',         emoji: '🌍', viewBox: '0 -80 2050 1020' },
    na:     { name: 'North America',  emoji: '🦅', viewBox: '50 100 700 450' },
    sa:     { name: 'South America',  emoji: '🦜', viewBox: '480 480 280 470' },
    europe: { name: 'Europe',         emoji: '🏰', viewBox: '880 170 320 220' },
    africa: { name: 'Africa',         emoji: '🦁', viewBox: '880 350 350 420' },
    asia:   { name: 'Asia',           emoji: '🐼', viewBox: '1150 80 650 520' },
    oceania:{ name: 'Oceania',        emoji: '🦘', viewBox: '1550 570 350 330' }
};

const GEO_COUNTRIES = [
    // North America
    { code: 'us', name: 'United States', region: 'na' },
    { code: 'ca', name: 'Canada', region: 'na' },
    { code: 'mx', name: 'Mexico', region: 'na' },
    { code: 'gt', name: 'Guatemala', region: 'na' },
    { code: 'cu', name: 'Cuba', region: 'na' },
    { code: 'ht', name: 'Haiti', region: 'na' },
    { code: 'jm', name: 'Jamaica', region: 'na' },
    { code: 'hn', name: 'Honduras', region: 'na' },
    { code: 'ni', name: 'Nicaragua', region: 'na' },
    { code: 'cr', name: 'Costa Rica', region: 'na' },
    { code: 'pa', name: 'Panama', region: 'na' },
    // South America
    { code: 'br', name: 'Brazil', region: 'sa' },
    { code: 'ar', name: 'Argentina', region: 'sa' },
    { code: 'co', name: 'Colombia', region: 'sa' },
    { code: 'pe', name: 'Peru', region: 'sa' },
    { code: 've', name: 'Venezuela', region: 'sa' },
    { code: 'cl', name: 'Chile', region: 'sa' },
    { code: 'ec', name: 'Ecuador', region: 'sa' },
    { code: 'bo', name: 'Bolivia', region: 'sa' },
    { code: 'py', name: 'Paraguay', region: 'sa' },
    { code: 'uy', name: 'Uruguay', region: 'sa' },
    { code: 'gy', name: 'Guyana', region: 'sa' },
    { code: 'sr', name: 'Suriname', region: 'sa' },
    // Europe
    { code: 'gb', name: 'United Kingdom', region: 'europe' },
    { code: 'fr', name: 'France', region: 'europe' },
    { code: 'de', name: 'Germany', region: 'europe' },
    { code: 'it', name: 'Italy', region: 'europe' },
    { code: 'es', name: 'Spain', region: 'europe' },
    { code: 'pt', name: 'Portugal', region: 'europe' },
    { code: 'pl', name: 'Poland', region: 'europe' },
    { code: 'se', name: 'Sweden', region: 'europe' },
    { code: 'no', name: 'Norway', region: 'europe' },
    { code: 'fi', name: 'Finland', region: 'europe' },
    { code: 'ua', name: 'Ukraine', region: 'europe' },
    { code: 'ro', name: 'Romania', region: 'europe' },
    { code: 'gr', name: 'Greece', region: 'europe' },
    { code: 'nl', name: 'Netherlands', region: 'europe' },
    { code: 'be', name: 'Belgium', region: 'europe' },
    { code: 'at', name: 'Austria', region: 'europe' },
    { code: 'ch', name: 'Switzerland', region: 'europe' },
    { code: 'ie', name: 'Ireland', region: 'europe' },
    { code: 'dk', name: 'Denmark', region: 'europe' },
    { code: 'cz', name: 'Czech Republic', region: 'europe' },
    { code: 'hu', name: 'Hungary', region: 'europe' },
    { code: 'rs', name: 'Serbia', region: 'europe' },
    { code: 'bg', name: 'Bulgaria', region: 'europe' },
    { code: 'hr', name: 'Croatia', region: 'europe' },
    { code: 'is', name: 'Iceland', region: 'europe' },
    // Africa
    { code: 'eg', name: 'Egypt', region: 'africa' },
    { code: 'ng', name: 'Nigeria', region: 'africa' },
    { code: 'za', name: 'South Africa', region: 'africa' },
    { code: 'ke', name: 'Kenya', region: 'africa' },
    { code: 'et', name: 'Ethiopia', region: 'africa' },
    { code: 'gh', name: 'Ghana', region: 'africa' },
    { code: 'tz', name: 'Tanzania', region: 'africa' },
    { code: 'dz', name: 'Algeria', region: 'africa' },
    { code: 'ma', name: 'Morocco', region: 'africa' },
    { code: 'cd', name: 'DR Congo', region: 'africa' },
    { code: 'mg', name: 'Madagascar', region: 'africa' },
    { code: 'sn', name: 'Senegal', region: 'africa' },
    { code: 'ml', name: 'Mali', region: 'africa' },
    { code: 'ne', name: 'Niger', region: 'africa' },
    { code: 'td', name: 'Chad', region: 'africa' },
    { code: 'ly', name: 'Libya', region: 'africa' },
    { code: 'sd', name: 'Sudan', region: 'africa' },
    { code: 'ao', name: 'Angola', region: 'africa' },
    { code: 'mz', name: 'Mozambique', region: 'africa' },
    { code: 'cm', name: 'Cameroon', region: 'africa' },
    // Asia
    { code: 'cn', name: 'China', region: 'asia' },
    { code: 'in', name: 'India', region: 'asia' },
    { code: 'jp', name: 'Japan', region: 'asia' },
    { code: 'kr', name: 'South Korea', region: 'asia' },
    { code: 'id', name: 'Indonesia', region: 'asia' },
    { code: 'th', name: 'Thailand', region: 'asia' },
    { code: 'vn', name: 'Vietnam', region: 'asia' },
    { code: 'ph', name: 'Philippines', region: 'asia' },
    { code: 'my', name: 'Malaysia', region: 'asia' },
    { code: 'pk', name: 'Pakistan', region: 'asia' },
    { code: 'bd', name: 'Bangladesh', region: 'asia' },
    { code: 'ir', name: 'Iran', region: 'asia' },
    { code: 'iq', name: 'Iraq', region: 'asia' },
    { code: 'sa_c', name: 'Saudi Arabia', region: 'asia' },
    { code: 'tr', name: 'Turkey', region: 'asia' },
    { code: 'af', name: 'Afghanistan', region: 'asia' },
    { code: 'mm', name: 'Myanmar', region: 'asia' },
    { code: 'np', name: 'Nepal', region: 'asia' },
    { code: 'kz', name: 'Kazakhstan', region: 'asia' },
    { code: 'uz', name: 'Uzbekistan', region: 'asia' },
    { code: 'mn', name: 'Mongolia', region: 'asia' },
    // Oceania
    { code: 'au', name: 'Australia', region: 'oceania' },
    { code: 'nz', name: 'New Zealand', region: 'oceania' },
    { code: 'pg', name: 'Papua New Guinea', region: 'oceania' },
    { code: 'fj', name: 'Fiji', region: 'oceania' },
    // Russia spans both
    { code: 'ru', name: 'Russia', region: 'asia' }
];

const GEO_FUN_FACTS = {
    us: "The US has 50 states and its capital is Washington, D.C.!",
    ca: "Canada has more lakes than all other countries combined!",
    mx: "Mexico City was built on top of an ancient Aztec city!",
    gt: "Guatemala means 'place of many trees' in the Mayan language!",
    cu: "Cuba is the largest island in the Caribbean!",
    ht: "Haiti was the first free Black republic in the world!",
    jm: "Jamaica is the birthplace of reggae music!",
    hn: "Honduras has the second largest coral reef in the world!",
    ni: "Nicaragua has two big lakes: Lake Managua and Lake Nicaragua!",
    cr: "Costa Rica means 'Rich Coast' in Spanish!",
    pa: "The Panama Canal connects the Atlantic and Pacific Oceans!",
    br: "Brazil is home to the Amazon Rainforest, the largest in the world!",
    ar: "Argentina is named after the Latin word for silver!",
    co: "Colombia is the only South American country with coasts on both oceans!",
    pe: "Peru is home to Machu Picchu, an ancient Inca city in the mountains!",
    ve: "Venezuela has the world's highest waterfall: Angel Falls!",
    cl: "Chile is the longest north-south country in the world!",
    ec: "Ecuador is named after the equator which runs through it!",
    bo: "Bolivia has two capital cities: La Paz and Sucre!",
    py: "Paraguay's flag has different designs on each side!",
    uy: "Uruguay was the first country to host the FIFA World Cup in 1930!",
    gy: "Guyana is the only English-speaking country in South America!",
    sr: "Suriname is the smallest country in South America!",
    gb: "The UK includes England, Scotland, Wales, and Northern Ireland!",
    fr: "France is the most visited country in the world!",
    de: "Germany is famous for its castles - it has over 20,000!",
    it: "Italy is shaped like a boot!",
    es: "Spain introduced chocolate to Europe!",
    pt: "Portugal is one of the oldest countries in Europe!",
    pl: "Poland is home to the Wieliczka Salt Mine, an underground city!",
    se: "Sweden invented the zipper, dynamite, and the computer mouse!",
    no: "Norway has the longest coastline in Europe!",
    fi: "Finland has more saunas than cars!",
    ua: "Ukraine is the largest country entirely in Europe!",
    ro: "Romania is home to Dracula's castle (Bran Castle)!",
    gr: "Greece hosted the first modern Olympic Games in 1896!",
    nl: "About one-third of the Netherlands is below sea level!",
    be: "Belgium is famous for chocolate, waffles, and comic books!",
    at: "Austria is the birthplace of Mozart!",
    ch: "Switzerland has four official languages!",
    ie: "Ireland's national symbol is the shamrock!",
    dk: "Denmark is home to the oldest amusement park in the world, Tivoli Gardens!",
    cz: "The Czech Republic is famous for its beautiful castles!",
    hu: "Hungary's Lake Balaton is the largest lake in Central Europe!",
    rs: "Serbia is one of the largest raspberry producers in the world!",
    bg: "Bulgaria invented the Cyrillic alphabet!",
    hr: "Croatia has over 1,000 islands!",
    is: "Iceland has no mosquitoes!",
    eg: "Egypt's Great Pyramid is one of the Seven Wonders of the Ancient World!",
    ng: "Nigeria is called the 'Giant of Africa' because of its large population!",
    za: "South Africa has three capital cities!",
    ke: "Kenya is famous for its wildlife safaris and the Great Migration!",
    et: "Ethiopia has its own calendar with 13 months!",
    gh: "Ghana was the first African country south of the Sahara to gain independence!",
    tz: "Tanzania is home to Mount Kilimanjaro, Africa's tallest mountain!",
    dz: "Algeria is the largest country in Africa!",
    ma: "Morocco is just 8 miles from Spain across the Strait of Gibraltar!",
    cd: "The Congo River is the deepest river in the world!",
    mg: "Madagascar is home to animals found nowhere else on Earth, like lemurs!",
    sn: "Senegal is known as the Gateway to Africa!",
    ml: "Mali's Timbuktu was once one of the richest cities in the world!",
    ne: "Niger is named after the Niger River!",
    td: "Chad has over 200 different ethnic groups!",
    ly: "Libya is mostly covered by the Sahara Desert!",
    sd: "Sudan has more pyramids than Egypt!",
    ao: "Angola is one of Africa's top oil producers!",
    mz: "Mozambique's flag features a book, a hoe, and a rifle!",
    cm: "Cameroon is called 'Africa in Miniature' for its diverse landscapes!",
    cn: "China's Great Wall is over 13,000 miles long!",
    in: "India has the most languages spoken in any country - over 700!",
    jp: "Japan has over 6,800 islands!",
    kr: "South Korea invented the world's first metal movable type printing!",
    id: "Indonesia is the world's largest island country with over 17,000 islands!",
    th: "Thailand is the only Southeast Asian country never colonized by Europe!",
    vn: "Vietnam is the world's largest exporter of cashew nuts!",
    ph: "The Philippines has over 7,000 islands!",
    my: "Malaysia's Petronas Towers were once the world's tallest buildings!",
    pk: "Pakistan has the second highest mountain in the world: K2!",
    bd: "Bangladesh has the longest beach in the world: Cox's Bazar!",
    ir: "Iran is home to one of the world's oldest civilizations!",
    iq: "Iraq is home to ancient Mesopotamia, the 'Cradle of Civilization'!",
    sa_c: "Saudi Arabia has no permanent rivers!",
    tr: "Turkey is the only country that spans two continents!",
    af: "Afghanistan's national sport is Buzkashi, played on horseback!",
    mm: "Myanmar has the largest book in the world, carved on 729 marble slabs!",
    np: "Nepal is home to Mount Everest, the tallest mountain on Earth!",
    kz: "Kazakhstan is the largest landlocked country in the world!",
    uz: "Uzbekistan is one of only two double-landlocked countries!",
    mn: "Mongolia has the lowest population density of any country!",
    au: "Australia is both a country and a continent!",
    nz: "New Zealand was the first country to give women the right to vote!",
    pg: "Papua New Guinea has over 800 languages - more than any other country!",
    fj: "Fiji has over 300 islands but only about 100 are inhabited!",
    ru: "Russia spans 11 time zones, more than any other country!"
};

// Simplified SVG path data for world map
// Uses a ~1000x500 coordinate system (equirectangular-ish projection)
const WORLD_MAP_PATHS = {
    ad: "M985.4 301.7l.1-.2.1-.2v-.1l-.2-.1-.7-.2-.3-.1-.2.1-.2.2-.1.3.1.1v.4l.1.2h.4l.3-.1.5-.3h.1z",
    ae: "M1283.9 408.6l-1.3-2.2-3 3.9-3.7 4.1-3.3 4.3-3.3-.2-4.6-.2-4.2 1-.3-1.7-1 .3.4 1.5 2.6 6.4 16.8 3.2 1-1.3-.1-2.6 1.4-2.6-.3-2.6 2.4-1.3-1.1-.8.1-4.2h2.8l-1.3-5z",
    af: "M1369.9 333.8h-5.4l-3.8-.5-2.5 2.9-2.1.7-1.5 1.3-2.6-2.1-1-5.4-1.6-.3v-2l-3.2-1.5-1.7 2.3.2 2.6-.6.9-3.2-.1-.9 3-2.1-1.3-3.3 2.1-1.8-.8-4.3-1.4h-2.9l-1.6-.2-2.9-1.7-.3 2.3-4.1 1.2.1 5.2-2.5 2-4 .9-.4 3-3.9.8-5.9-2.4-.5 8-.5 4.7 2.5.9-1.6 3.5 2.7 5.1 1.1 4 4.3 1.1 1.1 4-3.9 5.8 9.6 3.2 5.3-.9 3.3.8.9-1.4 3.8.5 6.6-2.6-.8-5.4 2.3-3.6h4l.2-1.7 4-.9 2.1.6 1.7-1.8-1.1-3.8 1.5-3.8 3-1.6-3-4.2 5.1.2.9-2.3-.8-2.5 2-2.7-1.4-3.2-1.9-2.8 2.4-2.8 5.3-1.3 5.8-.8 2.4-1.2 2.8-.7-1.4-1.9z",
    ag: "M634.3 463.8l.2-.1V463.4l-.1-.1-.1-.2-.4-.2-.5.5v.2l.1.3.6.1.2-.2zm.2-3.5v-.5l-.1-.2h-.3l-.1-.1h-.1l-.1.1.1.6.5.3.1-.2z",
    ai: "M627.9 456.2l.1-.2-.2-.1-.8.5v.1l.9-.3z",
    al: "M1077.5 300.5l-2 3.1.5 1.9 1 1-.5 1.9-.1 4.3.7 3 3 2.1.2 1.4 1 .4 2.1-3 .1-2.1 1.6-.9V312l-2.3-1.6-.9-2.6.4-2.1-.5-2.3-1.3-.6-1.3-1.6-1.3.5-.4-1.2z",
    am: "M1219 325.1l-.9-4.4-2.5-1.1-2.5-1.7 1-2-3.1-2.2.7-1.5-2.2-1.1-1.4-1.7-6.9 1 1.3 2.2v3.1l4.2 1.5 2.4 1.9 1-.2 1.8 1.7h2.3l.2 1 2.8 3.7 1.8-.2z",
    ao: "M1068.3 609.6l-16.6-.1-1.9.7-1.7-.1-2.3.9-.5 1.2 2.8 4 1.1 4.3 1.6 6.1-1.7 2.6-.3 1.3 1.3 3.8 1.5 3.9 1.6 2.2.3 3.6-.7 4.8-1.8 2.8-3.3 4.2-1.3 2.6-1.9 5.7-.3 2.7-2 5.9-.9 5.5.5 4 2.7-1.2 3.3-1 3.6.1 3.2 2.9.9-.4 22.5-.3 3.7 3 13.4.9 10.3-2.5-3.5-4-3.6-5.2.8-20.3 11.6.1-.5-2.2.9-2.4-.9-3 .7-3-.5-2-2.6-.4-3.5 1-2.4-.2-1.4.6.5-7.6-1.9-2.3-.3-4 .9-3.8-1.2-2.4v-4h-6.8l.5-2.3h-2.9l-.3 1.1-3.4.3-1.5 3.7-.9 1.6-3-.9-1.9.9-3.7.5-2.1-3.3-1.3-2.1-1.6-3.8-1.3-4.7zm-21.8-1.3l.2-2.7.9-1.7 2-1.3-2-2.2-1.8 1.1-2.2 2.7 1.4 4.8 1.5-.7z",
    ar: "M669.8 920.7l.9-3-7.3-1.5-7.7-3.6-4.3-4.6-3-2.8 5.9 13.5h5l2.9.2 3.3 2.1 4.3-.3zm-50.4-208.1l-7.4-1.5-4 5.7.9 1.6-1.1 6.6-5.6 3.2 1.6 10.6-.9 2 2 2.5-3.2 4-2.6 5.9-.9 5.8 1.7 6.2-2.1 6.5 4.9 10.9 1.6 1.2 1.3 5.9-1.6 6.2 1.4 5.4-2.9 4.3 1.5 5.9 3.3 6.3-2.5 2.4.3 5.7.7 6.4 3.3 7.6-1.6 1.2 3.6 7.1 3.1 2.3-.8 2.6 2.8 1.3 1.3 2.3-1.8 1.1 1.8 3.7 1.1 8.2-.7 5.3 1.8 3.2-.1 3.9-2.7 2.7 3.1 6.6 2.6 2.2 3.1-.4 1.8 4.6 3.5 3.6 12 .8 4.8.9 2.2.4-4.7-3.6-4.1-6.3.9-2.9 3.5-2.5.5-7.2 4.7-3.5-.2-5.6-5.2-1.3-6.4-4.5-.1-4.7 2.9-3.1 4.7-.1.2-3.3-1.2-6.1 2.9-3.9 4.1-1.9-2.5-3.2-2.2 2-4-1.9-2.5-6.2 1.5-1.6 5.6 2.3 5-.9 2.5-2.2-1.8-3.1-.1-4.8-2-3.8 5.8.6 10.2-1.3 6.9-3.4 3.3-8.3-.3-3.2-3.9-2.8-.1-4.5-7.8-5.5-.3-3.3-.4-4.2.9-1.4-1.1-6.3.3-6.5.5-5.1 5.9-8.6 5.3-6.2 3.3-2.6 4.2-3.5-.5-5.1-3.1-3.7-2.6 1.2-.3 5.7-4.3 4.8-4.2 1.1-6.2-1-5.7-1.8 4.2-9.6-1.1-2.8-5.9-2.5-7.2-4.7-4.6-1-11.2-10.4-1-1.3-6.3-.3-1.6 5.1-3.7-4.6z",
    at: "M1060.2 264l-2.3-1.2-2.3.3-4-1.9-1.7.5-2.6 2.5-3.8-2-1.5 2.9-1.7.8 1 4-.4 1.1-1.7-1.3-2.4-.2-3.4 1.2-4.4-.3-.6 1.6-2.6-1.7-1.5.3.2 1.1-.7 1.6 2.3 1.1 2.6.2 3.1.9.5-1.2 4.8-1.1 1.3 2.2 7.2 1.6 4.2.4 2.4-1.4 4.3-.1.9-1.1 1.3-4-1.1-1.3h2.8l.2-2.6-.7-2.1.3-.8z",
    au: "M1726.7 832l-3-.5-1.9 2.9-.6 5.4-2.1 4-.5 5.3 3 .2.8.3 6.6-4.3.6 1.7 4-4.9 3.2-2.2 4.5-7.3-2.8-.5-4.8 1.2-3.4.9-3.6-2.2zm50.1-172.3l.5-2.3.1-3.6-1.6-3.2.1-2.7-1.3-.8.1-3.9-1.2-3.2-2.3 2.4-.4 1.8-1.5 3.5-1.8 3.4.6 2.1-1.2 1.3-1.5 4.8.1 3.7-.7 1.8.3 3.1-2.6 5-1.3 3.5-1.7 2.9-1.7 3.4-4.1 2.1-4.9-2.1-.5-2-2.5-1.6h-1.6l-3.3-3.8-2.5-2.2-3.9-2-3.9-3.5-.1-1.8 2.5-3.1 2.1-3.2-.3-2.6 1.9-.2 2.5-2.5 2-3.4-2.2-3.2-1.5 1.2-2-.5-3.5 1.8-3.2-2-1.7.7-4.5-1.6-2.7-2.7-3.5-1.5-3.1.9 3.9 2.1-.3 3.2-4.8 1.2-2.8-.7-3.6 2.2-2.9 3.7.6 1.5-2.7 1.7-3.4 5.1.6 3.5-3.4-.6h-3.5l-2.5-3.8-3.7-2.9-2.8.8-2.6.9-.3 1.6-2.4-.7-.3 1.8-3 1.1-1.7 2.5-3.5 3.1-1.4 4.8-2.3-1.3-2.2 3.1 1.5 3-2.6 1.2-1.4-5.5-4.8 5.4-.8 3.5-.7 2.5-3.8 3.3-2 3.4-3.5 2.8-6.1 1.9-3.1-.2-1.5.6-1.1 1.4-3.5.7-4.7 2.4-1.4-.8-2.6.5-4.6 2.3-3.2 2.7-4.8 2.1-3.1 4.4.4-4.8-3.1 4.6-.1 3.7-1.3 3.2-1.5 1.5-1.3 3.7.9 1.9.1 2 1.6 5-.7 3.3-1-2.5-2.3-1.8.4 5.9-1.7-2.8.1 2.8 1.8 5-.6 5 1.7 2.5-.4 1.9.9 4.1-1.3 3.6-.3 3.6.7 6.5-.7 3.7-2.2 4.4-.6 2.3-1.5 1.5-2.9.8-1.5 3.7 2.4 1.2 4 4.1h3.6l3.8.3 3.3-2.1 3.4-1.8 1.4.3 4.5-3.4 3.8-.3 4.1-.7 4.2 1.2 3.6-.6 4.6-.2 3-2.6 2.3-3.3 5.2-1.5 6.9-3.2 5 .4 6.9-2.1 7.8-2.3 9.8-.6 4 3.1 3.7.2 5.3 3.8-1.6 1.5 1.8 2.4 1.3 4.6-1.6 3.4 2.9 2.6 4.3-5.1 4.3-2.1 6.7-5.5-1.6 4.7-3.4 3.2-2.5 3.7-4.4 3.5 5.2-1.2 4.7-4.4-.9 4.8-3.2 3.1 4.7.8 1.3 2.6-.4 3.3-1.5 4.9 1.4 4 4 1.9 2.8.4 2.4 1 3.5 1.8 7.2-4.7 3.5-1.2-2.7 3.4 2.6 1.1 2.7 2.8 4.7-2.7 3.8-2.5 6.3-2.7 6-.2 4.2-2.3.9-2 3-4.5 3.9-4.8 3.6-3.2 4.4-5.6 3.3-3.1 4.4-5 5.4-3.1 5-5.8 3.1-4.5 1.4-3.6 3.8-5.7 2.1-2.9 2.5-5.7-.7-5.4 1.7-3.9 1.1-3.7v-5.1l-2.8-5.1-1.9-2.5-2.9-3.9.7-6.7-1.5 1-1.6-2.8-2.5 1.4-.6-6.9-2.2-4 1-1.5-3.1-2.8-3.2-3-5.3-3.3-.9-4.3 1.3-3.3-.4-5.5-1.3-.7-.2-3.2-.2-5.5 1.1-2.8-2.3-2.5-1.4-2.7-3.9 2.4-1.2-5z",
    aw: "M586.6 492.9l-.1-.1-.3-.6-.3-.3-.1.1-.1.3.3.3.3.4.3.1v-.2z",
    az: "M1210.1 318.9l-1 .2 1.2 2.4 3.2 2.9 3.7.9-2.8-3.7-.2-1h-2.3l-1.8-1.7zm10.4-9.3l-4.3-3.8-1.5-.2-1.1.9 3.2 3.4-.6.7-2.8-.4-4.2-1.8-1.1 1 1.4 1.7 2.2 1.1-.7 1.5 3.1 2.2-1 2 2.5 1.7 2.5 1.1.9 4.4 5.3-4.7 1.9-.5 1.9 1.9-1.2 3.1 3.8 3.4 1.3-.3-.8-3.2 1.7-1.5.4-2.2-.1-5 4.2-.5-2-1.7-2.5-.2-3.5-4.5-3.4-3.2-2.6 2.5-.5 1.5-2.4-.4z",
    ba: "M1062.2 284.9l-2.3.1-1 1.3-1.9-1.4-.9 2.5 2.7 2.9 1.3 1.9 2.5 2.3 2 1.4 2.2 2.5 4.7 2.4.4-3.4 1.5-1.4.9-.6 1.2-.3.5-2.9-2.7-2.3 1-2.7h-1.8l-2.4-1.4-3.5.1-4.4-1z",
    bb: "M644.9 488.9l.4-.4-.3-.3-.6-.8-.3.1v1l.1.3.5.3.2-.2z",
    bd: "M1486.5 431.9l-4.5-10.1-1.5.1-.2 4-3.5-3.3 1.1-3.6 2.4-.4 1.6-5.3-3.4-1.1-5 .1-5.4-.9-1.2-4.4-2.7-.4-4.8-2.7-1.2 4.3 4.6 3.4-3.1 2.4-.8 2.3 3.7 1.7-.4 3.8 2.6 4.8 1.6 5.2 2.2.6 1.7.7.6-1.2 2.5 1.3 1.3-3.5-.9-2.6 5.1.2 2.8 3.7 1.5 3.1.8 3.2 2 3.3-1.1-5.1 2.1 1-.5-4.6z",
    be: "M1000.7 246.2l-4.4 1.3-3.6-.5-3.8 1.2.7 2.2 2.2.1 2.4 2.4 3.4 2.9 2.5-.4 4.4 2.8.4-3.5 1.3-.2.4-4.2-2.8-1.4-3.1-2.7z",
    bf: "M978.8 477.2h-3.6l-1.4-1.2-3 .9-5.2 2.6-1.1 2-4.3 2.9-.8 1.6-2.3 1.3-2.7-.9-1.6 1.6-.8 4.4-4.5 5.2.2 2.2-1.6 2.7.4 3.7 2.5 1.4 1 2.1 2.5 1.3 1.9-1.6 2.7-.2 3.8 1.6-.8-4.8.2-3.6 9.7-.3 2.4.5 1.8-1 2.6.5 4.9.1 1.9-.7 1.2-2.8 2.7-.6 1.2-1.9.1-4.4-6.4-1.4-.2-3.1-3.1-4.1-.8-2.9.5-3.1z",
    bg: "M1121.6 294.3l-3-.7-4-2.2-5.8 1.4-2.3 1.6-7.5-.3-4-1-1.9.5-1.8-2.6-1.1 1.4.7 2.3 2.8 2.6-1.7 1.9-.7 2 .6.7-.7.9 2.8 2 .8 4.1 3.8.2 3.9-1.7 3.9 2.1 4.6-.6-.3-3 5-2 4.5.8-2.1-3.5 1.3-4.4 2.2-2.5z",
    bi: "M1148.2 590l-.3-2.5-3-.4-1.7 3.6-3.5-.5 1.4 2.9.1 1.1 2 6.1-.1.3.6-.1 2.1-2.3 2.2-3.3 1.4-1.4v-2l-1.2-1.5z",
    bj: "M996.9 498l-4.3-3.7h-2l-1.9 1.9-1.2 1.9-2.7.6-1.2 2.8-1.9.7-.7 3.3 1.7 1.9 2 2.3.2 3.1 1.1 1.3-.2 14.6 1.4 4.4 4.6-.8.3-10.2-.1-4.1 1-4 1.7-1.9 2.7-4-.6-1.7 1.1-2.5-1.2-3.8.2-2.1z",
    bm: "M630.2 366.8l.4-.6h-.1l-.5.5-.6.2.1.1h.1l.6-.2z",
    bn: "M1617.8 543.4l2.7 3.3 1.1-2.2 2.7.2.1-4.1.1-3.1-4.6 3.5-2.1 2.4z",
    bo: "M655.7 700.5l1.6-1.3-.8-3.6 1.3-2.8.5-5-1.6-4-3.2-1.7-.8-2.6.6-3.6-10.7-.3-2.7-7.4 1.6-.1-.3-2.8-1.2-1.8-.5-3.7-3.3-1.9-3.5.1-2.5-1.9-3.8-1.2-2.4-2.4-6.3-1-6.4-5.7.3-4.3-.9-2.5.4-4.7-7.3 1.1-2.8 2.3-4.8 2.6-1.1 1.9-2.9.2-4.2-.6 5.5 10.3-1.1 2.1.1 4.5.3 5.4-1.9 3.2 1.2 2.4-1.1 2.1 2.8 5.3-2.8 6.9 3.1 4.3 1.2 4.6 3.2 2.7-1.1 6.2 3.7 7.1 3.1 8.8 3.8-.9 4-5.7 7.4 1.5 3.7 4.6 1.6-5.1 6.3.3 1 1.3 1.5-7.6-.2-3.4 2.1-5.6 9.5-1.9 5.1.1 5.4 3.3.3 1.9z",
    br: "M659 560.1l-1.4.2-3.1-.5-1.8 1.7-2.6 1.1-1.7.2-.7 1.3-2.7-.3-3.5-3-.3-2.9-1.4-3.3 1-5.4 1.6-2.2-1.2-3-1.9-.9.8-2.8-1.3-1.5-2.9.3.7 1.8-2.1 2.4-6.4 2.4-4 1-1.7 1.5-4.4-1.6-4.2-.8-1 .6 2.4 1.6-.3 4.3.7 4 4.8.5.3 1.4-4.1 1.8-.7 2.7-2.3 1-4.2 1.5-1.1 1.9-4.4.5-3-3.4-1.1.8-1-3.8-1.6-2-1.9 2.2-10.9-.1v3.9l3.3.7-.2 2.4-1.1-.6-3.2 1v4.6l2.5 2.4.9 3.6-.1 2.8-2.2 17.4-5.1-.3-.7 1-4.6 1.2-6.2 4.3-.4 3-1.3 2.2.7 3.4-3.3 1.9.1 2.7-1.5 1.1 2.6 5.8 3.3 3.8-1 2.8 3.7.3 2.3 3.4 4.9.2 4.4-3.8.2 9.7 2.6.7 3-1.1 4.2.6 2.9-.2 1.1-1.9 4.8-2.6 2.8-2.3 7.3-1.1-.4 4.7.9 2.5-.3 4.3 6.4 5.7 6.3 1 2.4 2.4 3.8 1.2 2.5 1.9 3.5-.1 3.3 1.9.5 3.7 1.2 1.8.3 2.8-1.6.1 2.7 7.4 10.7.3-.6 3.6.8 2.6 3.2 1.7 1.6 4-.5 5-1.3 2.8.8 3.6-1.6 1.3 1.9 3.6.4 8.6 6 1.2 2.1-1.2 3.9 1.7 1.2 1.9 1 5.8.9 2.5 2 .3 2-1.1 2.1 1.2.3 3.5-.3 3.8-.7 3.6 2.6-1.2 3.1 3.7.5 5.1-4.2 3.5-3.3 2.6-5.3 6.2-5.9 8.6 3.4-.7 6.2 4.9 1.9-.2 6.2 4.1 4.8 3.5 3.8 4.3-1.9 3 2.1 3.7 2.9-3.7 1.5-6 3.2-3 3.9-5 4.5-11.2 3.4-3.5.8-3.1.3-6.4-1.3-3.5.3-4.8 4.1-6.3 6-5.1 6-1.8 3.6-2.9 8.5-2.4h5.9l1.1-3.8 4.2-2.8.6-6.5 5.1-8.3.5-8.5 1.6-2.6.3-4.1 1.1-9.9-1-11.9 1.4-4.7 1.4-.1 3.9-5.5 3.3-7.2 7.7-8.8 2.7-4.2 2-10.5-1-3.9-2-8.1-2.1-2-4.8-.2-4.3-1.9-7.3-7.1-8.4-5.3-8.4.3-10.9-3.4-6.5 2 .8-3.5-2.7-3.8-9.4-3.8-7.1-2.3-4.2 4.1-.3-6.3-9.9-1-1.7-2 4.2-5.2-.1-4.4-3-1-3-11.2-1.3-3.5-1.9.3-3.5 5.8-1.8 4.7-2.1 2.4-2.7.5-.8-1.8-1.2-.3-1.8 1.8-2.4-1.3-3.2-1.4-2.7.7-2.3-.6-.5 1.8.9 1.3-.5 1.3-3.1-.5z",
    bs: "M574.4 437.3l.2-.6-.3-.1-.5.7-.6.3h-.3l-.7-.3h-.5l-.4.5-.6.1.1.1v.2l-.2.3v.2l.1.3 1.5-.1 1.3-.2.7-.9.2-.5zm.8-2l-.4-.3-.4.3.1.3.7-.3zm0-5.8l-.4-.2-.3.5.3.1.7-.1.5.1.5.4.3-.2-.1-.1-.4-.3-.6-.1h-.2l-.3-.1zm-6.6 1.3l.7-.6.7-.3.9-1.1-.1-.9.2-.4-.6.1-.1.3-.1.3.3.4v.2l-.2.4-.3.1-.1.2-.3.1-.4.5-.8.6-.2.3.4-.2zm1.2-3.2l-.6-.2-.2-.4-.4-.1-.1.2v.2l.1.4.2-.1.8.4.4-.3-.2-.1zm-4.1-1.1v-.7l-.4-.5-.6-.4-.1-1.2-.3-.7-.2-.6-.4-.8v.5l.1.1.1.6.4.9.1.4-.1.4-.4.1-.1.2.5.3.8.3.5 1.3.1-.2zm-4.1-3.5l-.5-.3-.2-.3-.7-.7-.3-.1-.2.4.4.1.9.7.4.2h.2zm7.3-4l-.1-.3h-.1l-.3.1-.3.9h.3l.5-.7zm-17.6-1.1l-.2-.3-.3.2h-.5l-.2.1h-.4l-.3.2.4.8.3.3.1 1 .2.1-.1.7 1.1.1.4-.8V418.6l-.3-.5-.4.6-.4-.3.6-.4v-.1zm12.9.3l-1-1.4v-.2l-.5-1.5-.3-.1-.1.1-.1.2.4.4v.4l.3.2.4 1.1.4.4-.1.3-.4.3-.1.2h.1l.6-.1h.4v-.3zm-10.5-5.2l.5-.2-.3-.2h-.7l-.4.1-.2.2.1.1.4.1.6-.1zm-2.4 2l-.5-.6-.3-.9-.2-.4.1-.5-.3-.4-.6-.4-.3.1.1 1.1-.2.6-.8 1.1.1.4.1.2-.5.4v-.3l-.6.1.3.5.6.4.3.1.3-.2v.5l.3.4.1.4.3-.3.6-.2.2-.2.7-.4v-.2l.1-.6.1-.7zm6.7-5l-.3-.5-.1.1-.1.4-.3.4.5-.1.4.1.6.5.7.2.3.6.6.6v.6l-.4.6-.1.7-.6.1.1.1.3.3.1.4.2.2v-.7l.3-.8.4-1.3-.1-.3-.3-.3-.7-.9-.7-.3-.8-.7zm-8.8-7.9l-.5-.4-.2.4v.1l-.1.3-.5.4-.5.1-.7-.6-.2-.1.8 1.1.3.1h.4l.9-.3 1.6-.5 1.7-.2.1-.2-.1-.3-.8.2-1-.1-.2.2h-.4l-.6-.2zm6.1 5.2l.2-.3.4-1.8.8-.6.1-1.2-.5-.5-.4-.2-.1-.2.1-.2-.2-.1-.3-.2-.4-.6-.4-.4-.7-.1-.6-.1-.4-.1-.5.3h.8l1.5.3.7 1.5.5.4.1.4-.2.4v.4l-.3.5-.1.8-.3.4-.7.5.4.2.3.6.2-.1z",
    bt: "M1474.7 395.5l-2.7-1.8-2.9-.1-4.2-1.5-2.6 1.6-2.6 4.8.3 1.2 5.5 2.5 3.2-1 4.7.4 4.4-.2-.4-3.9-2.7-2z",
    bw: "M1116.7 685l-1-.5-3.2 1.5h-1.6l-3.7 2.5-2-2.6-8.6 2.2-4.1.2-.9 22.7-5.4.2-.6 18.5 1.4 1 3 6.1-.7 3.8 1.1 2.3 4-.7 2.8-2.8 2.7-1.9 1.5-3.1 2.7-1.5 2.3.8 2.5 1.8 4.4.3 3.6-1.5.6-2 1.2-3 3-.5 1.7-2.4 2-4.3 5.2-4.7 8-4.7-3.4-2.9-4.2-.9-1.5-4.1.1-2.2-2.3-.7-6-7-1.6-3.7-1.1-1.1-1.9-5.1z",
    by: "M1112.8 219.4l-5.2-1.5-4.6 2.3-2.6 1 .9 2.6-3.5 2-.5 3.4-4.8 2.2h-4.6l.6 2.7 1.7 2.3.3 2.4-2.7 1.2 1.9 2.9.5 2.7 2.2-.3 2.4-1.6 3.7-.2 5 .5 5.6 1.5 3.8.1 2 .9 1.6-1.1 1.5 1.5 4.3-.3 2 .6-.2-3.1 1.2-1.4 4.1-.3-2-3.9-1.5-2 .8-.6 3.9.2 1.6-1.3-1.7-1.6-3.4-1.1.1-1.1-2.2-1.1-3.7-3.9.6-1.6-1-2.9-4.8-1.4-2.3.7-1-1.4z",
    bz: "M482.5 471.1l1.4-2.2 1-.2 1.3-1.7 1-3.2-.3-.6.9-2.3-.4-1 1.3-2.7.3-1.8h-1.1l.1-.9h-1l-2.5 3.9-.9-.8-.7.3-.1 1-.7 5-1.2 7.2h1.6z",
    ca: "M659 276.7l-.7-3-2.5 1.9.5 2.1 5.6 2.6 1.9-.4 3.3-2.5-4.7.1-3.4-.8zm14.4-15.9l.2-1.1-4.1-2.6-5.9-1.6-1.9.6 3.5 2.9 5.7 1.9 2.5-.1zm-305.3 3.7l.2-3.4-3.2-2.6-.4-2.9-.1-2.1-4.1-.7-2.4-.9-4.1-1.4-1.4 1.5-.6 3.3 4.3 1.1-.4 1.8 2.9 2.2v2.2l6.3 2.8 3-.9zM704.2 251l3.9-3.8 1.4-1.7-2.1-.3-4.9 2.2-4.2 3.5-8.1 9.8-5.3 3.7 1.6 1.7-3.8 2.2.2 1.9 9.6.1 5.4-.3 4.4 1.5-4.4 2.9 2.9.2 7.3-5.4 1.2.8-2.5 5.1 3 1.2 2.3-.2 3.5-5.5-.5-3.9.3-3.3-3.7 1.1 2.8-4.6-4.3-1.9-2.7 1.5-3.9-1.7 2.4-2.1-2.9-1.3-3.8 2 4.9-5.4zm-356.8-21.2l-1.9 2-1.4 2.6.9 1.9-.6 2.8.7 2.8h1.9l-.2-4.9 7.1-6.9-4.9.5-1.6-.8zm280.9-47l-.4-1.2-1.7-.1-2.8 1.7-.4.4.1 1.7 1.7.5 3.5-3zm-9.6-3.2l.8-1.1-6-.1-4.9 2.7v1.5l3 .2 7.1-3.2zm-3.1-16.6l-2.7-.5-5 5.2-3.6 4.4-5.7 2.8 6.3-.6-.8 3.4 8.2-3 6.2-3 .8 2.6 5.9 1.3 4.9-1.8-1.9-1.8-3.4.4 1.3-2.7-3.7-1.7-3.4-1.9-1.5-1.5-2.8.9.9-2.5zm44.6-8.2l3.7-1.7 1-.7 1.4-2.3-2.3-1.5-4.2.7-3.8 3.1-.7 2.6 4.9-.2zm-73.8-10.7l-.8-2-.3-1-1.6-1-3-1.5-4.9 2.3-5 1.7 3.5 2.4 3.8-.6 4.1 1.6 4.2-1.9zm22.4-2.1l-6.6-1 5.7-2.6-.4-6-1.9-2.3-4.5-.8-8.1 3.8-5.5 5.8 2.9 2.1 1.6 3.3-6.3 5.5-3.2-.2-6.2 4.4 4.2-5.2-4.8-1.8-4.5.9-2.4 3.4-5.9-.1-7.2.8-5.1-2.4-5 .4-1.5-2.9-2.1-1.3-3.8.5-5.2.3-4.4 1.8 2 2.3-7 2.8-1.4-3.3-4.4 1-11.8.6-6.4-1.2 8.5-2.6-2.8-2.8-4.4.4-4.7-1-7.5-1.9-3.8-2.3-4.5-.3-3.3 1.6-5.9.9 3.9-4.1-9.4 3.6-1.4-4.7-2.1-.6-3.8 2.5-4.5 1.2-.2-2.2-8.2 1.4-8.8 2.3-5.2-.6-7 1.6-6.2 2.3-3.7-.5-3.3-2.6-5.9-1.3-24.3 20.2-35.4 32.4 4.2.1 2.7 1.6.6 2.6.2 3.9 7.6-3.3 6.4-1.9-.5 3 .7 2.4 1.7 2.7-1.1 4.2-1.5 6.8 4.6 3.8-3.1 3.7-5.1 2.9-2.5 3.1 2.1 4.4-3.1 4.9 4.1 2.6-3.6 3.7-1.3 5.5 6.9 2.5 1.6 2.7 5.4 6.1h136.6l1.3-2.4h1.6l-.8 3.4 1 1 3.2.4 4.6 1 3.8 1.9 4.4-.8 5.3 1.6 3.2-2.4 3.2-1 1.8-1.5 1.5-.8 4 1.2 3.3.2.8.8.1 3.5 5.2 1-1.7 1.7 1.2 1.9-1.9 2.3 1.8.8-1.9 2.1 1.2.2 1.3-.9.5 1.4 3.4.7 3.8.1 3.8.6 4 1.2.8 2 1.4 4.7-2.4 2-3.8-.8-1-3.8-.9 3.9-3.8 3.4-.8 2.9-1.1 1.7-4.1 2-3.7 3.4-2 2.2 2.7.4 4.5-2 2.9-1.7 1.6-.3 2.6.6 1.7-.9 2.8-.8 4.7-.8.3-1.8-.3.1-1.7.3-1.8-.6 2.3-2.1 1.9-.7 3.9-.9 4.6-.9 1.8 1.2 1.9-1.4 1.9-.8.9.4.1.1 6.7-4.2 2.7-1.2h17l1-1.6 1.7-.3 2.5-.9 2.7-2.8 3.2-4.9 5.5-4.7 1.1 1.7 3.7-1.1 1.5 1.8-2.8 8.5 2.1 3.5 5.9-.8 8.1-.2-10.4 5.1-1.5 5.2 3.7.5 7.1-4.5 5.8-2.4 12.2-3.7 7.5-4.1-2.6-2.2 1-4.5-7.1 7-8.6.8-5.5-3.1-.1-4.6.6-6.8 6.1-4.1-3.3-3.1-7.6.6-12.1 5.2-10.9 8.2-4.6 1 7.8-5.7 10.1-8.3 7.2-2.7 5.7-4.4 5.2-.5 7.3.1 10 1.3 8.6-1 7.8-5.1 8.7-2.2 4.2-2.1 4.2-2.3 2-6.8-1.1-2.3-3.4-.8v-5.1l-2.3-1.9-6.9-1.6-2.8-3.4-4.8-3.4 3.4-3.7-2-7.1-2.6-7.5-1-5.2-4.3 2.7-7.4 6.5-8.1 3.2-1.6-3.4-3.7-1 2.2-7.3 2.6-4.9-7.7-.5-.1-2.2-3.6-3.3-3-2-4.5 1.5-4.2-.5-6.6-1.6-3.9 1.3-3.8 9-1 5.3-8.8 6.1 3.1 4.5.5 5-1.7 4-4.7 4.1-7.5 4.2-9 2.8 1.7 3.2-2.2 9.6-5.6 6.3-4.6 1.9-4.4-5.8-.1-6.8 1.7-6 3.6-5.2-4.8-.6-7.5-.4-3.6-2.5-4.8-1.6-1.7-2.9-3.3-2.2-7-2.6-7.1 1.2.7-4.5 1.5-5.5-6-1 4.9-6.8 4.9-4.6 9.4-6.5 8.6-4.6 5.6-.7 2.9-3.7 5.1-2.4 6.4-.4 7.7-3.8 2.9-2.4 7.4-4.7 3.2-2.8 3.2 1.7 6.5-.9L637 155l2.3-2.7-.8-2.9 5-2.9 1.7-2.7-3.5-2.6-5.4-.8-5.5-.4-4.6 5.9-6.5 4.6-7.2 4-1.3-3.7 4.2-4-2.2-3.5-8.7 4.2 4.3-5.5zm-75.5-18.9l-2.8-1-14.1 3.2-5.1 2-7.8 3.9 5.4 1.4 6.2-.1-11.5 2.1v1.9l5.6.1 9-.4 6.5 1.2-6.2 1-5.5-.3-7.1.9-3.3.6.6 4.2 4.2-.6 4.1 1.5-.3 2.5 7.8-.5 11.2-.8 9.4-1.8 5-.4 5.7 1.5 6.7.8 3.1-1.9-.7-2.1 7-.4 2.6-2.4-5-2.5-4.2-2.6 2.4-3.6 2.7-5.1-2.2-2-3-.9-4.2.8-2.8 5.3-4.3 2.1 2.2-5.1-1.7-1.7-7.3 2.7-2.6-2.6-10.4 1.5 4.7-2.4zm39.1-1.5l-1.7-1.1-5.4.2-2.1.7 2.2 3.6 7-3.4zm107.7 1.6l-4.4-2.8-8.4-.5-2.1.3-1.7 1.8 2 2.8.9.3 4.8-.7 4.1.1 4.1.1.7-1.4zm-39.4-.3l5.7-3.2-11.2 1.3-5.8 2.1-7.1 4.6-3.3 5.2 5.6.1-6.1 2.3 1.8 1.9 5.9.8 7.3 1.5 13.8 1.2 7.9-.6 3.2-1.6 2 1.8 3.3.3 2 3.3-3.5 1.4 7.1 1.8 4.6 2.6.5 1.9-.4 2.4-8.6 5.4-3.2 2.7.2 2-9.2.7-8 .1-5.4 4.2 2.4 1.9 13-.9.9-1.6 4.7 2.7 4.7 2.9-2.4 1.6 3.8 2.8 7.6 3.3 10.7 2.3.3-2-2.8-3.5-3.5-4.9 8.5 4.6 4.7 1.5 3.6-4.1v-5.6l-1-1.5-4.4-2.5-2.7-3.3 2.3-3.2 5.8-.7 3.8 5.4 4 2.4 10.7-6.5 3.3-3.9-6.4-.3-3.2-5.1-5.9-1.2-7.7-3.5 9-2.5-.8-5-2.2-2.1-8.3-2.1-1.9-3.3-8.2 1.2 1.1-2.3-3.6-2.5-6.8-2.6-5.2 2.1-9 1.5 3.3-3.4-2.3-5.3-11.6 2.1-7.1 4.1-.3-3.2zm-50-3.4l-7.1 2.4.9 3.4-7.4-.7-1.7 1.7 5.8 3.9.9 2 3.4.5 8.4-2 5.1-4.7-3.8-2.2 6-2.4.5-1.5-7.5.6-3.5-1zm22.3 5.4l5.6-1 10-4.5-6.1-1.2-7.8-.2-5.2 1.4-4.2 2.1-2.5 2.6-1.8 4.5 4.3.2 7.7-3.9zm-114.7 7.2l2.6-2.3 9.1-3.6 13.8-3.6 6.4-1.3-1.6-2.1-1.9-1.5-9.4-.2-4.1-1.1-14 .8-.3 3.1-7.6 3.3-7.4 3.8-4.3 2.2 5.9 2.7-.6 2.3 13.4-2.5zm124.1-18.3l.3-1.6-1.4-1.7-6.9 1.3-4.4 2.2 3.2 1.3 5.1.4 4.1-1.9zm-8.7-8.6l-1.1.7-4.8-.3-7.6 1.6-3.8-.1-4.3 3.8 6.6-.4-3.4 2.9 3.2.8 6.8-.5 5.8-3.7 2.8-2.5-.2-2.3zm-39.1 2.5l1.8-2.3-3.1-.5-5.7 1.7-.7 4.7-6.1-.4-2.8-2.9-8.2-1.6-5.4 1.4-11.6 4.8 4.1.8 17.8-.5-10.6 2.2-1.5 1.6 5.9-.1 12.2-2.2 13.8-.8 5.1-2.3 2.3-2.4-3.7-.2-4.3.8.7-1.8zm55.2-4.3l-7.1-.3-3.8 2 2.6 1.5 7 .6 1.4 2.1-2.2 2.4-1.5 2.8 8.5 1.6 5.5.6 8-.1 11.6-.8 4.3.6 6.7-1 3.5-1.4 1-2-2.3-1.9-5.8-.3-8 .4-7 1.1-5.1-.4-4.8-.3-1.2-1.1-3.1-1.1 2.8-1.9-1.4-1.6-7.3.1-2.3-1.6zm-75-2.6l-6 .7-5.5-.1-12.1 3.1-11.6 3.7 3.6 1 7-.7 9.8-2.1 3.8-.3 5.2-1.6 5.8-3.7zm80.5.6l1-.5-1.5-.9-7.2-.1-.6 1.3 6.4.3 1.9-.1zm-58.4-.8l3.2-1.4-4.1-.8-5.9.5-5.1 1.5 3.3 1.5 8.6-1.3zm7.8-4.2l-3.3-.9-1.6-.2-5.7 1.3-1 .7h6l5.6-.9zm46.4 2.5l3-1.7-2.3-1.6-1.7-.3-4.4-.1-2.1 1.8-.7 1.8 1.6 1.1 6.6-1zm-13.7-1.2l.1-2.2-7.4-1.7-6.1-.6-2.1 1.7 2.8 1.1-5.3 1.4 7.7.2 4 1.5 5.2.5 1.1-1.9zm53.7-6.1l.6-2.8-4.7-.8-4.7-.9-1.6-2.2-8.2.2.3.9-3.9.3-4.1 1.3-4.9 1.9-.3 1.9 2 1.5h6.5l-4.3 1.2-2.1 1.6 1.6 1.9 6.7.6 6.8-.4 10.5-3.4 6.4-1.3-2.6-1.5zm78.5-13.8l-7-.2-6.9-.3-10.2.6-1.4-.4-10.3.2-6.4.4-5.1.6-5 2-2.3-1-3.9-.2-6.7 1.4-7.4.6-4.1.1-6 .8-1.1 1.3 2.5 1.2.8 1.6 4.4 1.5 12.4-.3 7.2.5-7.2 1.5-2.2-.4-9.3-.2-1.1 2.2 3 1.7-2.8 1.6-7.5 1.1-4.9 1.7 4.8.9 1.7 3-7.5-2-2.5.3-2 3.4-8 1.1-2 2.3 6.7.3 4.9.6 11.7-.8 8.4 1.4 12.6-3 1-1.1-6.4.2.5-1.1 6.5-1.4 3.6-1.9 6.8-1.3 5-1.6-.8-2.2 3.3-.8-4.3-.6 11.1-.4 3.2-.9 7.9-.8 9.3-3.5 6.8-1.1 10.3-2.5h-7.4l3.9-.9 9-.8 9.7-1.6 1.1-1.1-5.2-1-6.7-.4-8.5-.3z",
    cd: "M1124.9 539.4l-4.3-.7-2 .6-.9 1.5-1.8.2-2.2-1.3-6.2 3.1-2.6-.6-.8.5-1.6 3.8-4.2-1.2-4.1-.6-3.6-2.4-4.6-2.1-3 2-2.2 3.2-.5 4.5-.3 3.8-1.6 3.4-1.1 4-.7 5.6.3 3.6-.9 2.2-.2 2.4-.6 2-3.7 3.1-2.6 3.2-2.5 6.2.2 5.3-1.4 2-3.3 3.1-3.4 4-2-1.1-.4-1.8-3.1-.1-1.9 2.4-1.5-.6-2 1.3-.9 1.7-.2 2.7-1.5.7.8 2 2.3-.9 1.7.1 1.9-.7 16.6.1 1.3 4.7 1.6 3.8 1.3 2.1 2.1 3.3 3.7-.5 1.9-.9 3 .9.9-1.6 1.5-3.7 3.4-.3.3-1.1h2.9l-.5 2.3h6.8v4l1.2 2.4-.9 3.8.3 4 1.9 2.3-.5 7.6 1.4-.6 2.4.2 3.5-1 2.6.4 1.9.1.3 2 2.6-.1 3.5.6 1.8 2.8 4.5.9 3.4-2 1.2 3.4 4.3.8 2 2.8 2.1 3.5h4.3l-.3-6.9-1.5 1.2-3.9-2.5-1.4-1.1.8-6.4 1.2-7.5-1.2-2.8 1.6-4.1 1.6-.7 7.5-1.1 1 .3.2-1.1-1.5-1.7-.7-3.5-3.4-3.5-1.8-4.5 1-2.7-1.5-3.6 1.1-10.2.1.1-.1-1.1-1.4-2.9.6-3.5.8-.4.2-3.8 1.6-1.8.1-4.8 1.3-2.4.3-5.1 1.2-3 2.1-3.3 2.2-1.7 1.8-2.3-2.3-.8.3-7.5-5-4.2-1.4-2.7-3.1 1.3-2.6-.4-1.5 1.1-2.5-.8-3.5-5.2-1.8.6-3.6-.1z",
    cf: "M1110.5 517.3l-.5-.3-2-1.8-.3-2 .8-2.6V508l-3.3-4-.7-2.7-3.5 1.1-2.8 2.5-4 7-5.2 2.9-5.4-.4-1.6.6.6 2.3-2.9 2.2-2.3 2.5-7.1 2.4-1.4-1.4-.9-.2-1 1.7-4.7.4-2.7 6.5-1.4 1.1-.4 5 .6 2.7-.4 1.9 2.6 3.3.5 2.3 2.1 3.2 2.6 2.1.3 2.9.6 1.8 2.9-5.9 3.3-3.4 3.8 1.1 3.6.4.5-4.5 2.2-3.2 3-2 4.6 2.1 3.6 2.4 4.1.6 4.2 1.2 1.6-3.8.8-.5 2.6.6 6.2-3.1 2.2 1.3 1.8-.2.9-1.5 2-.6 4.3.7 3.6.1 1.8-.6-.9-2.1-4.2-2.5-1.5-3.8-2.4-2.7-3.8-3.4-.1-2-3.1-2.6-3.8-2.5z",
    cg: "M1080.3 549.9l-3.6-.4-3.8-1.1-3.3 3.4-2.9 5.9-.4 3.5-4.5-1.5-4.5-1.7-7.1-.3-.4 2.8 1.5 3.3 4.2-.5 1.4 1.2-2.4 7.4 2.7 3.8.6 4.9-.8 4.3-1.7 3-4.9-.3-3-3-.5 2.8-3.8.8-1.9 1.6 2.1 4.2-4.3 3.5 4.6 6.7 2.2-2.7 1.8-1.1 2 2.2 1.5.6 1.9-2.4 3.1.1.4 1.8 2 1.1 3.4-4 3.3-3.1 1.4-2-.2-5.3 2.5-6.2 2.6-3.2 3.7-3.1.6-2 .2-2.4.9-2.2-.3-3.6.7-5.6 1.1-4 1.6-3.4.3-3.8z",
    ch: "M1024.3 270.6l-5.4-1.9-1 1.4h-4.2l-1.3 1-2.3-.6.2 1.6-3.5 3.5v2.8l2.4-.9 1.8 2.7 2.2 1.3 2.4-.3 2.7-2.1.9 1 2.4-.2.9-2.5 3.8.8 2.1-1.1.3-2.5-2.6-.2-2.3-1.1.7-1.6-.2-1.1z",
    ci: "M946.5 506.2l-2.3.9-1.3.8-.9-2.7-1.6.7-1-.1-1 1.9-4.3-.1-1.6-1-.7.6-1.1.5-.5 2.2 1.3 2.6 1.3 5.1-2 .8-.6.9.4 1.2-.3 2.8h-.9l-.3 1.8.6 3.1-1.2 2.8 1.6 1.8 1.8.4 2.3 2.7.2 2.5-.5.8-.5 5.2 1.1.2 5.6-2.4 3.9-1.8 6.6-1.1 3.6-.1 3.9 1.3 2.6-.1.2-2.5-2.4-5.5 1.5-7.2 2.3-5.3-1.4-9.1-3.8-1.6-2.7.2-1.9 1.6-2.5-1.3-1-2.1-2.5-1.4z",
    cl: "M648.4 905.2l-3.7-.7-3.3 2.5.2 4.1-1.2 2.8-7.2-2.2-8.6-4-4.5-1.3 9.7 6.8 6.3 3.2 7.5 3.4 5.3.9 4.3 1.8 3 .5 2.3.1 3.2-1.8.5-2.4-2.9-.2h-5l-5.9-13.5zm-47.3-196.3l-3.7-7.1 1.1-6.2-3.2-2.7-1.2-4.6-3.1-4.3-1.2 3.3-2.7 1.6 2.1 9 1.5 10.4-.1 14.2v13.2l.9 12.3-1.9 7.8 2.1 7.8-.5 5.3 3.2 9.5-.1 9.5-1.2 10.2-.6 10.5-2.1.2 2.4 7.3 3.3 6.3-1.1 4.3 1.9 11.6 1.5 8.8 3.5.9-1.1-7.7 4 1.6 1.8 12.7-6.4-2.1 2 10.2-2.7 5.5 8.2 1.8-3.4 4.8.2 6 5 10.6 4.2 4.1.2 3.6 3.3 3.8 7.5 3.5 7.4 4.2 6.2 2 2-.1-1.8-5.7 3.4-2.2 1.7-1.5h4.2l-4.8-.9-12-.8-3.5-3.6-1.8-4.6-3.1.4-2.6-2.2-3.1-6.6 2.7-2.7.1-3.9-1.8-3.2.7-5.3-1.1-8.2-1.8-3.7 1.8-1.1-1.3-2.3-2.8-1.3.8-2.6-3.1-2.3-3.6-7.1 1.6-1.2-3.3-7.6-.7-6.4-.3-5.7 2.5-2.4-3.3-6.3-1.5-5.9 2.9-4.3-1.4-5.4 1.6-6.2-1.3-5.9-1.6-1.2-4.9-10.9 2.1-6.5-1.7-6.2.9-5.8 2.6-5.9 3.2-4-2-2.5.9-2-1.6-10.6 5.6-3.2 1.1-6.6-.9-1.6-3.8.9-3.1-8.8z",
    cm: "M1060.1 502.9l.2-4.3-.5-4.2-2.2-4.1-1.6.4-.2 2 2.3 2.6-.6 1.1-.3 2.1-4.6 5-1.5 4-.7 3.3-1.2 1.4-1.1 4.5-3 2.6-.8 3.2-1.2 2.6-.5 2.6-3.9 2.2-3.2-2.6-2.1.1-3.3 3.7-1.6.1-2.7 6.1-1.4 4.5v1.8l1.4.9 1.1 2.8 2.6 1.1 2.2 4.2-.8 5 9.2.2 2.6-.4 3.4.8 3.4-.8.7.3 7.1.3 4.5 1.7 4.5 1.5.4-3.5-.6-1.8-.3-2.9-2.6-2.1-2.1-3.2-.5-2.3-2.6-3.3.4-1.9-.6-2.7.4-5 1.4-1.1 2.7-6.5.9-1.7-1.8-4.4-.8-2.6-2.5-1.1-3.3-3.7 1.2-3 2.5.6 1.6-.4 3.1.1-3.1-5.8z",
    cn: "M1587.2 453.3l.6-3.6 2-2.8-1.6-2.5-3.2-.1-5.8 1.8-2.2 2.8 1 5.5 4.9 2 4.3-3.1zm13.2-196.5l-6.1-6.1-4.4-3.7-3.8-2.7-7.7-6.1-5.9-2.3-8.5-1.8-6.2.2-5.1 1.1-1.7 3 3.7 1.5 2.5 3.3-1.2 2 .1 6.5 1.9 2.7-4.4 3.9-7.3-2.3.6 4.6.3 6.2 2.7 2.6 2.4-.8 5.4 1 2.5-2.3 5.1 2 7.2 4.3.7 2.2-4.3-.7-6.8.8-2.4 1.8-1.4 4.1-6.3 2.4-3.1 3.3-5.9-1.3-3.2-.5-.4 4 2.9 2.3 1.9 2.1-2.5 2-1.9 3.3-4.9 2.2-7.5.2-7.2 2.2-4.4 3.3-3.2-2-6.2.1-9.3-3.8-5.5-.9-6.4.8-11.2-1.3-5.5.1-4.7-3.6-4.9-5.7-3.4-.7-7.9-3.8-7.2-.9-6.4-1-3-2.7-1.3-7.3-5.8-5-8.1-2.3-5.7-3.3-3.3-4.4-1.7.5-1.8 4.2-3.8.6 2.5 6.2-1.6 2.8-10.7-2 1 11.1-2 1.4-9 2.4 8.7 10.7-2.9 1.6 1.7 3.5-.2 1.4-6.8 3.4-1 2.4-6.4.8-.6 4-5.7-.9-3.2 1.2-4 3 1.1 1.5-1 1.5 3 5.9 1.6-.6 3.5 1.4.6 2.5 1.8 3.7 1.4 1.9 4.7 3 2.9 5 9.4 2.6 7.6 7.5.8 5.2 3 3.3.6 3.3-4.1-.9 3.2 7 6.2 4 8.5 4.4 1.9-1.5 4.7 2 6.4 4.1 3.2.9 2.5 3.1 4.5 1.2 5 2.8 6.4 1.5 6.5.6 3-1.4 1.5 5.1 2.6-4.8 2.6-1.6 4.2 1.5 2.9.1 2.7 1.8 4.2-.8 3.9-4.8 5.3-4 4.9 1.5 3.2-2.6 3.5 3.9-1.2 2.7 6.1.9 3-.4 2.7 3.7 2.7 1.5 1.3 4.9.8 5.3-4.1 5.3.7 7.5 5.6-1 2.3 5.8 3.7 1.3-.8 5.2 4.5 2.4 2.5 1.2 3.8-1.8.6 2.6.7 1.5 2.9.1-1.9-7.2 2.7-1 2.7-1.5h4.3l5.3-.7 4.1-3.4 3 2.4 5.2 1.1-.2 3.7 3 2.6 5.9 1.6 2.4-1 7.7 2-.9 2.5 2.2 4.6 3-.4.8-6.7 5.6-.9 7.2-3.2 2.5-3.2 2.3 2.1 2.8-2.9 6.1-.7 6.6-5.3 6.3-5.9 3.3-7.6 2.3-8.4 2.1-6.9 2.8-.5-.1-5.1-.8-5.1-3.8-2-2.5-3.4 2.8-1.7-1.6-4.7-5.4-4.9-5.4-5.8-4.6-6.3-7.1-3.5.9-4.6 3.8-3.2 1-3.5 6.7-1.8-2.4-3.4-3.4-.2-5.8-2.5-3.9 4.6-4.9-1.9-1.5-2.9-4.7-1-4.7-4.4 1.2-3 5-.3 1.2-4.1 3.6-4.4 3.4-2.2 4.4 3.3-1.9 4.2 2.3 2.5-1.4 3 4.8-1.8 2.4-2.9 6.3-1.9 2.1-4 3.8-3.4 1-4.4 3.6 2 4.6.2-2.7-3.3 6.3-2.6-.1-3.5 5.5 3.6-1.9-3.1 2.5-.1-3.8-7.3-4.7-5.3 2.9-2.2 6.8 1.1-.6-6-2.8-6.8.4-2.3-1.3-5.6-6.9 1.8-2.6 2.5h-7.5l-6-5.8-8.9-4.5-9.9-1.9z",
    co: "M578.3 497.2l1.2-2.1-1.3-1.7-2-.4-2.9 3.1-2.3 1.4-4.6 3.2-4.3-.5-.5 1.3-3.6.1-3.3 3-1.4 5.4-.1 2.1-2.4.7-4.4 4.4-2.9-.2-.7.9 1.1 3.8-1.1 1.9-1.8-.5-.9 3.1 2.2 3.4.6 5.4-1.2 1.6 1.1 5.9-1.2 3.7 2 1.5-2.2 3.3-2.5 4-2.8.4-1.4 2.3.2 3.2-2.1.5.8 2 5.6 3.6 1-.1 1.4 2.7 4.7.9 1.6-1 2.8 2.1 2.4 1.5 1.5-.6 3.7 3 1.8 3 2.7 1.7 3.4 6.7 4.2.8 3-1.7 2.1 1.1 3.3-.6 4.4 3-3.5 6.5 1.7.1 2.9 3.4 2.2-17.4.1-2.8-.9-3.6-2.5-2.4v-4.6l3.2-1 1.1.6.2-2.4-3.3-.7v-3.9l10.9.1 1.9-2.2 1.6 2 1 3.8 1.1-.8-1.7-6.4-1.4-2.2-2-1.4 2.9-3.1-.2-1.5-1.5-1.9-1-4.2.5-4.6 1.3-2.1 1.2-3.4-2-1.1-3.2.7-4-.3-2.3.7-3.8-5.5-3.2-.8-7.2.6-1.3-2.2-1.3-.6-.2-1.3.8-2.4-.4-2.5-1.1-1.4-.6-2.9-2.9-.5 1.8-3.7.9-4.5 1.8-2.4 2.2-1.8 1.6-3.2 3.7-1.1z",
    cr: "M509.1 502.6l-1.4 1.3-1.7-.4-.8-1.3-1.7-.5-1.4.8-3.5-1.7-.9.8-1.4 1.2 1.5.9-.9 2-.1 2 .7 1.3 1.7.6 1.2 1.8 1.2-1.6-.3-1.8 1.4 1.1.3 1.9 1.9.8 2.1 1.3 1.5 1.5.1 1.4-.7 1.1 1.1 1.3 2.9 1.4.4-1.2.5-1.3-.1-1.2.8-.7-1.1-1 .1-2.5 2.2-.6-2.4-2.7-2-2.6-1.2-3.4z",
    cu: "M539 427.3l-4.9-2.1-4.3-.1-4.7-.5-1.4.7-4.2.6-3 1.3-2.7 1.4-1.5 2.3-3.1 2 2.2.6 2.9-.7.9-1.6 2.3-.1 4.4-3.3 5.4.3-2.3 1.6 1.8 1.3 7 1 1.5 1.3 4.9 1.7 3.2-.2.8 3.6 1.7 1.8 3.5.4 2.1 1.7-4.1 3.5 7.9-.6 3.8.5 3.7-.3 3.8-.8.8-1.5-3.9-2.6-4-.3.6-1.7-3.1-1.3h-1.9l-3-2.8-4.2-4-1.8-1.5-5.2.8-1.9-2.4z",
    cv: "M841.4 477.6l.1-.4-.2-.6-.3-.1-.6.4-.1.3.1.3.3.3.3.1.4-.3zm6.3-1.7l.4-.2v-.7l-.1-.3h-.4l-.2.4v.5l.2.3h.1zm-1.4.8l-.5-.9-.3-.1-.6-.7v-.3l-.3-.1V475.2l-.2.5v.5l.4.8.4.2.7.1.4-.6zm3.1-7.8v.5l-.3.7.5.3.3.1.6-.4.2-.5-.1-.3-.3-.3-.3-.1-.1.1-.5-.1zm-6.4-2.5l-1-.1-.6-.2h-.1v.3l.4.8.2-.5.2-.1.8.2.4-.1-.1-.1-.2-.2zm6.7-.2l-.1-.5v-.7h-.2l-.3.2.1.7.1.1.2.5.2-.3zm-11.1-1v-.2l-.3-.5-.3.1-.4.2-.1.3.4.2h.2l.5-.1zm-1.5-.9l.8-.6.2-.3-.2-.5-.5-.1-1.2.6-.1.2.1.3.1.5.2.1.6-.2z",
    cw: "M595.9 494.9v-.6l-.9-.4v.3l.1.2.3.1.1.2-.1.6.2.3.3-.7z",
    cy: "M1149.9 348.4l-.3-.1-.5.2-.4.4-.4.3-.5-.3.2.9.6 1.1.2.3.3.2 1.1.3H1151.1l.2.1.2.4h.4v-.4l.2-.2.3-.2h.3l.6-.1.6-.2.5-.4.9-1h1.2l.6-.1-.2-.4-.1-.1-.4-.5-.2-.4.1-.6 2.5-1.9.5-.5-.8.2-.6.4-.4.2-.7.4-2.3.8-.8.1h-.8l-1-.1-.9-.2v.7l-.2.6-.6.2-.3-.1z",
    cz: "M1049.4 248.5l-2.1.6-1.4-.7-1.1 1.2-3.4 1.2-1.7 1.5-3.4 1.3 1 1.9.7 2.6 2.6 1.5 2.9 2.6 3.8 2 2.6-2.5 1.7-.5 4 1.9 2.3-.3 2.3 1.2.6-1.4 2.2.1 1.6-.6.1-.6.9-.3.2-1.4 1.1-.3.6-1.1h1.5l-2.6-3.1-3.6-.3-.7-2-3.4-.6-.6 1.5-2.7-1.2.1-1.7-3.7-.6-2.4-1.9z",
    de: "M1043.6 232.3l-2.4-1.9-5.5-2.4-2.5 1.7-4.7 1.1-.1-2.1-4.9-1.4-.2-2.3-3 .9-3.6-.8.4 3.4 1.2 2.2-3 3-1-1.3-3.9.3-.9 1.3 1 2-1 5.6-1.1 2.3h-2.9l1.1 6.4-.4 4.2 1 1.4-.2 2.7 2.4 1.6 7.1 1.2-2.3 4.2-.5 4.5h4.2l1-1.4 5.4 1.9 1.5-.3 2.6 1.7.6-1.6 4.4.3 3.4-1.2 2.4.2 1.7 1.3.4-1.1-1-4 1.7-.8 1.5-2.9-2.9-2.6-2.6-1.5-.7-2.6-1-1.9 3.4-1.3 1.7-1.5 3.4-1.2 1.1-1.2 1.4.7 2.1-.6-2.3-3.9.1-2.1-1.4-3.3-2-2.2 1.2-1.6-1.4-3.1z",
    dj: "M1217.8 499.2l-2.5-1.7 3.1-1.5.1-2.7-1.4-1.9-1.6 1.5-2.4-.5-1.9 2.8-1.8 3 .5 1.7.2 2 3.1.1 1.3-.5 1.3 1.1 2-3.4z",
    dk: "M1035.9 221.2l-1.7-3-6.7 2 .9 2.5 5.1 3.4 2.4-4.9zm-8.6-5.1l-2.6-.9-.7-1.6 1.3-2-.1-3-3.6 1.6-1.5 1.7-4 .4-1.2 1.7-.7 1.6.4 6.1 2.1 3.4 3.6.8 3-.9-1.5-3 3.1-4.3 1.4.7 1-2.3z",
    dm: "M635.8 475.1l.3-.7-.1-1-.2-.4-.8-.3v.2l-.1.5.3.8.1 1.1.5-.2z",
    do: "M579.6 457.4v1.8l1.4 1 2.6-4.4 2-.9.6 1.6 2.2-.4 1.1-1.2 1.8.3 2.6-.2 2.5 1.3 2.3-2.6-2.5-2.3-2.4-.2.3-1.9-3 .1-.8-2.2-1.4.1-3.1-1.6-4.4-.1-.8 1.1.2 3.5-.7 2.4-1.5 1.1 1.2 1.9-.2 1.8z",
    dz: "M1021 336.9l-3.6.4-2.2-1.5h-5.6l-4.9 2.6-2.7-1-8.7.5-8.9 1.2-5 2-3.4 2.6-5.7 1.2-5.1 3.5 2 4.1.3 3.9 1.8 6.7 1.4 1.4-1 2.5-7 1-2.5 2.4-3.1.5-.3 4.7-6.3 2.5-2.1 3.2-4.4 1.7-5.4 1-8.9 4.7-.1 7.5v.4l-.1 1.2 20.3 15.5 18.4 13.9 18.6 13.8 1.3 3 3.4 1.8 2.6 1.1.1 4 6.1-.6 7.8-2.8 15.8-12.5 18.6-12.2-2.5-4-4.3-2.9-2.6 1.2-2-3.6-.2-2.7-3.4-4.7 2.1-2.6-.5-4 .6-3.5-.5-2.9.9-5.2-.4-3-1.9-5.6-2.6-11.3-3.4-2.6v-1.5l-4.5-3.8-.6-4.8 3.2-3.6 1.1-5.3-1-6.2 1-3.3z",
    ec: "M553.1 573.1l-2.4-1.5-2.8-2.1-1.6 1-4.7-.9-1.4-2.7-1 .1-5.6-3.6-3.9 2.5-3.1 1.4.4 2.6-2.2 4.1-1 3.9-1.9 1 1 5.8-1.1 1.8 3.4 2.7 2.1-2.9 1.3 2.8-2.9 4.7.7 2.7-1.5 1.5.2 2.3 2.3-.5 2.3.7 2.5 3.2 3.1-2.6.9-4.3 3.3-5.5 6.7-2.5 6-6.7 1.7-4.1-.8-4.9z",
    ee: "M1093.2 197.5l-5.5.9-5.4 1.6.9 3.4 3.3 2.1 1.5-.8.1 3.5 3.7-1 2.1.7 4.4 2.2h3.8l1.6-1.9-2.5-5.5 2.6-3.4-.9-1-4.6.2-5.1-1z",
    eg: "M1129.7 374.8l-5.5-1.9-5.3-1.7-7.1.2-1.8 3 1.1 2.7-1.2 3.9 2 5.1 1.3 22.7 1 23.4h65.3l-1-1.3-6.8-5.7-.4-4.2 1-1.1-5.3-7-2-3.6-2.3-3.5-4.8-9.9-3.9-6.4-2.8-6.7.5-.6 4.6 9.1 2.7 2.9 2 2 1.2-1.1 1.2-3.3.7-4.8 1.3-2.5-.7-1.7-3.9-9.2-2.5 1.6-4.2-.4-4.4-1.5-1.1 2.1-1.7-3.2-3.9-.8-4.7.6-2.1 1.8-3.9 2-2.6-1z",
    eh: "M929.6 396.2h-.8l.1 3.4-3.4.2-1.8 1.5h-2.5l-1.9-.9-4.6.7-1.9 5-1.7.4-2.8 8.1-7.8 6.8-2 8.8-2.3 2.9-.7 2.3-12.4.5h-.1l-.3 2.7 1.2-2.2 21.6.1-.9-9.2 1.4-3.3 5.2-.5.2-16.3 17.9.3.2-9.7.1-1.2v-.4z",
    er: "M1198.1 474l-3.2-3.1-1.8-5.9-3.7-7.3-2.6 3.6-4 1-1.6 2-.4 4.2-1.9 9.4.7 2.5 6.5 1.3 1.5-4.7 3.5 2.9 3.2-1.5 1.4 1.3 3.9.1 4.9 2.5 1.6 2.2 2.5 2.1 2.5 3.7 2 2.1 2.4.5 1.6-1.5-2.8-1.9-1.9-2.2-3.2-3.7-3.2-3.6-7.9-6z",
    es: "M985 325.7v-.2h-.5l-.3-.4-.1.2-.1.2v.2h.5l.4.1.1-.1zm-.8-1.6h.3l.6-.7v-.3l-.3-.2-1.1.2-.2.3v.3l-.3.1-.1.4.1.2.8.1.2-.4zM967 296l-8.2-.2-4.2.3-5.4-1h-6.8l-6.2-1.1-7.4 4.5 2 2.6-.4 4.4 1.9-1.6 2.1-.9 1.2 3.1h3l.9-.8 3 .2 1.3 3.1-2.4 1.7-.2 4.9-.9.9-.3 3-2.2.5 2 3.8-1.6 4.3 1.8 1.9-.8 1.7-2 2.5.4 2.1 4.8 1 1.4 3.7 2 2.2 2.5.6 2.1-2.5 3.3-2.3 5 .1h6.7l3.8-5 3.9-1.3 1.2-4.2 3-2.9-2-3.7 2-5.1 3.1-3.5.5-2.1 6.6-1.3 4.8-4.2-.3-3.5-6 .8-5.7-2.8-1.9 1.3-9.4-2.8-2-2.4zm26 22.6l.1-.3.1-.2.1-.1-.2-.2v-.1l.2-.2-.2-.1-1.3.4-.7.4-2.1 1.5v.3l.1.2h.4l.2.4.4-.4.3-.1.3.1.3.2.1.6.1.2.6.1.9.4.4-.2.5-.3.2-.6.3-.5.3-.5.3-.4-.1-.4-.3-.1-.3-.1-.5.2-.5-.2zm6-.3l.1-.4v-.1l-.5-.7-.9-.3-1 .1-.1.1v.4l.1.1.6.1 1.6.7h.1z",
    et: "M1187.6 477l-1.5 4.7-6.5-1.3-.7 5.5-2.1 6.2-3.2 3.2-2.3 4.8-.5 2.6-2.6 1.8-1.4 6.7v.7l.2 5-.8 2-3 .1-1.8 3.6 3.4.5 2.9 3.1 1 2.5 2.6 1.5 3.5 6.9 2.9 1.1v3.6l2 2.1h3.9l7.2 5.4h1.8l1.3-.1 1.2.7 3.8.5 1.6-2.7 5.1-2.6 2.3 2.1h3.8l1.5-2 3.6-.1 4.9-4.5 7.4-.3 15.4-19.1-4.8.1-18.5-7.6-2.2-2.2-2.1-3.1-2.2-3.5 1.1-2.3-1.3-1.1-1.3.5-3.1-.1-.2-2-.5-1.7 1.8-3 1.9-2.8-2-2.1-2.5-3.7-2.5-2.1-1.6-2.2-4.9-2.5-3.9-.1-1.4-1.3-3.2 1.5-3.5-2.9z",
    fi: "M1093.4 144.4l.8-3.8-5.7-2.1-5.8 1.8-1.1 3.9-3.4 2.4-4.7-1.3-5.3.3-5.1-2.9-2.1 1.4 5.9 2.7 7.2 3.7 1.7 8.4 1.9 2.2 6.4 2.6.9 2.3-2.6 1.2-8.7 6.1-3.3 3.6-1.5 3.3 2.9 5.2-.1 5.7 4.7 1.9 3.1 3.1 7.1-1.2 7.5-2.1 8-.5 7.9-7.4 3.3-3.3.9-2.9-7.3-3.9.9-3.7-4.9-4.1 1.7-4.8-6.4-6.3 2.8-4.1-7.2-3.7-.4-3.7z",
    fj: "M1976.7 674.4l-3.7 2-1.9.3-3.1 1.3.2 2.4 3.9-1.3 3.9-1.6.7-3.1zm-11 8.1l-1.6 1-2.3-.8-2.7 2.2-.2 2.8 2.9.8 3.6-.9 1.8-3.3-1.5-1.8z",
    fk: "M690.3 902.7l-.1-.3-.4-.2-.2-.1.1.2.1.3.1.2.2.1.2-.2zm5.5-1.3l-.1-.1h-.2l-.1.2.2.3.4.1-.2-.5zm-12.9-1.4l-.1.2-.4.1.2.3.6.4h.4l.1-.3-.1-.6h-.3l-.4-.1zm2.8-2l-.9-.3-.4-.3h-.3l.4.4.1.2.1.2.6.3.6.3.4.3-.1.1-.8.3h-.3l-.2.1.4.2.6-.1.2-.1h.2l.3.1v.2l-.1.2-.2.2-.4.3-.6.4h-.8l-.7.7.9.5.7.3h.9v-.1l.2-.1h.3l.1-.1.2-.4v-.6h.2l.3.1.7-.1.3-.1.6-.9.4-.8.2-.4.3-.2.1-.2.1-.3.3-.2v-.3l-.4-.2-.3-.2-.3.3-.2-.1-.9.3h-.4l-.3-.2-.4-.1-.4.1-.5.5-.8-.2zm.7-.4l.1-.3-.1-.2-.5-.2h-.5l.2.5.2.2h.6zm5.9-.7h-.4l.4.5-.8.8.2.6.3.4.1.2-.1.1-.4.1-.3.1-.2.3-.9.9.2.2-.3.7.2.3.8.7.8.4v-.7l.4-.1.4.2.4-.2-.9-1h.3l2.5.5-.1-.4-.1-.2-.3-.4 1.5-.4.5-.3.2-.3.6-.1.8-.3-.1-.1.1-.3-.4-.2-.5-.1.1-.3.5-.1-.8-.7-.3-.1-1 .1-.3.1v.2l.1.3.3.3.1.2-.2-.1-1.1-.4-.2-.1-.2-.4.2-.1.3.1.1-.3-.4-.3-.4-.1-.9.1-.8-.3z",
    fo: "M947 186.9v-.3l-.1-.3v-.2h-.1l-.5-.1-.1-.2h-.1v.2l.1.4.5.4.3.2h.1l-.1-.1zm.5-2.1v-.1l-.2-.2-.5-.2-.2-.1-.2.1v.2l.1.1.4.1.4.3h.1l.1-.2zm-2.4-1.9l-.2-.1-.5.1h-.3l.1.3.6.2h.6l.2-.1-.1-.2-.4-.2zm2.5-.5l-.8-.2-.6-.3-1 .1.7 1.1.8.7.4.2V183.7l-.4-.5-.1-.1v-.1l.1-.1h.2l.3.2h.2l.2-.7zm1-.2l-.3-.2-.4-.4v.9h.1l.3.1.3-.4z",
    fr: "M1025.7 303.8l-1.1-5.2-3.2 2.3-1 2.3 1.4 4.2 2.4 1.2 1.5-4.8zm-31.5-50.9l-2.4-2.4-2.2-.1-.7-2.2-4.3 1.2-1.4 5.1-11.3 4.8-4.6-2.6 1.4 7-8.2-1.6-6.4 1.3.4 4.6 7.5 2.4 3.6 3.1 5.1 6.5-1 12.3-2.7 3.7 2 2.4 9.4 2.8 1.9-1.3 5.7 2.8 6-.8.5-3.7 7.4-2 10 1.6 4.5-3.4.5-2.7-2.7-.8-1.5-4.8 1.7-1.8-1.6-2.4.2-1.7-1.8-2.7-2.4.9v-2.8l3.5-3.5-.2-1.6 2.3.6 1.3-1 .5-4.5 2.3-4.2-7.1-1.2-2.4-1.6-1.4.1-1.1-.5-4.4-2.8-2.5.4-3.4-2.9z",
    ga: "M1050.2 557.7l-.7-.3-3.4.8-3.4-.8-2.6.4v7.6h-8.2l-1.9.3-1.1 4.8-1.3 4.6-1.3 2-.2 2.1 3.4 6.6 3.7 5.3 5.8 6.4 4.3-3.5-2.1-4.2 1.9-1.6 3.8-.8.5-2.8 3 3 4.9.3 1.7-3 .8-4.3-.6-4.9-2.7-3.8 2.4-7.4-1.4-1.2-4.2.5-1.5-3.3.4-2.8z",
    gb: "M950 227.5l-4.9-3.7-3.9.3.8 3.2-1.1 3.2 2.9-.1 3.5 1.3 2.7-4.2zm13-24.3l-5.5.5-3.6-.4-3.7 4.8-1.9 6.1 2.2 3 .1 5.8 2.6-2.8 1.4 1.6-1.7 2.7 1 1.6 5.7 1.1h.1l3.1 3.8-.8 3.5-7.1-.6-1 4 2.6 3.3-5.1 1.9 1.3 2.4 7.5 1-4.3 1.3-7.3 6.5 2.5 1.2 3.5-2.3 4.5.7 3.3-2.9 2.2 1.2 8.3-1.7 6.5.1 4.3-3.3-1.9-3.1 2.4-1.8.5-3.9-5.8-1.2-1.3-2.3-2.9-6.9-3.2-1-4.1-7.1-.4-.6-4.8-.4 4.2-5.3 1.3-4.9h-5l-4.7.8 5-6.4z",
    gd: "M632.1 495.7l.5-.2.2-1.1-.3-.1-.3.3-.3.5v.4l-.2.3.4-.1z",
    ge: "M1200 300.2l-7.5-2.9-7.7-1-4.5-1.1-.5.7 2.2 1.9 3 .7 3.4 2.3 2.1 4.2-.3 2.7 5.4-.3 5.6 3 6.9-1 1.1-1 4.2 1.8 2.8.4.6-.7-3.2-3.4 1.1-.9-3.5-1.4-2.1-2.5-5.1-1.3-2.9 1-1.1-1.2z",
    gf: "M681.4 556.2l1.8-4.7 3.5-5.8-.9-2.6-5.8-5.4-4.1-1.5-1.9-.7-3.1 5.5.4 4.4 2.1 3.7-1 2.7-.6 2.9-1.4 2.8 2.4 1.3 1.8-1.8 1.2.3.8 1.8 2.7-.5 2.1-2.4z",
    gh: "M976.8 502.1l-2.6-.5-1.8 1-2.4-.5-9.7.3-.2 3.6.8 4.8 1.4 9.1-2.3 5.3-1.5 7.2 2.4 5.5-.2 2.5 5 1.8 5-1.9 3.2-2.1 8.7-3.8-1.2-2.2-1.5-4-.4-3.2 1.2-5.7-1.4-2.3-.6-5.1.1-4.6-2.4-3.3.4-1.9z",
    gl: "M887.4 76.3l-26-.4-11.8.3-5 1.3-11.5-.1-12.7 2.1-1.6 1.7 6.7 2.1-6.2-1.3-4.5-.3-7-1.4-10.6 2.1-2.7-1.2h-10.4l-10.9.6-8.9 1-.2 1.8-5.3.5-14.6 2.9-4.6 1.7 8.1 1.5-2.8 1.6L730 95l-15.5 2.2-2.2 1.7 6.4 2 14.5 1.2-7.5.2-10.9 1.5 3.8 3.1 3 1.5 9.4-.3 10.1-.2 7.6.3 8 2.9-1.4 2.1 3.6 1.9 1.4 5.3 1 3.6 1.4 1.9-7 4.8 2.6 1.3 4.4-.8 2.6 1.8 5.3 3.4-7.5-1.4h-3.8l-3 2.8-1.5 3.6 4.2 1.8 4-.8 2.6-.8 5.5-1.9-2.8 4.2-2.6 2.3-7.1 2-7 6.3 2 2-3.4 4 3.7 5.2-1.5 5 .7 3.7 4.8 7.1.8 5.6 3.1 3.2h8.9l5 4.7 6.5-.3 4.1-5.7 3.5-4.8-.3-4.4 8.6-4.6 3.3-3.7 1.4-3.9 4.7-3.5 6.5-1.3 6.1-1.4 3-.2 10.2-3.9 7.4-5.7 4.8-2.1 4.6-.1 12.5-1.8 12.1-4.3 11.9-4.6-5.5-.3-10.6-.2 5.3-2.8-.5-3.6 4.2 3 2.7 2.1 7.3-1-.6-4.3-4.5-3.1-5-1.3 2.4-1.4 7.2 2.1.5-2.3-4.1-3.4h5.4l5.6-.8 1.7-1.8-4-2.1 8.6-.3-4-4.3 4.1-.5.1-4.2-6.2-2.5 6.4-1.6 5.8-.1-3.6-3.2 1.1-5.1 3.6-2.9 4.9-3.2-8-.2 11.3-.7 2.2-1 14.6-2.9-1.6-1.7-10-.8-16.9 1.5-9.2 1.5 4.5-2.3-2.3-1.4-7 1.2-9.7-1.4-12.1.5-1.4-.7 18.3-.4 12.9-.2 6.6-1.4-19.7-2.9z",
    gm: "M882.8 488.5l5 .1 1.4-.9h1l2.1-1.5 2.4 1.4 2.4.1 2.4-1.5-1.1-1.8-1.8 1.1-1.8-.1-2.1-1.5-1.8.1-1.3 1.5-6.1.2-.7 2.8z",
    gn: "M912.4 493l-.8.4-3-.5-.4.7-1.3.1-4-1.5-2.7-.1-.1 2.1-.6.7.4 2.1-.8.9h-1.3l-1.4 1-1.7-.1-2.6 3.1 1.6 1.1.8 1.4.7 2.8 1.3 1.2 1.5.9 2.1 2.5 2.4 3.7 3-2.8.7-1.7 1-1.4 1.5-.2 1.3-1.2h4.5l1.5 2.3 1.2 2.7-.2 1.8.9 1.7v2.3l1.5-.3 1.2-.2 1.5-.7 2.3 3.9-.4 2.6 1.1 1.3 1.6.1 1.1-2.6 1.6.2h.9l.3-2.8-.4-1.2.6-.9 2-.8-1.3-5.1-1.3-2.6.5-2.2 1.1-.5-1.7-1.8.3-1.9-.7-.7-1.2.6.2-2.1 1.2-1.6-2.3-2.7-.6-1.7-1.3-1.4-1.1-.2-1.3.9-1.8.8-1.6 1.4-2.4-.5-1.5-1.6-.9-.2-1.5.8h-.9l-.3-2.3z",
    gp: "M636.4 471.1l.2-.2v-.3l-.2-.3-.2.1-.2.3v.3l.1.1h.3zm-1.9-.8l.2-.2v-1.2l.1-.3-.2-.1-.2-.2-.6-.2-.1.1-.2.3.1 1.5.2.5.2.1.5-.3zm1.6-1.4l.8-.2-.9-.6-.2-.4v-.3l-.4-.3-.2.2-.1.3.1.5-.3.4.1.4.4.1.7-.1z",
    gq: "M1040.1 557.8l-9.2-.2-1.9 7.2 1 .9 1.9-.3h8.2v-7.6z",
    gr: "M1101.9 344.9l-.8 2.8 6.6 1.2v1.1l7.6-.6.5-1.9-2.8.8v-1.1l-3.9-.5-4.1.4-3.1-2.2zm11.5-37.4l-2.7-1.6.3 3-4.6.6-3.9-2.1-3.9 1.7-3.8-.2-1 .2-.7 1.1-2.8-.1-1.9 1.3-3.3.6v1.6l-1.6.9-.1 2.1-2.1 3 .5 1.9 2.9 3.6 2.3 3 1.3 4.3 2.3 5.1 4.6 2.9 3.4-.1-2.4-5.7 3.3-.7-1.9-3.3 5 1.7-.4-3.7-2.7-1.8-3.2-3 1.8-1.4-2.8-3-1.6-3.8.9-1.3 3 3.2h2.9l2.5-1-3.9-3.6 6.1-1.6 2.7.6 3.2.2 1.1-.7 1.2-3.9z",
    gt: "M482.8 458.9l-5.1-.1h-5.2l-.4 3.6h-2.6l1.8 2.1 1.9 1.5.5 1.4.8.4-.4 2.1H467l-3.3 5.2.7 1.2-.8 1.5-.4 1.9 2.7 2.6 2.5 1.3 3.4.1 2.8 1.1.2-1 2.1-1.6 1.1-.7-.2-.7 1.4-.4 1.3-1.6-.3-1.3.5-1.2 2.8-1.8 2.8-2.4-1.5-.8-.6.9-1.7-1.1h-1.6l1.2-7.2.7-5z",
    gw: "M900.2 492.1l-10.3-.3-1.5.7-1.8-.2-3 1.1.3 1.3 1.7 1.4v.9l1.2 1.8 2.4.5 2.9 2.6 2.6-3.1 1.7.1 1.4-1h1.3l.8-.9-.4-2.1.6-.7.1-2.1z",
    gy: "M656.1 534.2l-2.1-2.3-2.9-3.1-2.1-.1-.1-3.3-3.3-4.1-3.6-2.4-4.6 3.8-.6 2.3 1.9 2.3-1.5 1.2-3.4 1.1v2.9l-1.6 1.8 3.7 4.8 2.9-.3 1.3 1.5-.8 2.8 1.9.9 1.2 3-1.6 2.2-1 5.4 1.4 3.3.3 2.9 3.5 3 2.7.3.7-1.3 1.7-.2 2.6-1.1 1.8-1.7 3.1.5 1.4-.2-3.3-5.6-.7-3.5-1.8-.1-2.4-4.6 1.1-3.3-.3-1.5 3.5-1.6 1-5.7z",
    hk: "M1604.9 430.9v-.4l-.4-.2h-.3l.1.2.4.5.2-.1zm-1.3 0l-.1-.5.2-.3-.9.3-.1.3v.1l.2.1h.7zm1.6-1.2l-.1-.3-.2-.1-.1-.3-.1-.2-.3-.1-.2-.1h-.4l-.1.1h-.2l-.2.2v.2l-.5.4v.2l.3.2.5-.1.6.2.8.3v-.5l.2-.1z",
    hn: "M514.1 476.8l-1.3-1.8-1.9-1-1.5-1.4-1.6-1.2-.8-.1-2.5-.9-1.1.5-1.5.2-1.3-.4-1.7-.4-.8.7-1.8.7-2.6.2-2.5-.6-.9.4-.5-.6-1.6.1-1.3 1.1-.6-.2-2.8 2.4-2.8 1.8-.5 1.2.3 1.3-1.3 1.6 1.5.5 1.1 1.3 1.6 1 .1.9 2.5-.8 1.1.5.7.7-.6 2.5 1.7.6.7 2 1.8-.3.8-1.5h.8l.2-3.1 1.3-.2h1.2l1.4-1.7 1.5 1.3.6-.8 1.1-.7 2.1-1.8.3-1.3.5.1.8-1.5.6-.2.9.9 1.1.3 1.3-.8h1.4l2-.8.9-.9 1.9.2z",
    hr: "M1065 280.4l-4-2.6-1.6-.8-3.9 1.7-.3 2.5-1.7.6.2 1.7-2-.1-1.8-1-.8 1-3.5-.2-.2.1v2.2l1.7 2 1.3-2.6 3.3 1 .3 2 2.5 2.6-1 .5 4.6 4.5 4.8 1.8 3.1 2.2 5 2.3.5-1-4.7-2.4-2.2-2.5-2-1.4-2.5-2.3-1.3-1.9-2.7-2.9.9-2.5 1.9 1.4 1-1.3 2.3-.1 4.4 1 3.5-.1 2.4 1.4 1.7-2.3-1.7-1.8-1.5-2.4-1.8.9-4.2-1.2z",
    ht: "M580.6 446.7l-4.6-1-3.4-.2-1.4 1.7 3.4 1-.3 2.4 2.2 2.8-2.1 1.4-4.2-.5-5-.9-.7 2.1 2.8 1.9 2.7-1.1 3.3.4 2.7-.4 3.6 1.1.2-1.8-1.2-1.9 1.5-1.1.7-2.4-.2-3.5z",
    hu: "M1079.1 263.8l-1.6.4-1 1.5-2.2.7-.6-.4-2.3 1-1.9.2-.3 1.2-4.1.8-1.9-.7-2.6-1.6-.2 2.6h-2.8l1.1 1.3-1.3 4 .8.1 1.2 2.1 1.6.8 4 2.6 4.2 1.2 1.8-.9 3.7-1.6 3.2.2 3.8-1.1 2.6-4.3 1.9-4.2 2.9-1.3-.6-1.6-2.9-1.7-1 .6-5.5-1.9z",
    ic: "M879.6 395.2l-.2-.2-.7.5h-.6l.1.2.1.2.7.4.6-1.1zm13.5-2.1v-.1h-.1l-.1.1-1.3-.1-.2.6-.5.4v.7l.5.7.3.1.5.1.7-.4.2-.4.1-.8-.1-.4v-.5zm-9.7.8l.5-.4v-.2l-.1-.3-.5-.3h-.2l-.2.2-.2.4.3.5.2.1h.2zm4.7-2.3l1.2-1v-.3l-1 .1-1.1 1-.3.1-1 .1h-.5l-.4.2.2.3.4 1 .7.9.6-.2.3-.2.4-.6.5-1.4zm11.6 1.3l1.5-.5.3-1 .3-1.1v-.7l-.2-.3h-.5l-.3.2-.1.6-.7 1.3-.5 1.2-.7.6-.7.2.1.1.7.1.8-.7zm-19.7-2l.5-.5.1-.3-.1-.5.2-.2-.1-.4-.3-.4h-.7l-.4.6.6 1.2.1.5h.1zm22.4-2.7l.9-.3.5-.3.1-.9.2-.3-.2-.3-.2.2-.2.4-.6.2-.8.4-.2.3-.2.9.4.1.3-.4z",
    id: "M1651.9 637.3l.5-1.7-1.8-1.9-2.8-2-5.3 1.3 7 4.4 2.4-.1zm20.9-.6l4-4.8.1-1.9-.5-1.3-5.7 2.6-2.8 3.9-.7 2.1.6.8 5-1.4zm-35.6-13l-1.6 2.2-3.1.1-2.2 3.6 3 .1 3.9-.9 6.6-1.2-1.2-2.8-3.5.6-1.9-1.7zm28.1 0l-5.2 2.3-3.8.5-3.4-1.9-4.5 1.3-.2 2.3 7.4.8 8.6-1.8 1.1-3.5zm-79.5-8.4l-.7-2.3-2.3-.5-4.4-2.4-6.8-.4-4.1 6.1 5.1.4.8 2.8 10 2.6 2.4-.8 4.1.6 6.3 2.4 5.2 1.2 5.8.5 5.1-.2 5.9 2.5 6.6-2.4-6.6-3.8-8.3-1.1-1.8-4.1-10.3-3.1-1.3 2.6-10.7-.6zm146.6-3.6l.2-3-1.2-1.9-1.3 2.2-1.2 2.2.3 4.8 3.2-4.3zm-41-17.5l-1.4-2.1-5.7.3 1 2.7 3.9 1.2 2.2-2.1zm18.1-2.4l-6.1-1.8-6.9.3-1.5 3.5 3.9.2 3.2-.4 4.6.5 4.7 2.6-1.9-4.9zm21-12.3l-.8-2.4-9-2.6-2.9 2.1-7.6 1.5 2.3 3.2 5 1.2 2.1 3.7 8.3.1.4 1.6-4-.1-6.2 2.3 4.2 3.1-.1 2.8 1.2 2.3 2.1-.5 1.8-3.1 8.2 5.9 4.6.5 10.6 5.4 2.3 5.3 1 6.9-3.7 1.8-2.8 5.2 7.1-.2 1.6-1.8 5.5 1.3 4.6 5.2 1.5-20.8 1-20.7-6-1.2-4.1-2.3-4.7-2.2h-5l-6.6 3.8-4.9 6.8-5.7-3.8-1.3-10.3zm-50-16.4l-1-1.4-5.5 4.6-6.5.3-7.1-.9-4.4-1.9-4.7 4.8-1.2 2.6-2.9 9.6-.9 5-2.4 4.2 1.6 4.3 2.3.1.6 6.1-1.9 5.9 2.3 1.9 3.6-1 .3-9.1-.2-7.4 3.8-1.9-.7 6.2 3.9 3.7-.8 2.5 1.3 1.7 5.6-2.4-3 5.2 2.1 2.2 3.1-1.9.3-4.1-4.7-7.4 1.1-2.2-5.1-8.1 5-2.5 2.6-3.7 2.4.9.5-2.9-10.5 2.1-3.1 2.9-5-5.6.9-4.8 4.9-1 9.3-.3 5.4 1.3 4.3-1.3 4.4-6.3zm19.4 1.9l-.6-2.6-3.3-.6-.5-3.5-1.8 2.3-1 5.1 1.7 8.2 2.2 4 1.6-.8-2.3-3.3.9-3.9 2.9.6.2-5.5zm-60.9-4.5l.9-2.9-4.3-6 3-5.8-5-1h-6.4l-1.7 7.2-2 2.2-2.7 8.9-4.5 1.3-5.4-1.8-2.7.6-3.2 3.2-3.6-.4-3.6 1.2-3.9-3.5-1-4.3-3.3 4.2-.6 5.9.8 5.6 2.6 5.4 2.8 1.8.7 8.5 4.6.8 3.6-.4 2 3.1 6.7-2.3 2.8 2 4 .4 2 3.9 6.5-2.9.8 2.3 2.5-9.7.3-6.4 5.5-4.3-.2-5.8 1.8-4.3 6.7-.8-6.5-5.9zm-68.7 48.9l.7-9.8 1.7-8-2.6-4-4.1-.5-1.9-3.6-.9-4.4-2-.2-3.2-2.2 2.3-5.2-4.3-2.9-3.3-5.3-4.8-4.4-5.7-.1-5.5-6.8-3.2-2.7-4.5-4.3-5.2-6.2-8.8-1.2-3.6-.3.6 3.2 6.1 7 4.4 3.6 3.1 5.5 5.1 4 2.2 4.9 1.7 5.5 4.9 5.3 4.1 8.9 2.7 4.8 4.1 5.2 2.2 3.8 7 5.2 4.5 5.3 6.2-.1z",
    ie: "M947.3 231.7l-3.5-1.3-2.9.1 1.1-3.2-.8-3.2-3.7 2.8-6.7 4.7 2.1 6.1-4.2 6.4 6.7.9 8.7-3.6 3.9-5.4-.7-4.3z",
    il: "M1167.8 360.5l-1.4.1-.4 1.1h-1.8l-.1.1-.6 1.6-.6 4.8-1.1 2.9.4.4-1.4 2.1 3.9 9.2.7 1.7 1.7-10.2-.4-2.4-2.4.8.1-1.7 1.2-.8-1.4-.7.7-4.3 2 .9.7-2h-.1l.6-1-.3-2.6z",
    in: "M1414.1 380.1l-8.5-4.4-6.2-4-3.2-7 4.1.9-.6-3.3-3-3.3-.8-5.2-7.6-7.5-3.7 5.4-5.7 1-8.5-1.6-1.9 2.8 3.2 5.6 2.9 4.3 5 3.1-3.7 3.7 1 4.5-3.9 6.3-2.1 6.5-4.5 6.7-6.4-.5-4.9 6.6 4 2.9 1.3 4.9 3.5 3.2 1.8 5.5h-12l-3.2 4.2 7.1 5.4 1.9 2.5-2.4 2.3 8 7.7 4 .8 7.6-3.8 1.7 5.9.8 7.8 2.5 8.1 3.6 12.3 5.8 8.8 1.3 3.9 2 8 3.4 6.1 2.2 3 2.5 6.4 3.1 8.9 5.5 6 2.2-1.8 1.7-4.4 5-1.8-1.8-2.1 2.2-4.8 2.9-.3-.7-10.8 1.9-6.1-.7-5.3-1.9-8.2 1.2-4.9 2.5-.3 4.8-2.3 2.6-1.6-.3-2.9 5-4.2 3.7-4 5.3-7.5 7.4-4.2 2.4-3.8-.9-4.8 6.6-1.3 3.7.1.5-2.4-1.6-5.2-2.6-4.8.4-3.8-3.7-1.7.8-2.3 3.1-2.4-4.6-3.4 1.2-4.3 4.8 2.7 2.7.4 1.2 4.4 5.4.9 5-.1 3.4 1.1-1.6 5.3-2.4.4-1.1 3.6 3.5 3.3.2-4 1.5-.1 4.5 10.1 2.4-1.5-.9-2.7.9-2.1-.9-6.6 4.6 1.4 1.5-5.2-.3-3.1 2.1-5.4-.9-3.6 6.1-4.4 4.1 1.1-1.3-3.9 1.6-1.2-.9-2.4-6.1-.9 1.2-2.7-3.5-3.9-3.2 2.6-4.9-1.5-5.3 4-3.9 4.8-4.2.8 2.7 2 .4 3.9-4.4.2-4.7-.4-3.2 1-5.5-2.5-.3-1.2-1.5-5.1-3 1.4.1 2.7 1.5 4.1-.1 2.5-4.6.1-6.8-1.5-4.3-.6-3.8-3.2-7.6-.9-7.7-3.5-5.8-3.1-5.7-2.5.9-5.9 2.8-2.9z",
    iq: "M1207.3 334.9l-6.2-.9-2.1 1-2.1 4.1-2.7 1.6 1.2 4.7-.9 7.8-11 6.7 3.1 7.7 6.7 1.7 8.5 4.5 16.7 12.7 10.2.5 3.2-6.1 3.7.5 3.2.4-3.4-3.4-.5-3.3h-1.7l.2-4.6-3.5-4.9-7-3.4-4.6-6.1.5-5 2.3-2.2-1-3.8-3.7-1.9-4.7-7.8-2.3 1.1-2.1-1.6z",
    ir: "M1213.5 324.4l-3.2-2.9-1.2-2.4-3.3 1.8 2.9 7.3-.7 2 3.7 5.2 4.7 7.8 3.7 1.9 1 3.8-2.3 2.2-.5 5 4.6 6.1 7 3.4 3.5 4.9-.2 4.6h1.7l.5 3.3 3.4 3.4 1.7-2.5 3.7 2.1 2.8-1 5.1 8.4 4.3 6.1 5.5 1.8 6.1 4.9 6.9 2.1 5.1-3.1 4-1.1 2.8 1.1 3.2 7.8 6.3.8 6.1 1.5 10.5 1.9 1.2-7.4 7.4-3.3-.9-2.9-2.7-1-1-5.7-5.6-2.7-2.8-3.9-3.2-3.3 3.9-5.8-1.1-4-4.3-1.1-1.1-4-2.7-5.1 1.6-3.5-2.5-.9.5-4.7.5-8-1.6-5.5-3.9-.2-7.3-5.7-4.3-.7-6.5-3.3-3.8-.6-2.1 1.2-3.5-.2-3 3.7-4.4 1.2-.2 1.6-7.9 1.7-7.6-1.1-4.3-3.3-5.2-1.3-2.5-4.8-1.3.3-3.8-3.4 1.2-3.1-1.9-1.9-1.9.5-5.3 4.7-1.8.2-3.7-.9z",
    is: "M915.7 158.6l-6.9-.4-7.3 2.9-5.1-1.5-6.9 3-5.9-3.8-6.5.8-3.6 3.7 8.7 1.3-.1 1.6-7.8 1.1 8.8 2.7-4.6 2.5 11.7 1.8 5.6.8 3.9-1 12.9-3.9 6.1-4.2-4.4-3.8 1.4-3.6z",
    it: "M1057.8 328.6l-4 .5-5.2.7-6.2-.6-.6 3.4 7.5 3.3 2.7.7 4.2 2.4.9-3.3-.9-2 1.6-5.1zm-33.7-18.9l-2.5 1.9-2.8-.3 1.3 3.6.4 7.6 2.1 1.7 2-2.1 2.4.4.4-8.4-3.3-4.4zm14.3-34.3l-1.3-2.2-4.8 1.1-.5 1.2-3.1-.9-.3 2.5-2.1 1.1-3.8-.8-.9 2.5-2.4.2-.9-1-2.7 2.1-2.4.3-2.2-1.3-.2 1.7 1.6 2.4-1.7 1.8 1.5 4.8 2.7.8-.5 2.7 2.1-.5 2.8-2.8 2.3-.9 4.2 2.1 2.6.7 1.9 6 3.6 3.6 4.9 4 4.2 2.8 3.9.4 2.3 2.5 3.4 1.2 1.7 2.7 2.2.8 1.8 3.2 2.3 3.7-1.1 1.3-.8 3.5.1 2 2.1-.5 2.5-5.6 2.1-.4.4-3.3-3.9-2.3 1.9-4.1 4.5 1 3.1 3 .8-2.3-.6-1.2-4.7-3.2-3.9-1.9-4.8-2.3 1.4-1.2-1.4-1.4-4 .1-6-5-2.9-5.1-4.9-3.1-1.9-3.1.5-1.8-.4-3 3.9-2.2 4.1.9-1.4-2.7.3-3-7.2-1.6z",
    jm: "M550.7 458.5l3.9-.1-.8-1.8-2.7-1.5-3.7-.6-1.2-.2-2.4.4-.8 1.5 2.9 2.3 3 1 1.8-1z",
    jo: "M1186.6 367.6l-3.1-7.7-9.6 6.7-6.3-2.5-.7 2 .4 3.9-.6 1.9.4 2.4-1.7 10.2.3.9 6.1 1 2.1-2 1.1-2.3 4-.8.7-2.2 1.7-1-6.1-6.4 10.4-3.1.9-1z",
    jp: "M1692.5 354.9l-4.5-1.3-1.1 2.7-3.3-.8-1.3 3.8 1.2 3 4.2 1.8-.1-3.7 2.1-1.5 3.1 2.1 1.3-3.9-1.6-2.2zm24.4-19.3l-3.6-6.7 1.3-6.4-2.8-5.2-8.1-8.7-4.8 1.2.2 3.9 5.1 7.1 1 7.9-1.7 2.5-4.5 6.5-5-3.1v11.5l-6.3-1.3-9.6 1.9-1.9 4.4-3.9 3.3-1.1 4-4.3 2 4 4.3 4.1 1.9.9 5.7 3.5 2.5 2.5-2.7-.8-10.8-7.3-4.7 6.1-.1 5-3 8.6-1.4 2.4 4.8 4.6 2.4 4.4-7.3 9.1-.4 5.4-3 .6-4.6-2.5-3.2-.6-5.2zm-11.8-44.2l-5.3-2.1-10.4-6.4 1.9 4.8 4.3 8.5-5.2.4.6 4.7 4.6 6.1h5.7l-1.6-6.8 10.8 4.2.4-6.1 6.4-1.7-6-6.9-1.7 2.6-4.5-1.3z",
    ke: "M1211.7 547.2h-3.8l-2.3-2.1-5.1 2.6-1.6 2.7-3.8-.5-1.2-.7-1.3.1h-1.8l-7.2-5.4h-3.9l-2-2.1v-3.6l-2.9-1.1-3.8 4.2-3.4 3.8 2.7 4.4.7 3.2 2.6 7.3-2.1 4.7-2.7 4.2-1.6 2.6v.3l1.4 2.4-.4 4.7 20.2 13 .4 3.7 8 6.3 2.2-2.1 1.2-4.2 1.8-2.6.9-4.5 2.1-.4 1.4-2.7 4-2.5-3.3-5.3-.2-23.2 4.8-7.2z",
    kg: "M1387.2 302.6l-3.5-.9-3.3-2.2-7.8-.6-8.6-.2-1.6.7-8.1-2.6-2.5 1.3.5 3.6-9.1-2.1-3.1.8-.3 2.7 1.8.6-3.1 4.1 4.6 2.3 3.2-1.6 7.1 3.3-5.2 4.5-4.1-.6-1.4 2-5.9-1.1.6 3.7 5.4-.5 7.1 2 9.5-.9 1-1.5-1.1-1.5 4-3 3.2-1.2 5.7.9.6-4 6.4-.8 1-2.4 6.8-3.4.2-1.4z",
    kh: "M1574.8 481.8l-5.2-2.3-2 4.3-4.9-2.4-5.3-1-7.1 1.3-3 5.2 2.1 7.7 3.4 6.6 2.6 3.3 4.7.9 4.7-2.5 5.8-.5-2.8-3.8 8.9-4.9-.1-7.7-1.8-4.2z",
    km: "M1221.1 650.5l-.4-.4h-.4v.2l.1.4 1.1.2-.4-.4zm3.9-1.5h-.1l-.2.1-.1.2-.1.3h-.9l.8.5.5.5.2.2.1-.2.1-.7-.3-.9zm-5.6-1.1l.2-.3-.2-.7-.4-.8.1-1.4-.2-.2h-.3l-.1.1-.1.3-.3 2 .4.6.3.1.5.4.1-.1z",
    kn: "M629.9 463.2v-.3l-.2-.2h-.3v.5l.2.2.3-.2zm-.5-.7l-.1-.2-.1-.1-.2-.4-.4-.4-.2.1-.1.2v.1l.3.3.4.1.2.4.2-.1z",
    kp: "M1644.7 302.3l-5.5-3.6.1 3.5-6.3 2.6 2.7 3.3-4.6-.2-3.6-2-1 4.4-3.8 3.4-2.1 4 3.3 1.7 3.4.7.8 1 .4 3.5 1.1 1.2-.9.7-.1 2.9 1.9 1 1.6.6.8 1.2 1.3-.5v-1.3l3.1 1.3.1-.6 2.4.2.7-2.9 3.5-.3 2.1-.4-.1-1.6-4.3-2.8-2.6-1 .2-.7-1.2-2.8 1.3-1.7 2.9-1 1-1.9.3-1.1 1.9-1.4-2.8-4.5.3-2.1.9-2 2.2.3-1.4-1.1z",
    kr: "M1637.3 331.7l6.2 5.5-3.4 1.1 5.2 6.8 1.1 4.8 2.1 3.5 4.5-.5 3.2-2.7 4.2-1.2.5-3.6-3.4-7.5-3.3-4.2-8.2-7.6.1 1.6-2.1.4-3.5.3-.7 2.9-2.4-.2-.1.6z",
    kw: "M1235.6 381.4l-3.7-.5-3.2 6.1 4.9.6 1.7 3.1 3.8-.2-2.4-4.8.3-1.5-1.4-2.8z",
    ky: "M527 449.1l-.1-.3-.1.1v.6h.7l.3-.2h.6l-.1-.2-.8-.1-.1.1-.2.1-.2-.1zm8-2.3l-.1-.1h-.1l-.3.1h-.2l-.1.1-.1.1h.2l.4-.2H535zm.8-.1l.5-.2-.1-.1h-.1l-.1.1h-.1l-.5.3h.2l.2-.1z",
    kz: "M1308.8 223.8l-9-1.3-3.1 2.5-10.8 2.2-1.7 1.5-16.8 2.1-1.4 2.1 5 4.1-3.9 1.6 1.5 1.7-3.6 2.9 9.4 4.2-.2 3-6.9-.3-.8 1.8-7.3-3.2-7.6.2-4.3 2.5-6.6-2.4-11.9-4.3-7.5.2-8.1 6.6.7 4.6-6-3.6-2.1 6.8 1.7 1.2-1.7 4.7 5.3 4.3 3.6-.2 4.2 4.1.2 3.2 2.8 1 4.4-1.3 5-2.7 4.7 1.5 4.9-.3 1.9 3.9.6 6-4.6-.9-4 1 .9 4.5-5-.6.6 2 3.2 1.6 3.7 5.5 6.4 2.1 1.5 2.1-.7 2.6.7 1.5 1.8-2 5.5-1.3 3.8 1.7 4.9 4.9 2.5-.3-6.2-22.8 11.9-3.6 1.1.5 9.1 4.5 4.8 2.3 6.5 5.5 5.7-.9 8.6-.5 7.5 4.5 1.5 6.2 2.5.1 2.6 5 6.6.2 2.3 3h1.9l.9-4.5 5.4-4.3 2.5-1.2.3-2.7 3.1-.8 9.1 2.1-.5-3.6 2.5-1.3 8.1 2.6 1.6-.7 8.6.2 7.8.6 3.3 2.2 3.5.9-1.7-3.5 2.9-1.6-8.7-10.7 9-2.4 2-1.4-1-11.1 10.7 2 1.6-2.8-2.5-6.2 3.8-.6 1.8-4.2-4.3-3.8-6 .9-3.3-2.6-3.9-1.2-4.1-3.6-3.2-1.1-6.2 1.6-8.3-3.6-1.1 3.3-18.1-15.5-8.3-4.7.8-1.9-9.1 5.7-4.4.4-1.2-3.3-7-2.1-4.3 1.5-4.3-6.3z",
    la: "M1574.8 481.8l.2-6.4-2-4.5-4.8-4.4-4.3-5.6-5.7-7.5-7.3-3.8 1.3-2.3 3.3-1.7-3-5.5-6.8-.1-3.4-5.7-4-5.1-2.7 1 1.9 7.2-2.9-.1-.7-1.5-4.1 4.1-.8 2.4 2.6 1.9.9 3.8 3.8.3-.4 6.7 1 5.7 5.3-3.8 1.8 1.2 3.2-.2.8-2.2 4.3.4 4.9 5.2 1.3 6.3 5.2 5.5.5 5.4-1.5 2.9 4.9 2.4 2-4.3 5.2 2.3z",
    lb: "M1167.8 360.5l.9-3.5 2.6-2.4-1.2-2.5-2.4-.3-.1.2-2.1 4.5-1.3 5.2h1.8l.4-1.1 1.4-.1z",
    lc: "M637.4 484.2l.1-1.2-.1-.5-.2.1-.3.4-.4.6-.1.3v.6l.6.4.4-.7z",
    li: "M1024.4 273.6v-.2l.1-.2-.1-.1-.1-.2-.1-.1v-.2l-.1-.1v-.2l-.1-.1-.2.6v.5l.1.2h.1l.4.1z",
    lk: "M1432.2 532.7l2.3-1.8.6-6.6-3-6.6-2.9-4.5-4.1-3.5-1.9 10.3 1.4 9.1 2.8 5.1 4.8-1.5z",
    lr: "M929.4 523.3l-1.6-.2-1.1 2.6-1.6-.1-1.1-1.3.4-2.6-2.3-3.9-1.5.7-1.2.2-2.6 3-2.6 3.4-.3 1.9-1.3 2 3.7 4.1 4.8 3.5 5.1 4.8 5.7 3.1 1.5-.1.5-5.2.5-.8-.2-2.5-2.3-2.7-1.8-.4-1.6-1.8 1.2-2.8-.6-3.1.3-1.8z",
    ls: "M1128.1 766.5l1.1-2 3.1-1 1.1-2.1 1.9-3.1-1.7-1.9-2.3-2-2.6 1.3-3.1 2.5-3.2 4 3.7 4.9 2-.6z",
    lt: "M1100.4 221.2l-5-2.9-2.5-.4-.9-1.3-4.4.6-7.9-.4-5 1.9 1.7 5 5 1.1 2.2.9-.2 1.7.6 1.5 2.5.6 1.4 1.9h4.6l4.8-2.2.5-3.4 3.5-2-.9-2.6z",
    lu: "M1007 258.6l.2-2.7-1-1.4-1.3.2-.4 3.5 1.1.5 1.4-.1z",
    lv: "M1102.1 210.1h-3.8l-4.4-2.2-2.1-.7-3.7 1-.2 4.6-3.6.1-4.4-4.5-4 2.1-1.7 3.7.5 4.5 5-1.9 7.9.4 4.4-.6.9 1.3 2.5.4 5 2.9 2.6-1 4.6-2.3-2.1-3.6-1-2.8-2.4-1.4z",
    ly: "M1111.8 371.4l-1.5-2.1-5.4-.8-1.8-1.1h-2l-2-2.8-7.3-1.3-3.6.8-3.7 3-1.5 3.1 1.5 4.8-2.4 3-2.5 1.6-5.9-3.1-7.7-2.7-4.9-1.2-2.8-5.7-7.2-2.8-4.5-1.1-2.2.6-6.4-2.2-.1 4.9-2.6 1.8-1.5 2-3.7 2.5.7 2.6-.4 2.7-2.6 1.4 1.9 5.6.4 3-.9 5.2.5 2.9-.6 3.5.5 4-2.1 2.6 3.4 4.7.2 2.7 2 3.6 2.6-1.2 4.3 2.9 2.5 4 8.8 2.8 3.1 3.5 3.9-2.4 5.4-3.5 22.3 12.2 22.4 12.2v-2.7h6.3l-.5-12.7-1-23.4-1.3-22.7-2-5.1 1.2-3.9-1.1-2.7 1.8-3z",
    ma: "M965.2 348.4l-2.3-.1-5.5-1.4-5 .4-3.1-2.7h-3.9l-1.8 3.9-3.7 6.7-4 2.6-5.4 2.9-3.5 4.3-.9 3.4-2.1 5.4 1.1 7.9-4.7 5.3-2.7 1.7-4.4 4.4-5.1.7-2.8 2.4-.1.1-3.6 6.5-3.7 2.3-2.1 4-.2 3.3-1.6 3.8-1.9 1-3.1 4-2 4.5.3 2.2-1.9 3.3-2.2 1.7-.3 3h.1l12.4-.5.7-2.3 2.3-2.9 2-8.8 7.8-6.8 2.8-8.1 1.7-.4 1.9-5 4.6-.7 1.9.9h2.5l1.8-1.5 3.4-.2-.1-3.4h.8l.1-7.5 8.9-4.7 5.4-1 4.4-1.7 2.1-3.2 6.3-2.5.3-4.7 3.1-.5 2.5-2.4 7-1 1-2.5-1.4-1.4-1.8-6.7-.3-3.9-2-4.1z",
    md: "M1118.5 283.3l1.2-.7.5-2.1 1.1-2-.5-1.1 1-.5.6.9 3 .2 1.2-.5-1-.6.2-1-2-1.5-1.1-2.6-1.9-1.1v-2.1l-2.5-1.6-2-.3-3.9-1.9-3.2.6-1.1.9 1.6.6 1.8 1.9 1.9 2.6 3.4 3.7.6 2.7-.2 2.7 1.3 2.8z",
    me: "M1080 299.8l.4-.6-2-1.2-1.8-.7-.8-.8-1.5-1.1-.9.6-1.5 1.4-.4 3.4-.5 1 2.3 1.2 1.6 2.1 1.1.4-.5-1.9 2-3.1.4 1.2 1.3-.5.8-1.4z",
    mg: "M1255.7 658.4l-1.1-4.2-1.4-2.7-1.8-2.7-2 2.8-.3 3.8-3.3 4.5-2.3-.8.6 2.7-1.8 3.2-4.8 3.9-3.4 3.7h-2.4l-2.2 1.2-3.1 1.3-2.8.2-1 4.1-2.2 3.5.1 5.9.8 4 1.1 3-.8 4.1-2.9 4.8-.2 2.1-2.6 1.1-1.3 4.6.2 4.6 1.6 5-.1 5.7 1.2 3.3 4.2 2.3 3 1.7 5-2.7 4.6-1.5 3.1-7.4 2.8-8.9 4.3-12 3.3-8.8 2.7-7.4.8-5.4 1.6-1.5.7-2.7-.8-4.7 1.2-1.9 1.6 3.8 1.1-1.9.8-3.1-1.3-2.9-.5-7.7z",
    mk: "M1094 304.8l-2.8-2-2.4.1-1.7.4-1.1.2-2.9 1-.1 1.2h-.7l-.4 2.1.9 2.6 2.3 1.6 3.3-.6 1.9-1.3 2.8.1.7-1.1 1-.2-.8-4.1z",
    ml: "M1000.3 450.3l-6.1.6-.1-4-2.6-1.1-3.4-1.8-1.3-3-18.6-13.8-18.4-13.9-8.4.1 2.4 27.4 2.4 27.5 1 .8-1.3 4.4-22.3.1-.9 1.4-2.1-.4-3.2 1.3-3.8-1.8-1.8.2-1 3.7-1.9 1.2.2 3.9 1.1 3.7 2.1 1.8.4 2.4-.3 2 .3 2.3h.9l1.5-.8.9.2 1.5 1.6 2.4.5 1.6-1.4 1.8-.8 1.3-.9 1.1.2 1.3 1.4.6 1.7 2.3 2.7-1.2 1.6-.2 2.1 1.2-.6.7.7-.3 1.9 1.7 1.8.7-.6 1.6 1 4.3.1 1-1.9 1 .1 1.6-.7.9 2.7 1.3-.8 2.3-.9-.4-3.7 1.6-2.7-.2-2.2 4.5-5.2.8-4.4 1.6-1.6 2.7.9 2.3-1.3.8-1.6 4.3-2.9 1.1-2 5.2-2.6 3-.9 1.4 1.2h3.6l3.6-.3 2-2.2 7.6-.6 4.9-1 .5-3.9 3-4.3-.1-14.6z",
    mm: "M1533.9 435.8l-.6-2.6-3.8 1.8-2.5-1.2-4.5-2.4.8-5.2-3.7-1.3-2.3-5.8-5.6 1-.7-7.5 4.1-5.3-.8-5.3-1.3-4.9-2.7-1.5-2.7-3.7-3 .4.9 2.4-1.6 1.2 1.3 3.9-4.1-1.1-6.1 4.4.9 3.6-2.1 5.4.3 3.1-1.5 5.2-4.6-1.4.9 6.6-.9 2.1.9 2.7-2.4 1.5.5 4.6-2.1-1 1.1 5.1 4.6 5.2 3.4.9-.4 2.2 5.4 7.4 1.9 5.9-.9 7.9 3.6 1.5 3.2.6 5.8-4.6 3.2-3.1 3.1 5.2 2 8.1 2.6 7.6 2.6 3.3.2 6.9 2.2 3.8-1.3 4.8.9 4.8 2.2-6.6 2.6-5.9-2.8-5.8-.2-3-1-3.5-4.2-5.1-1.7-3.2 1.7-1.1 1.4-5.6-2.9-4.2-4.1-4.6-3.5-5.6 2.2-1.1 1.5-6.9 3.9-.3 2.8-2.8 3-1.4.8-2.4 4.1-4.1z",
    mn: "M1473.7 252.1l-3.7-4.6-6.6-1.5-4.8-.8-6.9-2.5-1.3 6.4 4 3.6-2.4 4.3-7.9-1.6-5-.2-4.7-2.9-5.1-.1-5.3-1.9-5.9 2.9-6.6 5.4-4.7 1 3.3 4.4 5.7 3.3 8.1 2.3 5.8 5 1.3 7.3 3 2.7 6.4 1 7.2.9 7.9 3.8 3.4.7 4.9 5.7 4.7 3.6 5.5-.1 11.2 1.3 6.4-.8 5.5.9 9.3 3.8 6.2-.1 3.2 2 4.4-3.3 7.2-2.2 7.5-.2 4.9-2.2 1.9-3.3 2.5-2-1.9-2.1-2.9-2.3.4-4 3.2.5 5.9 1.3 3.1-3.3 6.3-2.4 1.4-4.1 2.4-1.8 6.8-.8 4.3.7-.7-2.2-7.2-4.3-5.1-2-2.5 2.3-5.4-1-2.4.8-2.7-2.6-.3-6.2-.6-4.6-5.5.5-3.9-2.1-3.3-.7-4.5 4.4-5.8 1-3.6 1.6-6.7-1h-4.5l-4.9-3.1-6.5-3-5.4-.8-5.7.8-3.9 1.1-8.4-2.6z",
    mq: "M638 479.9l-.2-.7-.1-.2-.2-.3.1-.3v-.1h-.2l-.3-.5-.6-.3h-.3l-.2.2v.3l.3.9.2.2.5.2-.4.4v.1l.1.3h.9l.2.3.1-.1.1-.4z",
    mr: "M949.8 413.3l-20.3-15.5-.2 9.7-17.9-.3-.2 16.3-5.2.5-1.4 3.3.9 9.2-21.6-.1-1.2 2.2 2.8 2.7 1.4 3-.7 3.2.6 3.2.5 6.3-.8 5.9-1.7 3.2.4 3.4 2-2 2.7.5 2.8-1.4h3.1l2.6 1.8 3.7 1.7 3.2 4.7 3.6 4.4 1.9-1.2 1-3.7 1.8-.2 3.8 1.8 3.2-1.3 2.1.4.9-1.4 22.3-.1 1.3-4.4-1-.8-2.4-27.5-2.4-27.4 8.4-.1z",
    ms: "M631.8 465.7l-.1-.5h-.1l-.2.4v.3l.3.1.1-.3z",
    mt: "M1053.6 344l-.2-.2-.5-.5-.5-.1.1.6.4.4h.5l.2-.2zm-1.4-1.2v-.2l-.3-.1-.4.1.1.1.3.2.3-.1z",
    mu: "M1294.7 702.5l.3-.3.2-.4.3-.3.1-.7-.2-.8-.4-.7-.5.1-.3.4-.2.5-.5.3-.1.3-.2.7-.1.4-.2.1v.2l.3.3.8.1.7-.2z",
    mv: "M1389.1 551.6l.1-.1v-.2l-.1-.1h-.1l-.1.2v.2h.2zm.3-5.9l.1-.2v-.4l-.1.1-.1.2v.1l-.1.1v.1h.2z",
    mw: "M1169.2 661.5l.1-2.3-1.2-1.9.1-2.8-1.5-4.7 1.7-3.5-.1-7.7-1.9-4.1.2-.7-1.1-1.7-5.4-1.2 2.6 2.8 1.2 5.4-1 1.8-1.2 5.1.9 5.3-1.8 2.2-1.9 5.9 2.9 1.7 3 3 1.6-.6 2.1 1.6.3 2.6-1.3 2.9.2 4.5 3.4 4 1.9-4.5 2.5-1.3-.1-8.2-2.2-4.6-1.9-2h-.3v.8l1.1.3 1 3.4-.2.8-1.9-2.5-1 1.6-.8-1.4z",
    mx: "M444.4 407.8l-3.6-1.4-3.9-2-.8-3-.2-4.5-2.4-3.6-1-3.7-1.6-4.4-3.1-2.5-4.4.1-4.8 5-4-1.9-2.2-1.9-.4-3.5-.8-3.3-2.4-2.8-2.1-2-1.3-2.2h-9.3l-.8 2.6h-15l-10.7-4.4-7.1-3.1 1-1.3-7 .7-6.3.5.2 5.7.7 5.1.7 4.1.8 4 2.6 1.8 2.9 4.5-1 2.9-2.7 2.3-2.1-.3-.6.5 2.3 3.7 2.9 1.5 1 1.7.9-.9 3.1 2.9 2.1 2 .1 3.4-1.2 4.7 2.5 1.6 3.3 3.1 2.9 3.6.7 3.9h1l2.7-2.3.4-1.2-1.5-2.8-1.6-2.9-2.6-.2.4-3.4-.9-3-1-2.8-.5-5.9-2.6-3.2-.6-2.3-1.2-1.6v-4.1l-1 .1-.1-2.2-.7-.5-.4-1.4-2.7-4.4-1.1-2.6 1-4.8.1-3 1.8-2.6 2.4 1.7 1.9-.2 3.1 2.5-.9 2.4.4 4.9 1.5 4.7-.4 2 1.7 3.1 2.3 3.4 2.7.5.3 4.4 2.4 3.1 2.5 1.5-1.8 4 .7 1.5 4.1 2.6 1.9 4 4.5 4.9 3.8 6.4 1.3 3.2v2.5l1.4 2.9-.3 2.2-1.6 1.6.3 1.8-1.9.7.8 3.1 2.2 4 5.3 3.6 1.9 2.9 5.4 2 3 .4 1.2 1.7 4.2 3 5.9 3 4 .9 4.8 2.9 4 1.2 3.7 1.7 2.9-.7 4.8-2.4 3.1-.4 4.4 1.6 2.6 2.1 5.5 6.9.4-1.9.8-1.5-.7-1.2 3.3-5.2h7.1l.4-2.1-.8-.4-.5-1.4-1.9-1.5-1.8-2.1h2.6l.4-3.6h5.2l5.1.1.1-1 .7-.3.9.8 2.5-3.9h1l1.2-.1 1.2 1.6 2-5 1.2-2.7-.9-1.1 1.8-3.9 3.5-3.8.6-3.1-1.2-1.3-3.4.5-4.8-.2-6 1.5-4 1.7-1.2 1.8-1.2 5.4-1.8 3.7-3.9 2.6-3.6 1.1-4.3 1.1-4.3.6-5.1 1.8-1.9-2.6-5.6-1.7-1.8-3.2-.7-3.6-3-4.7-.4-5-1.2-3.1-.5-3.4 1.1-3.1 1.8-8.6 1.8-4.5 3.1-5.6-2.1.2z",
    my: "M1543.6 532.7l-4.7-2.8-.9 1.1 1.4 2.7-.4 4.7 2.1 3.4 1 5.3 3.4 4.3.8 3.2 6.7 5 5.4 4.8 4-.5.1-2.1-2.3-5.6-2.1-1.8-.5-3.8-.6-2.1.5-2.9-.5-4.3-2.6-4.3-3.5-3.8-1.3-.6-1.7 2.6-3.7.8-.6-3.3zm99 11l-1.2-3.1 3.8-.4.3-2.4-4.8-2-3.8-1.7-.4-2.8-3.1-3.2h-2.3l-2.5 5-4.1 4.4-.1 3.1-.1 4.1-2.7-.2-1.1 2.2-2.7-3.3-2.6 4-3.8 5-6.7 1.4-2.4 1.2-.9 5.4-4.4 1.2-4.1-2.2 1 4.3 3.9 3.5 3.6-1.2 3.6.4 3.2-3.2 2.7-.6 5.4 1.8 4.5-1.3 2.7-8.9 2-2.2 1.7-7.2h6.4l5 1 4-2.1z",
    mz: "M1203 640.7l-.8-2.9-4.6 3.7-6.2 2.5-3.3-.1-2.1 1.9-3.9.1-1.4.8-6.7-1.8-2.1.3-1.6 6 .7 7.3h.3l1.9 2 2.2 4.6.1 8.2-2.5 1.3-1.9 4.5-3.4-4-.2-4.5 1.3-2.9-.3-2.6-2.1-1.6-1.6.6-3-3-17.1 5.2.3 4.5.3 2.4 4.6-.1 2.6 1.3 1.1 1.6 2.6.5 2.8 2-.3 8.1-1.3 4.4-.5 4.7.8 1.9-.8 3.7-.9.6-1.6 4.6-6.2 7.2 2.2 9 1.1 4.5-1.4 7.1.4 2.3.6 2.9.3 2.8h4.1l.7-3.3-1.4-.5-.3-2.6 2.6-2.4 6.8-3.4 4.6-2.2 2.5-2.3.9-2.6-1.2-1.1 1.1-3 .5-6.2-1 .3v-1.9l-.8-3.7-2.4-4.8.7-4.6 2.3-1.4 4.1-4.6 2.2-1.1 6.7-6.8 6.4-3.1 5.2-2.5 3.7-3.9 2.4-4.4 1.9-4.6-.9-3.1.2-9.9-.4-5.6.4-6.3z",
    na: "M1105.4 683.7l-10.3 2.5-13.4-.9-3.7-3-22.5.3-.9.4-3.2-2.9-3.6-.1-3.3 1-2.7 1.2.2 4.9 4.4 6.2 1.1 4 2.8 7.7 2.7 5.2 2.1 2.6.6 3.5v7.6l1.6 9.8 1.2 4.6 1 6.2 1.9 4.7 3.9 4.8 2.7-3.2 2.1 1.8.8 2.7 2.4.5 3.3 1.2 2.9-.5 5-3.2 1.1-23.6.6-18.5 5.4-.2.9-22.7 4.1-.2 8.6-2.2 2 2.6 3.7-2.5h1.6l3.2-1.5v-.5l-2.1-1.4-3.6-.4-4.6 1.5z",
    nc: "M1897.3 716.1v-.3l-.4-.2-.2.5v.1l.2.1h.2l.2-.2zm4.6-7.6l-.1-.1v-.3l.1-.2-.4.2-.6.2.1.8-.1.4.3.1.1.3h.2l.7-.2.3-1.1h-.4l-.2-.1zm-3-1.7l.3-.5.1-.2-.2-.7-.3-.3.3-1-.1-.2-.4-.2-.9.3-.1.2.5.1.2.2-.5.7-.5.1.1.5.2.4.7.2.3.4h.3zm-3.9-2.9l.3-.3.3-.4-.1-.1v-.3l.2-.4.3-.1-.2-.2-.2-.1v.3l-.3.7-.1.3-.5.6h.3zm-12.3-2.9l-.6-.7-.1.2-.1.4v.3l.3.2.1.2-.1.5v.4l.6.9.1.7.3.6.5.5.4.5.8 1.4.2.5.4.3 1 1.2.4.4.4.2.9.7.6.3.3.5.6.3.8.4.1.2v.3l.1.3.5.4.6.3.1.2.1.2.3-.1.3.1.9.7.4-.1h.3l.5-.2.3-.4-.1-1.1-.5-.5-.7-.4-.4-.5-.4-.5-.8-1-1.1-1-.5-.2-.3-.4-.3-.1-.2-.3-.5-.3-.3-.6-.6-.6-.1-.3.1-.3-.1-.3-.4-.3-.2-.5-.2-.3-.4-.2-.7-.4-1.6-1.9-.7-.6-.7.2-.6-.4zm-22-6l.2-.4.1-.8-.2.4-.2 1 .1-.2z",
    ne: "M1051.3 425.6l-8.8-2.8-18.6 12.2-15.8 12.5-7.8 2.8.1 14.6-3 4.3-.5 3.9-4.9 1-7.6.6-2 2.2-3.6.3-.5 3.1.8 2.9 3.1 4.1.2 3.1 6.4 1.4-.1 4.4 1.9-1.9h2l4.3 3.7.3-5.7 1.6-2.6.8-3.6 1.4-1.4 6-.8 5.6 2.4 2.1 2.4 2.9.1 2.6-1.5 6.8 3.3 2.8-.2 3.3-2.7 3.3.2 1.6-.9 3 .4 4.3 1.8 4.3-3.5 1.3.2 3.9 7 1-.2.2-2 1.6-.4.5-2.9-3.6-.2v-4.1l-2.4-2.3 2.3-8.4 6.9-6 .2-8.3 1.8-12.9 1.1-2.7-2.3-2.2-.2-2.1-2-1.6-1.6-9.9-3.9 2.4-3.1-3.5z",
    ng: "M1055.8 492.7l-1 .2-3.9-7-1.3-.2-4.3 3.5-4.3-1.8-3-.4-1.6.9-3.3-.2-3.3 2.7-2.8.2-6.8-3.3-2.6 1.5-2.9-.1-2.1-2.4-5.6-2.4-6 .8-1.4 1.4-.8 3.6-1.6 2.6-.3 5.7-.2 2.1 1.2 3.8-1.1 2.5.6 1.7-2.7 4-1.7 1.9-1 4 .1 4.1-.3 10.2h9.2l3.9 4.2 1.9 4.6 3 3.9 4.5.2 2.2-1.4 2.1.3 5.8-2.3 1.4-4.5 2.7-6.1 1.6-.1 3.3-3.7 2.1-.1 3.2 2.6 3.9-2.2.5-2.6 1.2-2.6.8-3.2 3-2.6 1.1-4.5 1.2-1.4.7-3.3 1.5-4 4.6-5 .3-2.1.6-1.1-2.3-2.6z",
    ni: "M514.1 476.8l-1.9-.2-.9.9-2 .8h-1.4l-1.3.8-1.1-.3-.9-.9-.6.2-.8 1.5-.5-.1-.3 1.3-2.1 1.8-1.1.7-.6.8-1.5-1.3-1.4 1.7h-1.2l-1.3.2-.2 3.1h-.8l-.8 1.5-1.8.3-.4.4-.9-1-.7 1 2.6 2.9 2.2 2 1 2.1 2.5 2.6 1.8 2 .9-.8 3.5 1.7 1.4-.8 1.7.5.8 1.3 1.7.4 1.4-1.3-.8-1.1-.1-1.7 1.2-1.6-.2-1.7.7-2.7.9-.7.1-2.8-.2-1.7.4-2.8.9-2.5 1.4-2.2-.3-2.3.4-1.4.6-.6z",
    nl: "M1005.5 243.9h2.9l1.1-2.3 1-5.6-1-2-3.9-.2-6.5 2.6-3.9 8.9-2.5 1.7 3.6.5 4.4-1.3 3.1 2.7 2.8 1.4-1.1-6.4z",
    no: "M1088.8 133.1l-6.9 1.1-7.3-.3-5.1 4.4-6.7-.3-8.5 2.3-10.1 6.8-6.4 4-8.8 10.7-7.1 7.8-8.1 5.8-11.2 4.8-3.9 3.6 1.9 13.4 1.9 6.3 6.4 3 6-1.4 8.5-6.8 3.3 3.6 1.7-3.3 3.4-4 .9-6.9-3.1-2.9-1-7.6 2.3-5.3 4.3.1 1.3-2.2-1.8-1.9 5.7-7.9 3.4-6.1 2.2-3.9 4 .1.6-3.1 7.9.9v-3.5l2.5-.3 2.1-1.4 5.1 2.9 5.3-.3 4.7 1.3 3.4-2.4 1.1-3.9 5.8-1.8 5.7 2.1-.8 3.8 3.2-.5 6.4-2.2-5.4-3.3 4.8-1.4-13.6-3.9zm-22.6-33.3l-5.6-1-1.9-1.7-7.2.9 2.6 1.5-2.2 1.2 6.7 1.1 7.6-2zm-25.4-8.3l-4.8-1.6-5.1.2-1 1.5h-5l-2.2-1.5-9.3 1.6 3.2 3.5 7.6 3.8 5.7 1.4-3 1.7 8.4 2.9 4.4-.2.9-3.9 3-.9 1.2-3.4 8.5-1.8-12.5-3.3zm24.2-3.1l-9.1-1-3.2 1.2-5.3-1-10.4 1.2 4.3 2h5.1l.9 1.3 10.6.7 10.1-.5 4.3-2.4-7.3-1.5z",
    np: "M1455.2 394.8l-6.5-.6-6.4-1.5-5-2.8-4.5-1.2-2.5-3.1-3.2-.9-6.4-4.1-4.7-2-1.9 1.5-2.8 2.9-.9 5.9 5.7 2.5 5.8 3.1 7.7 3.5 7.6.9 3.8 3.2 4.3.6 6.8 1.5 4.6-.1.1-2.5-1.5-4.1-.1-2.7z",
    nr: "M1915 575.5v-.2h-.2l-.1.2.1.1.1.1.1-.2z",
    nz: "M1868.6 832.8l.9-2.6-5.8 2.9-3.4 3.4-3.2 1.6-5.9 4.6-5.6 3.2-7 3.2-5.5 2.4-4.3 1.1-11.3 6.1-6.4 4.6-1.1 2.3 5.1.4 1.5 2.1 4.5.1 4-1.8 6.3-2.8 8.1-6.2 4.7-4.1 6.2-2.3 4-.1.6-2.9 4.6-2.5 7-4.5 4.2-2.9 2.1-2.6.5-2.6-5.6 2.5.8-2.6zm28.8-30.5l1.9-5.7-3.1-1.7-.8-3.6-2.3.5-.4 4.6.8 5.7.9 2.7-.9 1.1-.6 4.4-2.4 4.1-4.2 5-5.3 2.2-1.7 2.4 3.7 2.5-.8 3.5-6.9 5.1 1.4.9-.4 1.6 5.9-2.5 5.9-4.2 4.5-3.4 1.6-1.2 1.5-2.7 2.8-2 3.8.2 4.2-3.8 5.1-5.7-2.1-.8-4.6 2.5-3.2-.5-2.9-2.1 2.3-4.9-1.2-1.8-2.9 4.4.4-6.8z",
    om: "M1301 437.8l2.1-2 .8-1.8 1.6-3.8-.1-1.4-2.1-.8-1.6-2.1-2.9-3.7-3.3-1.1-4.1-.9-3.3-2.3-2.9-4.3h-2.8l-.1 4.2 1.1.8-2.4 1.3.3 2.6-1.4 2.6.1 2.6 2.9 4.5-2.6 12.7-16.1 6.4 5.2 10.5 2.1 4.4 2.5-.3 3.6-2.2 3.1.6 2.5-1.8-.2-2.5 2.1-1.6h3.4l1.2-1.3.2-3.1 3.3-2.4h2.6l.4-.8-1-4.2.6-3.2 1-1.5 2.5.3 1.7-4.4zm-16.6-30.4l.2-2.6-.7-.6-1.3 2.2 1.3 2.2.5-1.2z",
    pa: "M543.5 517l-2-1.8-1.7-1.9-2.5-1.1-3.1-.2.3-.6-3.1-.4-2 1.9-3.5 1.3-2.5 1.6-2.7.5-1.5-1.6-.5.5-2.3-.3.2-1.3-1.9-2.3-2.2.6-.1 2.5 1.1 1-.8.7.1 1.2-.5 1.3-.4 1.2.6 1 .3-1.4h2.4l1.4.7 2.3.5 1 2.5 1.8.4.8-1.1.8 3.8 2.6-.3.9-.9 1.5-.9-2.5-3.4.6-1.3 1.3-.3 2.3-1.6 1.2-2.2 2.5-.4 2.7 1.8 1 2.1 1.4.4-1.5 1.7 1 3.5 1.8 1.8.9-3.1 1.8.5 1.1-1.9-1.1-3.8.7-.9z",
    pe: "M584.3 599.5l-2.9-3.4-1.7-.1 3.5-6.5-4.4-3-3.3.6-2.1-1.1-3 1.7-4.2-.8-3.4-6.7-2.7-1.7-1.8-3-3.7-3-1.5.6.8 4.9-1.7 4.1-6 6.7-6.7 2.5-3.3 5.5-.9 4.3-3.1 2.6-2.5-3.2-2.3-.7-2.3.5-.2-2.3 1.5-1.5-.7-2.7-4.4 4-1.6 4.5 3 6.1-1.7 2.8 4.1 2.6 4.5 4.1 2 4.7 2.4 2.9 6 12.7 6.2 11.7 5.4 8.4-.8 1.8 2.8 5.3 4.6 3.9 10.7 6.9 11.6 6.4.7 2.6 5.9 3.7 2.7-1.6 1.2-3.3 2.8-6.9-2.8-5.3 1.1-2.1-1.2-2.4 1.9-3.2-.3-5.4-.1-4.5 1.1-2.1-5.5-10.3-3 1.1-2.6-.7-.2-9.7-4.4 3.8-4.9-.2-2.3-3.4-3.7-.3 1-2.8-3.3-3.8-2.6-5.8 1.5-1.1-.1-2.7 3.3-1.9-.7-3.4 1.3-2.2.4-3 6.2-4.3 4.6-1.2.7-1 5.1.3z",
    pf: "M213.2 704.9l-.1-.3-.2-.3-.1.1.1.1.2.3v.2l.1-.1zm9.3-14.7l-.2-.2-.4-.2-.2-.1-.2-.1-.1.1.1.1h.1l.3.2.3.1.2.1v.1l.1-.1zm-24.5-1.1l-.6-.3.1.2.4.2.2.1-.1-.2zm20.5-.2l-.4-.5h-.3l.7.6v-.1zm-21.6-1l-.4-.4-.2-.3-.3-.1.1.1.4.4.3.4.2.1-.1-.2zm-.3-2.1l-.1-.1v-.3l.2-.3.6-.4v-.1l-.2.1-.4.2-.2.2-.1.2-.1.3.1.2.1.1h.2l-.1-.1zm-47.4-1.1l-.2-.6-.3-.5-.8-.1-.5.2-.1.2.1.4.5.7.5.1.8-.1.4.6.2.1.4.1.1-.3-.2-.5-.9-.3zm-2.9-.9l.1-.4-.2-.1h-.5v.2l.1.2.1.1.3.2.1-.2zm-9.7-4.3h.2l-.4-.6-.3-.2V679.5l.3.1.2-.1zm43.9-1.6h-.6l.5.1.4.2-.3-.3zm-.7.1l-.3-.1-.3-.2h-.3l.7.3h.2zm-43.8.1l.1-.2-.1-.1-.4-.2.1.3v.2l.2.1.1-.1zm32.8-2l-.3-.4-.2-.3-.2-.4-.4-.5.1.3.1.2.2.2.2.4.1.2.3.4h.1v-.1zm16.2-1.5l.1-.5h-.2v.5h.1zm-14.4-1.6l-.6-.6h-.1l.1.2.5.5.1.2v-.3zm30.8-33.9l.1-.2v-.2l-.1-.1-.3-.1.1.7.2-.1zm-2.7-3.7l-.1-.2h-.2l-.1.1v.5l.4-.4zm.1-1.6l-.8.5.2.4.4.1.2-.2.8-.1.3-.4-.3.1-.8-.4zm-6.1-1.7l.2-.5-.2-.1-.4.2v.2l.3.4.1-.2zm2.6-3.1l.3-.1v-.1l-.2-.2-.3-.1-.1.1-.1.2.1.3.3-.1zm-2.9-.1l.1-.3v-.2l-.1-.2-.9-.2-.1.1v.4l.2.5h.3l.5-.1z",
    pg: "M1850.7 615.6l.9-1.8-2.4-2.2-2.5-4-1.6-1.5-.5-1.9-.8.7.9 4.8 2.2 4 2.2 2.5 1.6-.6zm-21.2-8.6l2.1-3.9.4-3.5-1.1-1-3.4.1.4 3.7-3.3 2.3-1.7 2.2-3.2.5-.4-3.4-.8.1-1 3.1-3.1.5-5-.9-.6 1.9 3.1 1.8 4.5 1.9h2.9l3-1.5 3.2-1.6 1-1.8 3-.5zm-27.8 12.2l-.9-4.3 5.2-.7-1.1-3.3-9.1-4-.6-3.7-2.9-3.2-3.7-3.3-10.2-3.6-9.6-4.4-1 20.7-1.5 20.8 5.7.2 3.1 1.1 4.6-2.2-.3-4.7 3.6-2.1 4.9-1.8 7 2.8 2.4 5.6 2.9 3.5 3.9 4 5.5 1 4.8.7 1.1 1.6 3.8-.4.8-1.8-5.6-2.7 1.8-1.2-4.2-1.1.5-2.8-3.2.2-3-6.8-4.7-4.1zm34.7-18.4l-.5-3.3-2-2.1-2.1-2.6-2.3-1.5-1.9-1.4-2.9-1.8-1.6 1.5 3.9 1.9 3.1 2.7 2.4 2.1 1.2 2.4.8 3.8 1.9-1.7z",
    ph: "M1684.6 518.6l-.6-2.3-.8-3.2-4.8-3 .8 4.9-3.9.2-.7 2.8-4.2 1.7-2.2-2.8-2.8 2.4-3.4 1.7-1.9 5.4 1.1 1.9 3.9-3.6 2.7.3 1.5-2.7 3.8 3-1.5 3.1 1.9 4.6 6.8 3.7 1.4-3-2.1-4.7 2.4-3.2 2.5 6.4 1.5-5.8-.6-3.5-.8-4.3zm-14.5-11.8v-6.1l-3.6 6.1.5-4.2-3 .3-.3 4-1.2 1.8-1 1.7 3.8 4.4 1.6-1.9 1.4-4 1.8-2.1zm-30.1 6.1l2.6-4.4 3.4-3.5-1.5-5.2-2.4 6.3-2.9 4.4-3.8 4-2.4 4.4 7-6zm17.4-16.4l1.2 3-.1 3.3.5 2.9 3.3-1.9 2.4-2.7-.2-2.6h-3.6l-3.5-2zm20-1.7l-1.8-2.4-5.4-.1 4 4.8.3 2.4-3.3-.5 1.2 3.9 1.7.3.7 4.5 2.5-1.4-1.7-4-.4-2.1 4.5 1.7-2.3-7.1zm-22.9-5.8l-2.2-2.3-4.8-.2 3.4 4.8 2.8 3.2.8-5.5zm-6.4-34.6h-3.3l-.9 5.8 1.1 9.9-2.6-2 1.2 6 1.2 2.8 3.3 3.7.4-2.3 1.8 1.4-1.5 1.7.1 2.6 2.9 1.4 5-.9 4 3.8 1.1-2.4 2.5 3.4 4.8 3.1.2-2.9-2-1.6.1-3.4-7.5-3.6-2.3.8-3.1-.7-2-5.1.1-5.1 3-2.1.6-5.3-2.7-4.6.4-2.6-.7-1.6-1.5 1.6-3.7-1.8z",
    pk: "M1388.3 346.3l-9.4-2.6-2.9-5-4.7-3-2.8.7-2.4 1.2-5.8.8-5.3 1.3-2.4 2.8 1.9 2.8 1.4 3.2-2 2.7.8 2.5-.9 2.3-5.1-.2 3 4.2-3 1.6-1.5 3.8 1.1 3.8-1.7 1.8-2.1-.6-4 .9-.2 1.7h-4l-2.3 3.6.8 5.4-6.6 2.6-3.8-.5-.9 1.4-3.3-.8-5.3.9-9.6-3.2 3.2 3.3 2.8 3.9 5.6 2.7 1 5.7 2.7 1 .9 2.9-7.4 3.3-1.2 7.4 7.6-.9 8.9-.1 9.9-1.2 4.9 4.8 2.1 4.6 4.2 1.6 3.2-4.2h12l-1.8-5.5-3.5-3.2-1.3-4.9-4-2.9 4.9-6.6 6.4.5 4.5-6.7 2.1-6.5 3.9-6.3-1-4.5 3.7-3.7-5-3.1-2.9-4.3-3.2-5.6 1.9-2.8 8.5 1.6 5.7-1 3.7-5.4z",
    pl: "M1069.4 228.3l-4.6-.1-.5-1.4-4.8-1.1-5.7 2.1-7.1 2.8-3.1 1.7 1.4 3.1-1.2 1.6 2 2.2 1.4 3.3-.1 2.1 2.3 3.9 2.4 1.9 3.7.6-.1 1.7 2.7 1.2.6-1.5 3.4.6.7 2 3.6.3 2.6 3.1.3.4 1.9-.9 2.7 2.2 2.8-1.3 2.4.6 3.4-.8 4.9 2.3 1.1.4-1.6-2.8 3.8-5.1 2.3-.7.3-1.8-3.1-5.3-.5-2.7-1.9-2.9 2.7-1.2-.3-2.4-1.7-2.3-.6-2.7-1.4-1.9-2.5-.6-8.7.1-5.9-.7z",
    pn: "M274.2 727.4v-.2l-.1-.2-.2-.1-.1.1.1.2.2.2.1.1v-.1z",
    pr: "M600.8 457.3v-.1h.1v-.1l.1-.1v-.1h-.5v.2l.2.1v.1h.1zm13.6-.3l.7-.2v-.1l-.4-.1h-.6l-.5.2.1.2h.7zm-3.7-2.2l-.1-.2h-.2l-3.5-.1-1.3-.2-.3.1-.3.1-.1.4-.2.2-.3.2.1.3.1.2.2.4-.1.5-.2 1 .3.2.7-.1.3.1.3.1.4-.1.4-.2.9.1.5-.1.6.3.4-.1.2.1H610.4l.9-.2.8-.5.3-.5.4-.3.6-.4v-.9l-.7-.1-.6-.3-1.1-.1h-.1l.1.2h-.1l-.2-.1z",
    ps: "M1166.9 366.1l-2-.9-.7 4.3 1.4.7-1.2.8-.1 1.7 2.4-.8.6-1.9-.4-3.9z",
    pt: "M937.6 335.9l-.4-2.1 2-2.5.8-1.7-1.8-1.9 1.6-4.3-2-3.8 2.2-.5.3-3 .9-.9.2-4.9 2.4-1.7-1.3-3.1-3-.2-.9.8h-3l-1.2-3.1-2.1.9-1.9 1.6.1 2.1.9 2.2.1 2.7-1.3 3.8-.4 2.5-2.2 2.3-.6 4.2 1.2 2.4 2.3.6.4 4-1 5.1 2.8-.7 2.7.9 2.2-1.7z",
    py: "M655.7 700.5l-.3-1.9-5.4-3.3-5.1-.1-9.5 1.9-2.1 5.6.2 3.4-1.5 7.6 11.2 10.4 4.6 1 7.2 4.7 5.9 2.5 1.1 2.8-4.2 9.6 5.7 1.8 6.2 1 4.2-1.1 4.3-4.8.3-5.7.7-3.6.3-3.8-.3-3.5-2.1-1.2-2 1.1-2-.3-.9-2.5-1-5.8-1.2-1.9-3.9-1.7-2.1 1.2-6-1.2-.4-8.6-1.9-3.6z",
    qa: "M1258 415.5l.8-3.8-.5-3.7-1.9-2-1.4.7-1.1 3.3.8 4.7 1.8 1.2 1.5-.4z",
    re: "M1284 707.9l.2-.4.1-.8-.4-.8-.4-.7-.4-.2-.8-.1-.7.3-.4.6-.2.3.4 1.1.2.3 1.1.6h.5l.8-.2z",
    ro: "M1108.1 266.3h-2.1l-1 1.5-3.6.6-1.6.9-2.4-1.5h-3.2l-3.2-.7-1.9 1.3-2.9 1.3-1.9 4.2-2.6 4.3-3.8 1.1 2.9 2.5.8 1.9 3.2 1.5.7 2.5 3.1 1.8 1.4-1.3 1.4.7-1.1 1.1 1 1 1.8 2.6 1.9-.5 4 1 7.5.3 2.3-1.6 5.8-1.4 4 2.2 3 .7.4-7.4 1.6.5 2.3-1.3-.4-1.6-2.4-1.1-2.2 1-2.4-1.1-1.3-2.8.2-2.7-.6-2.7-3.4-3.7-1.9-2.6-1.8-1.9-1.6-.6z",
    rs: "M1084.8 285.2l-3.2-1.5-.8-1.9-2.9-2.5-3.2-.2-3.7 1.6 1.5 2.4 1.7 1.8-1.7 2.3h1.8l-1 2.7 2.7 2.3-.5 2.9-1.2.3 1.5 1.1.8.8 1.8.7 2 1.2-.4.6 1.2-.5.5-2 .9-.4.8.9 1 .4.8 1 .8.3 1.1 1.1h.8l-.5 1.5-.5.7.2.5 1.7-.4 2.4-.1.7-.9-.6-.7.7-2 1.7-1.9-2.8-2.6-.7-2.3 1.1-1.4-1-1 1.1-1.1-1.4-.7-1.4 1.3-3.1-1.8-.7-2.5z",
    ru: "M1332.3 95.1l-4.5-4-13.6-4.1-9.4-2.1-6.2.9-5.3 2.9 5.8.8 6.6 3.2 8 1.7 11.5 1.3 7.1-.6zm-178.7-7.3l.9-.6-5.7-.9-2.8.7-1.3 1-1.5-1.2-5.2.1-6.2.8 7.7.1-1.1 1.3 4.4 1 3.6-.7.1-.7 2.9-.3 4.2-.6zm200.5 9.9l-1.5-1.8-12.5-2.6-3-.3-2.2.5 1.2 6 18-1.8zm15.2 6.3l-9.2-.7 3.4-1.2-8.2-1.5-6.1 1.9-1 2 1.5 2.1-6.9-.1-5.3 2.6-4.3-1.1-9.3.5.3 1.3-9.2.7-4.9 2.4-4.2.2-1.2 3.3 5.5 2.6-7.7.7-9.5-.3-5.8 1.1 4.8 5.4 6.9 4.3-9.6-3-7.9.3-5.1 2 4.5 3.8-4.9-1-2.1-5-4.2-2.8-1.8.1 3.6 3.7-4.6 3.5 8.1 4.2.4 5.4 2.9 2.9 4.7.5.4 3.5 4.4 3.1-1.9 2.6.5 2.7-3.7 1.4-.5 2-5.3-.8 3.5-7.8-.5-3.6-6.7-3.3-3.8-7.3-3.7-3.7-3.6-1.6.8-4.2-2.9-2.9-11.3-1.4-2.1 1 .5 4.7-4.3 4.7 1.2 1.7 4.7 4.1.1 2.6 5.3.5.8 1.1 5.8 2.9-1 2.8-18.5-6.1-6.6-1.7-12.8-1.6-1.2 1.7 5.9 3.1-2.7 3.6-6.4-3.2-5 2.2-7.6.1-2.1 1.9-5.3-.6 2.5-3.3-3.2-.2-12.3 4.6-7.6 2.6.4 3.5-6 1.2-4-1.9-1.2-3 5-.7-3.6-3-12.2-1.8 4.3 3.4-.8 3.2 4.7 3.3-1.1 3.8-4.6-1.9-4-.3-8 5.4 4.2 4.1-3.2 1.4-11.4-3.5-2.1 2.1 3.3 2.4.2 2.7-3.8-1.4-6-1.7-1.9-5.8-1-2.6-8-4 2.9-.7 20.1 4.2 6.4-1.5 3.7-2.9-1.6-3.6-4-2.6-17.6-6.1-11.6-1.3-7.6-3.2-3.6 1.8-6.4 2.2-3.2.5.4 3.7 7.2 3.7-2.8 4.1 6.4 6.3-1.7 4.8 4.9 4.1-.9 3.7 7.3 3.9-.9 2.9-3.3 3.3-7.9 7.4 5.3 2.8-4.5 3.2.9 1-2.6 3.4 2.5 5.5-1.6 1.9 2.4 1.4 1 2.8 2.1 3.6 5.2 1.5 1 1.4 2.3-.7 4.8 1.4 1 2.9-.6 1.6 3.7 3.9 2.2 1.1-.1 1.1 3.4 1.1 1.7 1.6-1.6 1.3-3.9-.2-.8.6 1.5 2 2 3.9 1.8.2 1-1.4 1.5.3 4.8-.5 3.8 3.4-.9 1.3.7 1.9 4 .2 2.2 2.7.2 1.2 6.6 2.2 3.5-1 3.6 2.9 2.9-.1 7.6 2 .4 1.9-1.3 3.2 1.8 3.4-.3 2.1-4.7.5-2.2 1.7.4 2.8 4.2-1 .4 1.3-6.8 2.6 3.2 2.4-3.2 5.2-3.4 1 5 3.6 6.2 2.4 7.4 5.1.5-.7 4.5 1.1 7.7 1 7.5 2.9 1.1 1.2 2.9-1 5.1 1.3 2.1 2.5 3.5 1.4 1.5.2 4.3 3.8 2.4.4.5-1.5 2.6-2.5-7.3-7.3-.4-4.1-5.9-5.9 3.5-6.3 4.6-1.1 1.4-3.7-2.8-1-.2-3.2-4.2-4.1-3.6.2-5.3-4.3 1.7-4.7-1.7-1.2 2.1-6.8 6 3.6-.7-4.6 8.1-6.6 7.5-.2 11.9 4.3 6.6 2.4 4.3-2.5 7.6-.2 7.3 3.2.8-1.8 6.9.3.2-3-9.4-4.2 3.6-2.9-1.5-1.7 3.9-1.6-5-4.1 1.4-2.1 16.8-2.1 1.7-1.5 10.8-2.2 3.1-2.5 9 1.3 4.3 6.3 4.3-1.5 7 2.1 1.2 3.3 4.4-.4 9.1-5.7-.8 1.9 8.3 4.7 18.1 15.5 1.1-3.3 8.3 3.6 6.2-1.6 3.2 1.1 4.1 3.6 3.9 1.2 3.3 2.6 6-.9 4.3 3.8 1.7-.5 4.7-1 6.6-5.4 5.9-2.9 5.3 1.9 5.1.1 4.7 2.9 5 .2 7.9 1.6 2.4-4.3-4-3.6 1.3-6.4 6.9 2.5 4.8.8 6.6 1.5 3.7 4.6 8.4 2.6 3.9-1.1 5.7-.8 5.4.8 6.5 3 4.9 3.1h4.5l6.7 1 3.6-1.6 5.8-1 4.5-4.4 3.3.7 3.9 2.1 5.5-.5 7.3 2.3 4.4-3.9-1.9-2.7-.1-6.5 1.2-2-2.5-3.3-3.7-1.5 1.7-3 5.1-1.1 6.2-.2 8.5 1.8 5.9 2.3 7.7 6.1 3.8 2.7 4.4 3.7 6.1 6.1 9.9 1.9 8.9 4.5 6 5.8h7.5l2.6-2.5 6.9-1.8 1.3 5.6-.4 2.3 2.8 6.8.6 6-6.8-1.1-2.9 2.2 4.7 5.3 3.8 7.3-2.5.1 1.9 3.1 1.4 1.1-.4-2 4-4.5 5.1 3 3.2-.1 4.4-3.6 1-3.7 2.1-7.1 1.9-7.2-1.3-4.3 1-9-5.2-9.9-5.5-7.3-1.3-6.2-4.7-5.1-12.7-6.7-5.6-.4-.3 3-5.8-1.3-5.7-3.8-8-.7 4.9-14.1 3.5-11.5 13.1-1.8 14.9 1 2.5-2.8 7.9.8 4.3 4.3 6.4-.6 8.4-1.6-7.7-3.5v-9.8l9.1-1.9 12.1 7.1 3.6-6.4-3.2-4.7 4.7-.5 6.5 8.1-2.4 4.6-.8 6 .3 7.5-5.7 1.3 2.8 2.7-.1 3.6 6.4 8.3 16 13.4 10.5 8.8 5.7 4.3 1.6-5.7-4.5-6.2 5.7-1.5-5.4-6.9 5-3.1-4.7-2.6-3.4-5 4.1-.2-9-8.6-6.7-1.4-2.9-2.4-1.1-5.6-3.1-3.9 7 .8 1.3-2.5 4.7 2.2 6.1-4.6 11.4 4-1.7-2.6 2-3.6 1.5-4 3.1-.7 6.5-4.3 9.8 1.2-.9-1.5-3.8-2.3-4.1-1.6-9.1-4.6-8.1-3 6.1.4 2-2.5-32.9-21.9-9.4-2.3-15.7-2.6-7.9.3-15.2-1.4 1.8 2.3 8.5 3.4-2.5 1.8-14.2-4.8-6.8.6-9.2-1.1-7 .2-3.9 1.1-7.2-1.6-5.1-3.8-6.5-2.2-9.2-.9-14.7 1-16.1-4-7.8-3-40.1-3.4-2.1 2.2 9.3 4.8-7.5-.7-1 1.5-9.7-1.6-5 1.4-9.3-2.4 3 5.5-8.9-2.1-10-4.1-.4-2.2-6-3.3-9.8-2.6h-6.1l-9.3-.9 4.7 3.9-17.2-.8-3.9-2.3-13.3-.9-5.3.8-.1 1.3-5.8-3.2-2.3.9-7.2-1.2-5.6-.7 1.1-1.5 6.6-2.8 2.3-1.5-2.4-2.5-5.5-1.9-11.5-2.3-10.8-.1-1.9 1.2-4.1-2.4zm-162.2 31.6l-9.9-4.3-3.1-4.3 3.3-4.9 2.8-5 8.6-4.7 9.8-2.4 11.3-2.4 1.3-1.5-4.2-1.9-6.6.6-4.9 1.8-11.7.9-10.1 3.1-6.8 2.7 2.5 2.2-6.6 4.4 3.9.7-5.4 4.3 1.6 2.8-3.4 1.1 1.9 2.8 7.9 1.4 2.2 2.3 13.4.7 2.2-.4zm314-24.7l-17.9-2.6-10.2-.2-3.4.9 3.4 3.4 12.4 3.2 4.5-1.2 14.2.2-3-3.7zm25.2 2.3l-11.7-1.3-8.2-.7 1.7 1.6 10.3 2 6.8.4 1.1-2zm-12.5 9.5l-2.5-1.4-8.3-1.9-4.1.5-.8 2 1.1.2 8.8.6h5.8zm162.6 12.3l-6-3.6-1.4 2.2 3.5 1.6 3.9-.2zM1084 228.9l-.6-1.5.2-1.7-2.2-.9-5-1.1-6.3 2-.7 2.6 5.9.7 8.7-.1zm589.7 21.8l-7.2-6.2-5.1-6-6.8-5.8-4.9-4-1.3.8 4.4 2.8-1.9 2.8 6.8 8.3 7.8 6 6.4 8.3 2.4 4.6 5.5 6.8 3.8 6 4.6 5.2-.1-4.8 6.5 3.8-3-4.4-9.5-6.3-3.7-9 8.9 2-13.6-10.9z",
    rw: "M1147.6 579.4l-3.3 1.9-1.4-.6-1.6 1.8-.2 3.8-.8.4-.6 3.5 3.5.5 1.7-3.6 3 .4 1.6-.8.4-3.7-2.3-3.6z",
    sa_c: "M1228.7 387l-10.2-.5-16.7-12.7-8.5-4.5-6.7-1.7-.9 1-10.4 3.1 6.1 6.4-1.7 1-.7 2.2-4 .8-1.1 2.3-2.1 2-6.1-1-.5 2.5v2.2l-.6 3.5h2.7l3.2 4.4 3.7 5.1 2.5 4.7 1.7 1.5 1.7 3.3-.2 1.4 2.1 3.7 3 1.3 2.8 2.5 3.6 7v3.8l.9 4.4 4 6.1 2.5 1 4.1 4.4 1.9 5.2 3.2 5.3 3 2.3.6 2.5 1.8 1.9.9 2.8 2.3-2.1-.7-2.7 1.2-3.1 2.4 1.7 1.5-.6 6.4-.2 1 .7 5.4.6 2.1-.3 1.6 2.1 2.5-1 3.5-6.7 5-2.9 15.7-2.4 16.1-6.4 2.6-12.7-2.9-4.5-1 1.3-16.8-3.2-2.6-6.4-.4-1.5-1.2-2.4-1.5.4-1.8-1.2-1-1.6-.9-2.1-1.7-1.8-1-2.1.4-2.1-.6-2.7-4-2.6-1.2-2.3-2.9-1.4-2.7-5.5-3.8.2-1.7-3.1-4.9-.6z", // Saudi Arabia
    sb: "M1909.1 646.4l-.2-.2-.1-.4h-.3l-.3.1.2.6h.2l.5-.1zm-35.6.8l-.1-.2-.5-.4-1.9-1.3-.4-.1-.1.1-.1.3.1.2.5.1v.1l.3.2.7.2.4.3.1.5.3.1.3.1.4-.2zm32-6.6v-.1l.2-.3-.2-.1-.5-.1-.7.1-.3.2-.2.3h-.2v.2l.1.4.2-.1.2.1.5-.5h.4l.5-.1zm-24.4-2.3l-.1-.2-.2-.1-.9-.7-.5-.2h-.5l-.1.5v.3h.6l.4.2v.6l.2.2v.5l1.2.9.7.4.7.1.4.2.5-.1.5.2.4-.1-.4-.3v-.4l-.5-1.3-.3-.3-.5.1-.5-.2h-.4l-.7-.3zm-.4-4.9l-.6-1.6-.2-.1.1.6.1.4-.1.5-.1.6.2.2.2-.2.4.5V633.4zm-9.8-2.2l-.3-.1-.4.3-.1.3-.1.7v.4l.3.7.3.5.3.3.2.2.9.1 1.7.1.9.4.9.2.4-.1.5-.2.1-.1-.1-.6-.2-.3-.4-.2-.2-.6-.5-.4-.9-.7h-1.6l-.6.1-1.1-1zm2.6-1.8l-.5.2v.3l.4.1.4.2.1.3.2-.1.4.2.2-.3-.4-.5-.4-.3h-.1l-.3-.1zm-5.6.8l.3-.2v-.4h-.3l-.1-.2h-.2l-.3.2-.2.3.1.2h.4l.2.1h.1zm-8.4-2.3l-.1-.2-.3-.2h-.2l-.5.1.1.1.6.3.3.1.1-.2zm3.1.4l.3-.2-.1-.2-.1-.5-.4.7.1.2h.2zm-.5-.9v-.4l-.2-.1.4-.3-.1-.1-.6-.2-.2.2-.2.1-.1.1-.1.1-.1.5.2.4.4.2.6-.5zm-4 .2l-.3-.4.1-.5.2-.1.2-.5-.1-.4-.2.1-.7.6-.1.3.6.8.3.2v-.1zm13-1.3l-.2-.4v-.2l-.3-.2-.2.1-.1.3.1.2.4.3.3-.1zm6-1.2h-.2l-.1.1h-.5l-.1.2.6 1.1-.3.5.4 2.2.4 1.2.8.8v.2l.8.5.6 1.3.2.1.1-.2v-.6l-.5-1.1.1-.8-.2-.3v-.3l-.2-.8-.6-.7-.3-.1-.2-.3.2-.6.2-.2.1-.3-1.3-1.9zm-16.6-.5l-.6-.2-.2-.3v-1l-.6-.3-.3.2-.6.7-.2.4-.5.3-.1.3v.4l.4.1.3-.4.9-.1.3.1v.4l.1.7.3.3.5.2.4.6.1-.3h.2l.2-.4-.3-1.2-.3-.5zm-6.5-.4l.1-.5-.1-.9-.2.1v.2l-.1.4.2.8.1-.1zm3.2-.4l.2-.2v-.9l-.2-.4-.2-.2-.5.1-.4.5v.5l.4.6h.7zm-2.6-1.2l.2-.3.5-.7.1-.3-.5-.2-.4-.5-.4-.2-.3.4v.4l.5.6-.1.4.2.1.1.4.1-.1zm17.5 3.9l-.1-.5-.3-.4.4-.5-2.2-1.9-.3-.2-.4-.1-.5-.4-.5-.1-.5-.4-.2-.3-.6-.4-.6-.8-1.5-.3.1.2.4.4.1.7.5.4.5.6.2.1.2.2.4.5.8.4.8.6.3.1.3.3 1.5.7.5.7.7.5v-.1zm-21.8-9.2l.2-.3-.7-.5-.2.3-.2.5.4.2.5-.2zm9.1 1.5l-.1-.1h-.3l-.4-.2-.7-.8-.2-.3-.2-1-.4-.4-1.4-.8-.8-.8-.7-.2-.2.2v.5l.2.3 1 .9 1.1 1.7 1 1 .8.1h.4v.1l.1.2.5.2.5-.4-.2-.2z",
    sc: "M1288.5 602l-.5-.8-.4.3.2.3.3.2.1.4.3.2v-.6z",
    sd: "M1180.8 468.5l.4-4.2 1.6-2 4-1 2.6-3.6-3.1-2.4-2.2-1.6-2.5-7.6-1.1-6.5 1.1-1.2-2.1-6.2H1114.2l.5 12.7h-6.3v2.7l1.1 25.2-4.8-.4-2.4 4.7-1.4 3.9 1.2 1.5-1.8 1.9.7 2.7-1.4 2.6-.5 2.4 2-.4 1.2 2.5.1 3.7 2.1 1.8v1.6l.7 2.7 3.3 4v2.6l-.8 2.6.3 2 2 1.8.5.3 1.7-.7 1.9-1.2 1.3-5.7 1.5-2.9 4-.9 1 1.8 3 3.7 1.5.5 2-1.1 4.1.3.8 1.3h5.5l.2-1.3 2.9-1.2.5-1.9 2.1-1.3 4.8 3.7 2.8-.7 2.7-4.5 3-3.5-.6-3.9-1.4-1.8 3.4-.3.3-1.5 2.6.5-.5 4.7.8 4.6 2.9 2.5.7 2.2v3.1l.8.1v-.7l1.4-6.7 2.6-1.8.5-2.6 2.3-4.8 3.2-3.2 2.1-6.2.7-5.5-.7-2.5 1.9-9.4z",
    se: "M1077.7 161.1l-1.9-2.2-1.7-8.4-7.2-3.7-5.9-2.7-2.5.3v3.5l-7.9-.9-.6 3.1-4-.1-2.2 3.9-3.4 6.1-5.7 7.9 1.8 1.9-1.3 2.2-4.3-.1-2.3 5.3 1 7.6 3.1 2.9-.9 6.9-3.4 4-1.7 3.3 4.2 8.4 4.4 6.7 2 5.7 5.3-.3 2.2-4.7 5.7.5 2-5.5.6-10 4.6-1.3 3.3-6.6-4.8-3.3-3.6-4 2.1-8.1 7.7-4.9 6.1-4.5-1.2-3.5 3.4-3.9 7-1.5z",
    sg: "M1561 563.7l.1-.2-.2-.2-.3-.1-.5-.2-.6.1-.3.6.9.4.9-.4z",
    si: "M1059.4 277l-1.2-2.1-.8-.1-.9 1.1-4.3.1-2.4 1.4-4.2-.4-.3 3 1.4 2.7-1.1.5 3.5.2.8-1 1.8 1 2 .1-.2-1.7 1.7-.6.3-2.5 3.9-1.7z",
    sk: "M1087.4 260.9l-4.9-2.3-3.4.8-2.4-.6-2.8 1.3-2.7-2.2-1.9.9-.3-.4h-1.5l-.6 1.1-1.1.3-.2 1.4-.9.3-.1.6-1.6.6-2.2-.1-.6 1.4-.3.8.7 2.1 2.6 1.6 1.9.7 4.1-.8.3-1.2 1.9-.2 2.3-1 .6.4 2.2-.7 1-1.5 1.6-.4 5.5 1.9 1-.6.7-2.5 1.1-1.7z",
    sl: "M919.4 518.7l-1.5.3v-2.3l-.9-1.7.2-1.8-1.2-2.7-1.5-2.3H910l-1.3 1.2-1.5.2-1 1.4-.7 1.7-3 2.8.7 4.7.9 2.3 2.9 3.5 4.1 2.5 1.5.5 1.3-2 .3-1.9 2.6-3.4 2.6-3z",
    sn: "M908.9 479.2l-3.6-4.4-3.2-4.7-3.7-1.7-2.6-1.8h-3.1l-2.8 1.4-2.7-.5-2 2-1.3 3.3-2.8 4.4-2.5 1.2 2.7 2.3 2.2 5 6.1-.2 1.3-1.5 1.8-.1 2.1 1.5 1.8.1 1.8-1.1 1.1 1.8-2.4 1.5-2.4-.1-2.4-1.4-2.1 1.5h-1l-1.4.9-5-.1.8 4.9 3-1.1 1.8.2 1.5-.7 10.3.3 2.7.1 4 1.5 1.3-.1.4-.7 3 .5.8-.4.3-2-.4-2.4-2.1-1.8-1.1-3.7-.2-3.9z",
    so: "M1223.4 505.7l-2.6-2.7-1.2-2.6-1.8-1.2-2 3.4-1.1 2.3 2.2 3.5 2.1 3.1 2.2 2.2 18.5 7.6 4.8-.1-15.4 19.1-7.4.3-4.9 4.5-3.6.1-1.5 2-4.8 7.2.2 23.2 3.3 5.3 1.3-1.5 1.3-3.4 6.1-7.7 5.3-4.8 8.3-6.4 5.6-5.1 6.4-8.7 4.7-7.1 4.6-9.3 3.2-8.2 2.5-7.1 1.3-6.8 1.1-2.3-.2-3.4.4-3.7-.2-1.7h-2.1l-2.6 2.2-2.9.6-2.5.9-1.8.2-3.2.2-1.9 1.1-2.8.5-4.8 1.9-6.1.8-5.2 1.6h-2.8z",
    sr: "M668 533.8l-4.6.5-.6 1.1-6.7-1.2-1 5.7-3.5 1.6.3 1.5-1.1 3.3 2.4 4.6 1.8.1.7 3.5 3.3 5.6 3.1.5.5-1.3-.9-1.3.5-1.8 2.3.6 2.7-.7 3.2 1.4 1.4-2.7.6-2.9 1-2.8-2.1-3.7-.4-4.4 3.1-5.5-6-1.7z",
    ss: "M1166 508.7l-.7-2.2-2.9-2.5-.8-4.6.5-4.7-2.6-.5-.3 1.5-3.4.3 1.4 1.8.6 3.9-3 3.5-2.7 4.5-2.8.7-4.8-3.7-2.1 1.3-.5 1.9-2.9 1.2-.2 1.3h-5.5l-.8-1.3-4.1-.3-2 1.1-1.5-.5-3-3.7-1-1.8-4 .9-1.5 2.9-1.3 5.7-1.9 1.2-1.7.7 3.8 2.5 3.1 2.6.1 2 3.8 3.4 2.4 2.7 1.5 3.8 4.2 2.5.9 2.1 3.5 5.2 2.5.8 1.5-1.1 2.6.4 3.1-1.3 1.4 2.7 5 4.2 2.3-1.7 3.5 1.4 4.5-1.5 4 .1 3.4-3 3.4-3.8 3.8-4.2-3.5-6.9-2.6-1.5-1-2.5-2.9-3.1-3.4-.5 1.8-3.6 3-.1.8-2-.2-5-.8-.1v-3.1z",
    st: "M1014.1 571.4l.5-.8v-.5l-.3-.5h-.4l-.5.4-.3.4v.3l.1.7.1.3.3.2.5-.5zm4.3-9.2l.2-.4v-.2l-.1-.1-.1-.1-.2.1-.3.5.1.2.2.2.2-.2z",
    sv: "M487.2 487l.6-2.5-.7-.7-1.1-.5-2.5.8-.1-.9-1.6-1-1.1-1.3-1.5-.5-1.4.4.2.7-1.1.7-2.1 1.6-.2 1 1.4 1.3 3.1.4 2.2 1.3 1.9.6 3.3.1.7-1.5z",
    sx: "M627.1 457.2l.2.2.3.1.1-.1v-.2h-.6z",
    sy: "M1183.5 359.9l11-6.7.9-7.8-1.2-4.7 2.7-1.6 2.1-4.1-5.9 1.1-2.8-.2-5.7 2.5h-4.3l-3-1.2-5.5 1.8-1.9-1.3.1 3.6-1.2 1.5-1.2 1.4-1 2.6 1.1 5 2.4.3 1.2 2.5-2.6 2.4-.9 3.5.3 2.6-.6 1h.1l6.3 2.5 9.6-6.7z",
    sz: "M1150.5 736.6l-2.7-1.2-1.6.5-.7 1.8-1.6 2.4-.1 2.2 3 3.5 3.3-.7 1.3-2.8-.3-2.8-.6-2.9z",
    tc: "M578.7 433.1l-.1.4v.2l.2.1.6-.1.1-.1.2-.1v-.1l-.4.1-.6-.4zm3.6.6l.2-.2-.2-.2-.7-.2-.2.1v.3h.6l.3.3v-.1zm-1.1-.5l-.1-.1-.1-.6h-.5v.2l.1.2h.1l.1.2.3.2.1-.1z",
    td: "M1108.4 447.6l-22.4-12.2-22.3-12.2-5.4 3.5 1.6 9.9 2 1.6.2 2.1 2.3 2.2-1.1 2.7-1.8 12.9-.2 8.3-6.9 6-2.3 8.4 2.4 2.3v4.1l3.6.2-.5 2.9 2.2 4.1.5 4.2-.2 4.3 3.1 5.8-3.1-.1-1.6.4-2.5-.6-1.2 3 3.3 3.7 2.5 1.1.8 2.6 1.8 4.4-.9 1.7 4.7-.4 1-1.7.9.2 1.4 1.4 7.1-2.4 2.3-2.5 2.9-2.2-.6-2.3 1.6-.6 5.4.4 5.2-2.9 4-7 2.8-2.5 3.5-1.1v-1.6l-2.1-1.8-.1-3.7-1.2-2.5-2 .4.5-2.4 1.4-2.6-.7-2.7 1.8-1.9-1.2-1.5 1.4-3.9 2.4-4.7 4.8.4-1.1-25.2z",
    tg: "M981.7 502.2l-4.9-.1-.4 1.9 2.4 3.3-.1 4.6.6 5.1 1.4 2.3-1.2 5.7.4 3.2 1.5 4 1.2 2.2 4.6-1.3-1.4-4.4.2-14.6-1.1-1.3-.2-3.1-2-2.3-1.7-1.9.7-3.3z",
    th: "M1562.7 481.4l1.5-2.9-.5-5.4-5.2-5.5-1.3-6.3-4.9-5.2-4.3-.4-.8 2.2-3.2.2-1.8-1.2-5.3 3.8-1-5.7.4-6.7-3.8-.3-.9-3.8-2.6-1.9-3 1.4-2.8 2.8-3.9.3-1.5 6.9-2.2 1.1 3.5 5.6 4.1 4.6 2.9 4.2-1.4 5.6-1.7 1.1 1.7 3.2 4.2 5.1 1 3.5.2 3 2.8 5.8-2.6 5.9-2.2 6.6-1.3 6.1-.3 3.9 1.2 3.6.7-3.8 2.9 3.1 3.2 3.5 1.1 3.2 2.4 2.4.9-1.1 4.7 2.8.6 3.3 3.7-.8 1.7-2.6-3.1-3.3-3.4-.8-3.3-3.6-1.4-5.5-2.6-5.8-3.7-.2-.7-4.6 1.4-5.6 2.2-9.3-.2-7 4.9-.1-.3 5 4.7-.1 5.3 2.9-2.1-7.7 3-5.2 7.1-1.3 5.3 1z",
    tj: "M1344.1 315.7l-2.1.2-1.3-1.8.2-2.9-6.4 1.5-.5 4-1.5 3.5-4.4-.3-.6 2.8 4.2 1.6 2.4 4.7-1.3 6.6 1.8.8 3.3-2.1 2.1 1.3.9-3 3.2.1.6-.9-.2-2.6 1.7-2.3 3.2 1.5v2l1.6.3 1 5.4 2.6 2.1 1.5-1.3 2.1-.7 2.5-2.9 3.8.5h5.4l-1.8-3.7-.6-2.5-3.5-1.4-1.6.6-3-5.9-9.5.9-7.1-2-5.4.5-.6-3.7 5.9 1.1 1.4-2z",
    tl: "M1676.8 631.9l4.9-1.8 6-2.8 2.2-1.7-2-.8-1.8.8-4 .2-4.9 1.4-.8 1.5.5 1.3-.1 1.9z",
    tm: "M1325.6 334.2l-.8-4-7.7-2.7-6.2-3.2-4.2-3-7-4.4-4.3-6.4-2-1.2-5.5.3-2.3-1.3-1.9-4.9-7.8-3.3-3.3 3.6-3.8 2.2 1.6 3.1-5.8.1-2.5.3-4.9-4.9-3.8-1.7-5.5 1.3-1.8 2 2.5 4-.5-4.5 3.7-1.6 2.4 3.6 4.6 3.7-4 2-5.3-1.5.1 5.2 3.5.4-.4 4.4 4.5 2.1.7 6.8 1.8 4.5 4.4-1.2 3-3.7 3.5.2 2.1-1.2 3.8.6 6.5 3.3 4.3.7 7.3 5.7 3.9.2 1.6 5.5 5.9 2.4 3.9-.8.4-3 4-.9 2.5-2-.1-5.2 4.1-1.2.3-2.3 2.9 1.7 1.6.2z",
    tn: "M1038 361.4l-2-1-1.5-3-2.8-.1-1.1-3.5 3.4-3.2.5-5.6-1.9-1.6-.1-3 2.5-3.2-.4-1.3-4.4 2.4.1-3.3-3.7-.7-5.6 2.6-1 3.3 1 6.2-1.1 5.3-3.2 3.6.6 4.8 4.5 3.8v1.5l3.4 2.6 2.6 11.3 2.6-1.4.4-2.7-.7-2.6 3.7-2.5 1.5-2 2.6-1.8.1-4.9z",
    to: "M13.3 707.7l-.2.3v.2l.4.4-.2-.9zm-1.6-.9h-.2l.2-.1-.4-.2h-.4l-.2-.1v-.2l-.2.3.2.3.9.4.3.2.2-.6v-.2l-.3.1v.1h-.1zm2.5-16l.1-.2v-.2l-.3-.1h-.1l-.3.5.1.1.3.2h.1l.1-.3z",
    tr: "M1166.6 308.9l-9.7-4.4-8.5.2-5.7 1.7-5.6 4-9.9-.8-1.6 4.8-7.9.2-5.1 6.1 3.6 3-2 5 4.2 3.6 3.7 6.4 5.8-.1 5.4 3.5 3.6-.8.9-2.7 5.7.2 4.6 3.5 8-.7 3.1-3.7 4.6 1.5 3.2-.6-1.7 2.4 2.3 3 1.2-1.4 1.2-1.5-.1-3.6 1.9 1.3 5.5-1.8 3 1.2h4.3l5.7-2.5 2.8.2 5.9-1.1 2.1-1 6.2.9 2.1 1.6 2.3-1.1-3.7-5.2.7-2-2.9-7.3 3.3-1.8-2.4-1.9-4.2-1.5v-3.1l-1.3-2.2-5.6-3-5.4.3-5.5 3.2-4.5-.6-5.8 1-7.8-2.4zm-49.6 4l2-1.9 6.1-.4.7-1.5-4.7-2-.9-2.4-4.5-.8-5 2 2.7 1.6-1.2 3.9-1.1.7.1 1.3 1.9 2.9 3.9-3.4z",
    tt: "M635.4 507.7l.1-.2v-.6l.2-.4-.2-.4-.1-.6.1-.5v-.7l.2-.3.5-.8h-.9l-.6.2-1.1.1-.5.2-.7.1-.4.2.1.1.5.2.2.2.1.2.1.4-.3 1.7-.1.1-.6.1-.2.3-1.4.8.8-.1.9.1 2.4-.1.9-.3zm1.8-6.7l1.2-.5.1-.4h-.2l-.8.3-.6.5v.2l.3-.1z",
    tw: "M1642.3 427.2l1.2-10.2.1-3.9-2.9-1.9-3.3 4.8-1.9 6.3 1.5 4.7 4 5.4 1.3-5.2z",
    tz: "M1149.6 578.6l-2 .8 2.3 3.6-.4 3.7-1.6.8.3 2.5 1.2 1.5v2l-1.4 1.4-2.2 3.3-2.1 2.3-.6.1-.3 2.7 1.1.9-.2 2.7 1 2.6-1.3 2.4 4.5 4.3.3 3.9 2.7 6.5.3.2 2.2 1.1 3.5 1.1 3.2 1.9 5.4 1.2 1.1 1.7.4-1.2 2.8 3.4.3 6.7 1.8 2.4v.1l2.1-.3 6.7 1.8 1.4-.8 3.9-.1 2.1-1.9 3.3.1 6.2-2.5 4.6-3.7-2-1.4-2.2-6.3-1.8-3.9.4-3.1-.3-1.9 1.7-3.9-.2-1.6-3.5-2.3-.3-3.6 2.8-7.9-8-6.3-.4-3.7-20.2-13-2.8 2.8-1.9 2.9 2.2 2.2-3.2 1.6-.7-.8-3.2.4-2.5 1.4-1.6-2.4 1.1-4.5.2-3.8-6.2-.1z",
    ua: "M1138.5 241l-4.8.5-1.5-.3-1 1.4-1.8-.2-4.1.3-1.2 1.4.2 3.1-2-.6-4.3.3-1.5-1.5-1.6 1.1-2-.9-3.8-.1-5.6-1.5-5-.5-3.7.2-2.4 1.6-2.2.3 3.1 5.3-.3 1.8-2.3.7-3.8 5.1 1.6 2.8-1.1-.4-1.1 1.7-.7 2.5 2.9 1.7.6 1.6 1.9-1.3 3.2.7h3.2l2.4 1.5 1.6-.9 3.6-.6 1-1.5h2.1l1.1-.9 3.2-.6 3.9 1.9 2 .3 2.5 1.6v2.1l1.9 1.1 1.1 2.6 2 1.5-.2 1 1 .6-1.2.5-3-.2-.6-.9-1 .5.5 1.1-1.1 2-.5 2.1-1.2.7 2.4 1.1 2.2-1 2.4 1.1 3.3-4.6 1.3-3.4 4.5-.8.7 2.4 8 1.5 1.7 1.4-4.5 2.1-.7 1.2 5.8 1.8-.6 2.9 3 1.3 6.3-3.6 5.3-1.1.6-2.2-5.1.4-2.7-1.5-1-3.9 3.9-2.3 4.6-.3 3-2 3.9-.5-.4-2.8 2.2-1.7 4.7-.5.3-2.1-1.8-3.4 1.3-3.2-.4-1.9-7.6-2-2.9.1-3.6-2.9-3.5 1-6.6-2.2-.2-1.2-2.2-2.7-4-.2-.7-1.9.9-1.3-3.8-3.4z",
    ug: "M1167.6 545.1l-3.4 3-4-.1-4.5 1.5-3.5-1.4-2.3 1.7-.3 7.5 2.3.8-1.8 2.3-2.2 1.7-2.1 3.3-1.2 3-.3 5.1-1.3 2.4-.1 4.8 1.4.6 3.3-1.9 2-.8 6.2.1-.3-2.5 2.6-3.7 3.5-.9 2.4-1.5 2.9 1.2.3.5v-.3l1.6-2.6 2.7-4.2 2.1-4.7-2.6-7.3-.7-3.2-2.7-4.4z",
    us: "M116.7 450.7l2-.9 2.5-1.4.2-.4-.9-2.2-.7-.8-.8-.6-1.9-1.1-.4-.1-.4.6v1.3l-1.2 1-.4.7.4 2.3-.6 1.8 1.2.9 1-1.1zm-.6-9.9l.6-.7-1.2-1-1.8-.6-.7.5v.4l.5.5.6 1.4 2-.5zm-3-3.4l-2.6-.2-.6.7 2.9.2.3-.7zm-4.7-.9l-1.1-2.1-.3-.4-1.7.9.1.2.4 1.5 1.8.2.4.1.4-.4zm-8.3-4.2l.3-1.5-1.3-.1-1 .6-.4.5 1.6 1.1.8-.6zm412.1-173.2h-1.6l-1.3 2.4H373.4l-1.6 5.1-2.4 5.1-2.3 1.6 1.1-5.9-5.8-2.1-1.4 1.2-.4 2.9-1.8 5.4-4.2 8.3-4 5.6-4 5.6-5.4 5.8-1.1 4.7-2.8 5.3-3.9 5.2 1 3.4-1.9 5.2 1.5 5.4 1.3 2.2-.8 1.5.4 9 2.5 6.5-.8 3.5 1 1 4.6.7 1.3 1.7 2.8.3-.1 1.9 2.2.7 2.1 3.7-.3 3.2 6.3-.5 7-.7-1 1.3 7.1 3.1 10.7 4.4h15l.8-2.6h9.3l1.3 2.2 2.1 2 2.4 2.8.8 3.3.4 3.5 2.2 1.9 4 1.9 4.8-5 4.4-.1 3.1 2.5 1.6 4.4 1 3.7 2.4 3.6.2 4.5.8 3 3.9 2 3.6 1.4 2.1-.2-.6-2.2.4-3.1 1-4.4 1.9-2.8 3.7-3.1 6-2.7 6.1-4.7 4.9-1.5 3.5-.4 3.5 1.4 4.9-.8 3.3 3.4 3.8.2 2.4-1.2 1.7.9 1.3-.8-.9-1.3.7-2.5-.5-1.7 2.4-1 4.2-.4 4.7.7 6.2-.8 3 1.5 2 3 .9.3 6.1-2.9 1.9 1 3 5.3.8 3.5-2 4.2.4 2.5 1.6 4.9 2 5.5 1.8 1.4.4 2.8 2.6.8 1.7-.8 2-3.9.7-2.5.9-4.3-1.2-7.4.5-2.7-1.5-4.5-.7-5.4.1-4.4 1.8-4.5 3.5-3.8 3.7-3 6.9-4.1 1.3-2.2 3.3-2.3 2.8-.4 4.4-3.8 6-1.9 4.6-4.8.9-6.5.1-2.2-1.4-.4 1.5-6.2-3-2.1 3.2 1v-4.1l1.9-2.7-1 5.3 2 2.5-2.9 4.4.4.2 4.4-5.1 2.4-2.5.6-2.5-.9-1.1-.1-3.5 1.2 1.6 1.1.4-.1 1.6 5.2-4.9 2.5-4.5-1.4-.3 2.1-1.8-.4.8h3.3l7.8-1.9-1.1-1.2-7.9 1.2 4.8-1.8 3.1-.3 2.4-.3 4.1-1.1 2.4.1 3.8-1 1-1.7-1.1-1.4-.2 2.2-2.1-.1-.6-3.3 1.1-3.3 1.4-1.3 3.9-3.7 5.9-1.8 6-2.1 6.3-3-.2-2-2.1-3.5 2.8-8.5-1.5-1.8-3.7 1.1-1.1-1.7-5.5 4.7-3.2 4.9-2.7 2.8-2.5.9-1.7.3-1 1.6h-17l-2.7 1.2-6.7 4.2.2.9-.6 2.4-4.6 2-3.9-.5-4-.2-2.6.7-.3 1.8-.1.6-5.8 3.7-4.5 1.8-2.9.8-3.7 1.7-4 .9-2.5-.3-2.7-1.3 2.7-2.4 2-2.2 3.7-3.4.7-2.5.5-3.5-1.6-.7-4.3 2.8-.9-.1.3-1.5 3.8-2.5 1.6-2.8.7-2.8-2.7-2.4-3.7-1.3-1.7 2.4-1.4.6-2.2 3.1.4-2.1-2.6 1.5-2.1 2-2.6 3.1-1.3 2.6.1 3.8-1.8 4-3.3 3-1.4.9-1.6.7h-1.8l-.3-.4-.1-3.3.7-1.6.7-1.5.6-3 2.5-3.5 2.9-4.3 4.6-4.7h-.7l-5.4 4-.4-.7 2.9-2.3 4.7-4 3.7-.5 4.4-1.3 3.7.7h.1l4.7-.5-1.5-2.5-1.2-.2-1.4-.3-.4-1.7-5.1.5-5 1.4-2.5-2.3-2.5-.8 3.1-3.3-5.3 2-4.9 2.1-4.6 1.5-2.1-2.1-5.5 1.3.4-.9 4.6-2.6 4.7-2.5 5.9-2.1-5.3-1.6-4.4.8-3.8-1.9-4.6-1-3.2-.4-1-1 .8-3.4zm-240.6-46.9l6.9-2.8v-1.8l-2.6-.4-3.4.9-6.4 2.1-2.2 2.7.7 1.6 7-2.3zm-38.7-16.4l2.3-2.3-2.9-.5-5.7 1 .8 1.6 1.6 1.1 3.9-.9zm1.2-22.3l-3.1 2.2.4.5 4.2-.4.3 1.1 1.7 1.2 4.9-1.2 1.2-.6-3.3-.8-1.6-1.5-3.4.6-1.3-1.1zM359 133.3l-4.4-1.1-10.2 2.8-3.2-.3-11 2.3-4.8.6-7.8 2.5-4.8 2.6-8.6 2.5-7.6.1-6.3 2.9 3.2 1.7.7 2.3-.8 2.7 2.3 2.1-1.2 3.5-9.2.2 4.3-2.8h-3.4l-13.1 2.7-9.1 2.3 1 3.3-1.2 2.2 4.5 1.4 6.9-.7 1.8 1.3 2.9-1.3 6.1-1.2h2.7l-5.9 2.1 1.1 1-2.5 2.6-5.5 1.8-2.5-.5-7 2.7-1.8-.9-4.1.4-5.3 3-7.6 3.1-5.8 3.4.3 2.4-4 3.3 1.4 1.4.5 2.7 7.2-1.1.4 2.1-3.3 2.1-3.6 3.5h2.8l7.2-2.3-1.6 2.9 3.6-2.1-.4 3 4.8-2.2.4 1.1 7.2-1.8-6.2 3.4-5.7 4.5-5.7 2.1-2.3 1.2-10.3 3.6-4.9 2.4-6.5.7-8.5 3.3-6.6 1.8-8.1 2.8-.4 1 10-1.7 6-2 6.9-2 6.1-1.7 2.8.5 8.1-2.6 4.5-2.8 10.5-3.1 3.9-2.6 6.6-1.8 7.6-2.5 8.9-4.2-.2-2.9 11.1-4.1 7.4-3.9 9.2-3.2-.4 1.4-6.7 1.8-8.3 5.7-3.2 3.5 6.4-1.3 6.1-1.9 6.5-1.3 2.9-.3 3.5-4.1 6.3-1.2 2.6 2.5 6 2.7 6.7-.5 5.7 2 3.2 1.1 3.3 6.1 3.7 1.7 7.1.2 4.1.4-2.7 5.5 1.6 4.9-3.3 5.2 2.5 1.9.6 2.2 5.1-2.9 3.1-3.7-4.6-3.8 1.5-6.8 1.1-4.2-1.7-2.7-.7-2.4.5-3-6.4 1.9-7.6 3.3-.2-3.9-.6-2.6-2.7-1.6-4.2-.1 35.4-32.4 24.3-20.2-3.5-.7-4.1-1.6-6.5.8-2.2-.7-7.1-.5-6.2-1.6-4.8.5-4.9-.9 2-1.2-6.3-.3-3.3 1 .5-2.4z",
    uy: "M692.5 787l-2.1-3.7 1.9-3-3.8-4.3-4.8-3.5-6.2-4.1-1.9.2-6.2-4.9-3.4.7-.5 5.1-.3 6.5 1.1 6.3-.9 1.4.4 4.2 3.9 3.5 3.6-.2 5.4 2.7 2.7-.6 4.2 1.2 5.3-3.5 1.6-4z",
    uz: "M1339.8 303.1l-2.5 1.2-5.4 4.3-.9 4.5h-1.9l-2.3-3-6.6-.2-2.6-5-2.5-.1-1.5-6.2-7.5-4.5-8.6.5-5.7.9-6.5-5.5-4.8-2.3-9.1-4.5-1.1-.5-11.9 3.6 6.2 22.8 5.8-.1-1.6-3.1 3.8-2.2 3.3-3.6 7.8 3.3 1.9 4.9 2.3 1.3 5.5-.3 2 1.2 4.3 6.4 7 4.4 4.2 3 6.2 3.2 7.7 2.7.8 4h2.9l4.3 1.4 1.3-6.6-2.4-4.7-4.2-1.6.6-2.8 4.4.3 1.5-3.5.5-4 6.4-1.5-.2 2.9 1.3 1.8 2.1-.2 4.1.6 5.2-4.5-7.1-3.3-3.2 1.6-4.6-2.3 3.1-4.1-1.8-.6z",
    vc: "M634.5 491.4v-.1h.1v-.2h-.1v.2h-.1v.1h.1zm.7-1.9l.1-.2.1-.1-.1-.1v.1l-.2.1v.2h-.2.1l.1.1.1-.1zm.3-1.1l.3-.2.1-.6-.1-.4h-.2l-.3.1-.2.3-.1.5.4.4.1-.1z",
    ve: "M642 518.9l-2.2-1.5-2.9.2-.7-5.1-4.1-3.2-4.4-.4-1.8-3 4.8-1.9-6.7.1-6.9.4-.2 1.6-3.2 1.9-4.2-.7-3.1-2.9-6 .7-5-.1-.1-2.1-3.5-3.5-3.9-.1-1.7-4.5-2.1 2 .6 3-7.1 2.6v4.8l1.6 2.2-1.5 4.6-2.4.4-1.9-5 2.7-3.7.3-3.3-1.7-2.9 3.3-.8.3-1.5-3.7 1.1-1.6 3.2-2.2 1.8-1.8 2.4-.9 4.5-1.8 3.7 2.9.5.6 2.9 1.1 1.4.4 2.5-.8 2.4.2 1.3 1.3.6 1.3 2.2 7.2-.6 3.2.8 3.8 5.5 2.3-.7 4 .3 3.2-.7 2 1.1-1.2 3.4-1.3 2.1-.5 4.6 1 4.2 1.5 1.9.2 1.5-2.9 3.1 2 1.4 1.4 2.2 1.7 6.4 3 3.4 4.4-.5 1.1-1.9 4.2-1.5 2.3-1 .7-2.7 4.1-1.8-.3-1.4-4.8-.5-.7-4 .3-4.3-2.4-1.6 1-.6 4.2.8 4.4 1.6 1.7-1.5 4-1 6.4-2.4 2.1-2.4-.7-1.8-3.7-4.8 1.6-1.8v-2.9l3.4-1.1 1.5-1.2-1.9-2.3.6-2.3 4.6-3.8z",
    vg: "M619.2 455.1l.3-.2-.2-.1h-.4l-.3.2.1.1h.5zm1.1-.4l.4-.4-.5.1-.2.2.1.1h.2zm.8-1.8h-.7l.1.1h.3l.3.1v-.2z",
    vi: "M617.9 458.9l-.7.2-.1.4h1.1l.7-.3h-.6l-.4-.3zm.9-3.5l-.5-.1-.2.2.3.1.4-.2zm-1.1.1l-.2-.2-.3-.1-.4.1.5.3.4-.1z",
    vn: "M1571.6 435l-5.9-1.6-3-2.6.2-3.7-5.2-1.1-3-2.4-4.1 3.4-5.3.7h-4.3l-2.7 1.5 4 5.1 3.4 5.7 6.8.1 3 5.5-3.3 1.7-1.3 2.3 7.3 3.8 5.7 7.5 4.3 5.6 4.8 4.4 2 4.5-.2 6.4 1.8 4.2.1 7.7-8.9 4.9 2.8 3.8-5.8.5-4.7 2.5 4.5 3.7-1.3 4.3 2.3 4 6.6-5.9 4.1-5.3 6.1-4.1 4.3-4.2-.4-11.2-4-11.7-4.1-5.1-5.6-4-6.4-8.3-5.3-6.7.5-4.4 3.7-6 6.5-5.5z",
    vu: "M1908.6 676.9l-2.7-3.6-.6 1.7 1.3 2.8 2-.9zm-2-9.7l-2.3-2-.9 4.9.5 1.8 1.2-.4 1.3.8.2-5.1z",
    ye: "M1271.5 466.2l-2.1-4.4-5.2-10.5-15.7 2.4-5 2.9-3.5 6.7-2.5 1-1.6-2.1-2.1.3-5.4-.6-1-.7-6.4.2-1.5.6-2.4-1.7-1.2 3.1.7 2.7-2.3 2.1.4 2.7-.6 1.3.7 2.9-1.1.3 1.7 2.6 1.3 4.7 1 1.9v3.4l1.6 3.8 3.9.3 1.8-.9 2.7.2.8-1.7 1.5-.4 1.1-1.7 1.4-.4 4.7-.3 3.5-1.2 3.1-2.7 1.7.4 2.4-.3 4.7-4.5 8.8-3 5.3-2.7v-2.1l.9-2.9 3.9-1.7z",
    yt: "M1228.7 654.7v-.3l.2-.5v-.1l.1-.5-.3-.3h-.2l-.2-.3-.3.3.3.5-.1.3-.1.4.1.4.2.2.3-.1z",
    za: "M1148.2 713.7l-2.9-.6-1.9.8-2.6-1.1-2.2-.1-8 4.7-5.2 4.7-2 4.3-1.7 2.4-3 .5-1.2 3-.6 2-3.6 1.5-4.4-.3-2.5-1.8-2.3-.8-2.7 1.5-1.5 3.1-2.7 1.9-2.8 2.8-4 .7-1.1-2.3.7-3.8-3-6.1-1.4-1-1.1 23.6-5 3.2-2.9.5-3.3-1.2-2.4-.5-.8-2.7-2.1-1.8-2.7 3.2 3.5 8.2v.1l2.5 5.3 3.2 6-.2 4.8-1.7 1.2 1.4 4.2-.2 3.8.6 1.7.3-.9 2.1 2.9 1.8.1 2.1 2.3 2.4-.2 3.5-2.4 4.6-1 5.6-2.5 2.2.3 3.3-.8 5.7 1.2 2.7-1.2 3.2 1 .8-1.8 2.7-.3 5.8-2.5 4.3-2.9 4.1-3.8 6.7-6.5 3.4-4.6 1.8-3.2 2.5-3.3 1.2-.9 3.9-3.2 1.6-2.9 1.1-5.2 1.7-4.7h-4.1l-1.3 2.8-3.3.7-3-3.5.1-2.2 1.6-2.4.7-1.8 1.6-.5 2.7 1.2-.4-2.3 1.4-7.1-1.1-4.5-2.2-9zm-20.1 52.8l-2 .6-3.7-4.9 3.2-4 3.1-2.5 2.6-1.3 2.3 2 1.7 1.9-1.9 3.1-1.1 2.1-3.1 1-1.1 2z",
    zm: "M1149.2 626.7l-1.9-.5.4-1.3-1-.3-7.5 1.1-1.6.7-1.6 4.1 1.2 2.8-1.2 7.5-.8 6.4 1.4 1.1 3.9 2.5 1.5-1.2.3 6.9h-4.3l-2.1-3.5-2-2.8-4.3-.8-1.2-3.4-3.4 2-4.5-.9-1.8-2.8-3.5-.6-2.6.1-.3-2-1.9-.1.5 2-.7 3 .9 3-.9 2.4.5 2.2-11.6-.1-.8 20.3 3.6 5.2 3.5 4 4.6-1.5 3.6.4 2.1 1.4v.5l1 .5 6.2.7 1.7.7 1.9-.1 3.2-4.1 5.1-5.3 2-.5.7-2.2 3.3-2.5 4.2-.9-.3-4.5 17.1-5.2-2.9-1.7 1.9-5.9 1.8-2.2-.9-5.3 1.2-5.1 1-1.8-1.2-5.4-2.6-2.8-3.2-1.9-3.5-1.1-2.2-1.1-.3-.2.5 1.1-1 .4-1.2-1.4z",
    zw: "M1148.2 713.7l6.2-7.2 1.6-4.6.9-.6.8-3.7-.8-1.9.5-4.7 1.3-4.4.3-8.1-2.8-2-2.6-.5-1.1-1.6-2.6-1.3-4.6.1-.3-2.4-4.2.9-3.3 2.5-.7 2.2-2 .5-5.1 5.3-3.2 4.1-1.9.1-1.7-.7-6.2-.7 1.9 5.1 1.1 1.1 1.6 3.7 6 7 2.3.7-.1 2.2 1.5 4.1 4.2.9 3.4 2.9 2.2.1 2.6 1.1 1.9-.8 2.9.6z"
};

// ── Geo game state ──
let geoState = {
    mode: 'click',       // 'click' or 'name'
    region: 'world',
    questions: [],
    currentQ: 0,
    score: 0,
    correct: 0,
    streak: 0,
    bestStreak: 0,
    questionStart: 0,
    answered: false
};

function getGeoStats() {
    if (!multData.geoStats) {
        multData.geoStats = { totalAnswered: 0, totalCorrect: 0, bestScore: 0, roundsPlayed: 0, perfectRounds: 0 };
    }
    return multData.geoStats;
}

function showGeoMenu() {
    practiceViewActive = true;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('.score-bar').style.display = 'none';
    document.querySelector('.container').classList.add('geo-active');

    const stats = getGeoStats();
    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <h3 style="color: #3d7c47;">🌍 World Quiz!</h3>
            <p style="color: #5c4a32; margin-bottom: 0.8rem;">Learn countries around the world!</p>

            ${renderPassport()}

            <div style="margin-bottom: 0.8rem;">
                <div style="font-weight: 700; color: #3d7c47; margin-bottom: 0.4rem;">Pick a Region:</div>
                <div style="display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center;" id="geo-region-picker">
                    ${Object.entries(GEO_REGIONS).map(([key, r]) =>
                        `<button class="geo-region-btn ${geoState.region === key ? 'active' : ''}" onclick="selectGeoRegion('${key}')">${r.emoji} ${r.name}</button>`
                    ).join('')}
                </div>
            </div>

            <div style="margin-bottom: 1rem;">
                <div style="font-weight: 700; color: #3d7c47; margin-bottom: 0.4rem;">Game Mode:</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                    <button class="geo-region-btn ${geoState.mode === 'click' ? 'active' : ''}" onclick="selectGeoMode('click')">
                        🗺️ Click the Country
                    </button>
                    <button class="geo-region-btn ${geoState.mode === 'name' ? 'active' : ''}" onclick="selectGeoMode('name')">
                        🏷️ Name the Country
                    </button>
                </div>
            </div>

            <button onclick="startGeoRound()" style="background: linear-gradient(135deg, #3d7c47, #2d6a37); color: white; border: none; border-radius: 12px; padding: 1rem 2.5rem; font-family: inherit; font-weight: 700; font-size: 1.1rem; cursor: pointer;">
                Start Quiz!
            </button>

            ${stats.roundsPlayed > 0 ? `
                <div style="margin-top: 0.8rem; background: rgba(255,255,255,0.6); border-radius: 10px; padding: 0.5rem; font-size: 0.85rem; color: #5c4a32;">
                    Rounds: ${stats.roundsPlayed} | Best: ${stats.bestScore}/100 | Correct: ${stats.totalCorrect}/${stats.totalAnswered}
                </div>
            ` : ''}

            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))" style="margin-top: 0.8rem;">Back to Math</button>
        </div>
    `;
}

function selectGeoRegion(region) {
    geoState.region = region;
    document.querySelectorAll('#geo-region-picker .geo-region-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
}

function selectGeoMode(mode) {
    geoState.mode = mode;
    showGeoMenu();
}

function startGeoRound() {
    let pool = GEO_COUNTRIES.filter(c => geoState.region === 'world' || c.region === geoState.region);
    // Shuffle
    for (let i = pool.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    geoState.questions = pool.slice(0, 10);
    geoState.currentQ = 0;
    geoState.score = 0;
    geoState.correct = 0;
    geoState.streak = 0;
    geoState.bestStreak = 0;
    showGeoQuestion();
}

function buildGeoMapSVG(highlightCode, clickable) {
    const vb = GEO_REGIONS[geoState.region].viewBox;
    let paths = '';
    const regionCountries = geoState.region === 'world'
        ? GEO_COUNTRIES
        : GEO_COUNTRIES.filter(c => c.region === geoState.region);
    const regionCodes = new Set(regionCountries.map(c => c.code));

    for (const [code, d] of Object.entries(WORLD_MAP_PATHS)) {
        const isInRegion = regionCodes.has(code);
        const cls = highlightCode === code
            ? 'geo-country geo-highlight'
            : (isInRegion ? 'geo-country' : 'geo-country geo-dimmed');
        const click = clickable && isInRegion ? `onclick="geoClickCountry('${code}')"` : '';
        const title = (highlightCode !== undefined) ? '' : `<title>${(GEO_COUNTRIES.find(c=>c.code===code)||{}).name||code}</title>`;
        paths += `<path id="geo-${code}" class="${cls}" d="${d}" ${click}>${title}</path>`;
    }

    return `<div class="geo-map-container">
        <svg viewBox="${vb}" xmlns="http://www.w3.org/2000/svg" style="background: #d4eaf7;">
            ${paths}
        </svg>
    </div>`;
}

function showGeoQuestion() {
    if (geoState.currentQ >= geoState.questions.length) {
        showGeoResults();
        return;
    }

    const q = geoState.questions[geoState.currentQ];
    geoState.answered = false;
    geoState.questionStart = Date.now();

    const card = document.getElementById('card');

    if (geoState.mode === 'click') {
        // "Click the Country" mode
        card.innerHTML = `
            <div>
                <div class="geo-score-display">
                    <span>Q ${geoState.currentQ + 1}/10</span>
                    <span>Score: ${geoState.score}</span>
                    <span>Streak: ${geoState.streak}</span>
                </div>
                <div class="geo-prompt">Click on: <strong>${q.name}</strong></div>
                ${buildGeoMapSVG(null, true)}
                <div id="geo-feedback"></div>
            </div>
        `;
    } else {
        // "Name the Country" mode - show highlighted country + 4 choices
        const choices = generateGeoChoices(q);
        card.innerHTML = `
            <div>
                <div class="geo-score-display">
                    <span>Q ${geoState.currentQ + 1}/10</span>
                    <span>Score: ${geoState.score}</span>
                    <span>Streak: ${geoState.streak}</span>
                </div>
                <div class="geo-prompt">Which country is highlighted?</div>
                ${buildGeoMapSVG(q.code, false)}
                <div class="geo-choices" id="geo-choices">
                    ${choices.map(c => `
                        <button class="geo-choice-btn" onclick="geoNameAnswer('${c.code}')">${c.name}</button>
                    `).join('')}
                </div>
                <div id="geo-feedback"></div>
            </div>
        `;
    }
}

function generateGeoChoices(correct) {
    const pool = GEO_COUNTRIES.filter(c => c.code !== correct.code);
    // Shuffle pool
    for (let i = pool.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    const wrong = pool.slice(0, 3);
    const all = [correct, ...wrong];
    // Shuffle choices
    for (let i = all.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [all[i], all[j]] = [all[j], all[i]];
    }
    return all;
}

function geoClickCountry(code) {
    if (geoState.answered) return;
    geoState.answered = true;

    const q = geoState.questions[geoState.currentQ];
    const isCorrect = code === q.code;
    const elapsed = (Date.now() - geoState.questionStart) / 1000;

    // Highlight correct/wrong on map
    const clickedEl = document.getElementById(`geo-${code}`);
    const correctEl = document.getElementById(`geo-${q.code}`);

    if (isCorrect) {
        if (clickedEl) clickedEl.classList.add('geo-correct');
        const speedBonus = Math.max(0, Math.floor((10 - elapsed) * 1));
        const pts = 10 + speedBonus;
        geoState.score += pts;
        geoState.correct++;
        geoState.streak++;
        if (geoState.streak > geoState.bestStreak) geoState.bestStreak = geoState.streak;
        playSound('correct');
        mascotReact(true);
        showGeoFeedback(true, q, pts);
    } else {
        if (clickedEl) clickedEl.classList.add('geo-wrong');
        if (correctEl) correctEl.classList.add('geo-correct');
        geoState.streak = 0;
        playSound('wrong');
        mascotReact(false);
        showGeoFeedback(false, q, 0);
    }

    setTimeout(() => {
        geoState.currentQ++;
        showGeoQuestion();
    }, 2500);
}

function geoNameAnswer(code) {
    if (geoState.answered) return;
    geoState.answered = true;

    const q = geoState.questions[geoState.currentQ];
    const isCorrect = code === q.code;
    const elapsed = (Date.now() - geoState.questionStart) / 1000;

    // Highlight buttons
    document.querySelectorAll('.geo-choice-btn').forEach(btn => {
        btn.style.pointerEvents = 'none';
        const btnCode = btn.getAttribute('onclick').match(/'([^']+)'/)[1];
        if (btnCode === q.code) btn.classList.add('geo-btn-correct');
        else if (btnCode === code && !isCorrect) btn.classList.add('geo-btn-wrong');
    });

    // Highlight on map
    const correctEl = document.getElementById(`geo-${q.code}`);
    if (correctEl) correctEl.classList.add('geo-correct');

    if (isCorrect) {
        const speedBonus = Math.max(0, Math.floor((10 - elapsed) * 1));
        const pts = 10 + speedBonus;
        geoState.score += pts;
        geoState.correct++;
        geoState.streak++;
        if (geoState.streak > geoState.bestStreak) geoState.bestStreak = geoState.streak;
        playSound('correct');
        mascotReact(true);
        showGeoFeedback(true, q, pts);
    } else {
        geoState.streak = 0;
        playSound('wrong');
        mascotReact(false);
        showGeoFeedback(false, q, 0);
    }

    setTimeout(() => {
        geoState.currentQ++;
        showGeoQuestion();
    }, 2500);
}

function showGeoFeedback(correct, country, pts) {
    const fb = document.getElementById('geo-feedback');
    const fact = GEO_FUN_FACTS[country.code] || '';
    fb.innerHTML = `
        <div style="text-align: center; margin-top: 0.5rem;">
            <div style="font-size: 1.2rem; font-weight: 700; color: ${correct ? '#2ecc71' : '#e74c3c'};">
                ${correct ? `Correct! +${pts} points` : `That was ${country.name}!`}
            </div>
            ${fact ? `<div class="geo-fun-fact">💡 ${fact}</div>` : ''}
        </div>
    `;
}

function showGeoResults() {
    const stats = getGeoStats();
    stats.totalAnswered += 10;
    stats.totalCorrect += geoState.correct;
    stats.roundsPlayed++;
    if (geoState.score > stats.bestScore) stats.bestScore = geoState.score;
    if (geoState.correct === 10) stats.perfectRounds++;

    // Add points to main score
    multData.stats.totalCorrect += geoState.correct;
    multData.stats.totalAnswered += 10;

    // Award passport stamp for 7+ correct on a specific region
    if (geoState.correct >= 7 && geoState.region !== 'world') {
        awardPassportStamp(geoState.region, geoState.correct);
    }

    saveMultiplicationData();
    checkAchievements();

    const pct = geoState.correct * 10;
    const emoji = pct === 100 ? '🏆' : pct >= 70 ? '🌟' : pct >= 50 ? '👍' : '📚';

    if (pct === 100) launchConfetti();

    const card = document.getElementById('card');
    card.innerHTML = `
        <div style="text-align: center;">
            <div style="font-size: 3rem;">${emoji}</div>
            <h3 style="color: #3d7c47;">Round Complete!</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin: 1rem 0;">
                <div style="background: rgba(255,255,255,0.7); border-radius: 10px; padding: 0.8rem;">
                    <div style="font-size: 1.5rem; font-weight: 800; color: #3d7c47;">${geoState.correct}/10</div>
                    <div style="font-size: 0.8rem; color: #5c4a32;">Correct</div>
                </div>
                <div style="background: rgba(255,255,255,0.7); border-radius: 10px; padding: 0.8rem;">
                    <div style="font-size: 1.5rem; font-weight: 800; color: #3d7c47;">${geoState.score}</div>
                    <div style="font-size: 0.8rem; color: #5c4a32;">Points</div>
                </div>
                <div style="background: rgba(255,255,255,0.7); border-radius: 10px; padding: 0.8rem;">
                    <div style="font-size: 1.5rem; font-weight: 800; color: #ff8c00;">${geoState.bestStreak}</div>
                    <div style="font-size: 0.8rem; color: #5c4a32;">Best Streak</div>
                </div>
                <div style="background: rgba(255,255,255,0.7); border-radius: 10px; padding: 0.8rem;">
                    <div style="font-size: 1.5rem; font-weight: 800; color: #3d7c47;">${stats.bestScore}</div>
                    <div style="font-size: 0.8rem; color: #5c4a32;">All-Time Best</div>
                </div>
            </div>
            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                <button onclick="startGeoRound()" style="background: linear-gradient(135deg, #3d7c47, #2d6a37); color: white; border: none; border-radius: 12px; padding: 0.8rem 1.5rem; font-family: inherit; font-weight: 700; cursor: pointer;">
                    Play Again
                </button>
                <button onclick="showGeoMenu()" style="background: linear-gradient(135deg, #ff8c00, #e67300); color: white; border: none; border-radius: 12px; padding: 0.8rem 1.5rem; font-family: inherit; font-weight: 700; cursor: pointer;">
                    Change Mode
                </button>
            </div>
            <button class="back-btn" onclick="setMode('times', document.getElementById('btn-times'))" style="margin-top: 0.8rem;">Back to Math</button>
        </div>
    `;
}

// Check if should show announcement (once per session)
let announcementShown = false;

function initGame() {
    renderLevelSelect();
    renderPrizeButton();
    initNewFeatures();

    // Show Isabelle's announcement on first load
    if (!announcementShown) {
        announcementShown = true;
        showIsabelleAnnouncement();
    } else {
        startRound();
    }
}

// Start
initGame();
    </script>
</body>
</html>
